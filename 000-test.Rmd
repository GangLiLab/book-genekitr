# Plot GO and KEGG {#plot-go-kegg}

```{r include=FALSE}
library(knitr)
library(ggplot2)
library(igraph)
library(ggraph)
library(patchwork)
library(genekitr)
```

After selecting interested pathways or terms from `genGO` or `genKEGG` result, user could pass the data frame to `plotEnrich`, which sets many plot types for GO and KEGG result, including barplot, dotplot, heatmap, wego-like plot, chord plot, network, wordcloud etc.

It is worth mentioning that almost plots are based on ggplot2 and `plot_theme` function could easily change their border, legend, label etc., which could help user make their own plot.


## Bar Plot

Bar plot is the simplest way to show enriched terms. The x-axis is enrichment metric (e.g. Gene ratio, Fold enrichment); the y-axis is selected terms. The bar color represents statistical value.

> **What's the difference between pvalue and p.adjust?**
`p.adjust` has seven adjustment methods: <https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust>.
The adjusted p-value is always the p-value, multiplied with some factor: adj.p = f * p The actual size of this factor f depends on the strategy used to correct for multiple testing.
By the way, the "q-value" stands for "false discovery rate (FDR)" method.

```{r}
data(geneList, package = "genekitr")
id <- names(geneList)[abs(geneList) > 1.5]
logfc <- geneList[id]

ego <- genGO(id,
  org = "human", ont = "bp", pvalueCutoff = 0.01,
  qvalueCutoff = 0.01)
# Here just show head ten terms, you can choose your own interested terms!
ego <- ego[1:10,]
```

The basic arguments are: 

- `term_metric`: The x-axis could be "Count", "GeneRatio", "FoldEnrich" or "RichFactor"
- `stats_metric`: Statistic value of "p.adjust", "pvalue" or "qvalue"
- `up_color`: Color for stronger statistic value (e.g. pvalue 0.01)
- `down_color`: Color for weaker statistic value (e.g. pvalue 1)
- `wrap_length`: Wrap term text if longer than this number

(ref:barplotScap) Bar plot of enrichment analysis.

(ref:barplotCap) **Bar plot of enrichment analysis.** default (A), modify metrics (B),  modify color (C) and modify term length (D).

```{r barplot, fig.height=12, fig.width=16, fig.cap="(ref:barplotCap)", fig.scap="(ref:barplotScap)"}
library(patchwork)
p1 <- plotEnrich(ego,plot_type = "dot")
p2 <- plotEnrich(ego,plot_type = "dot", term_metric = "GeneRatio", stats_metric = "pvalue")
p3 <- plotEnrich(ego,plot_type = "dot", up_color = "#E69056", down_color = "#325CAC")
p4 <- plotEnrich(ego,plot_type = "dot", wrap_length = 20)
# p1 + p2 + p3 + p4 + plot_annotation(tag_levels = 'A')
cowplot::plot_grid(p1, p2, p3, p4, ncol=2, labels=LETTERS[1:4])
```
