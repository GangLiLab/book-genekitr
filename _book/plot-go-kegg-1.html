<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Plot GO and KEGG | Genekitr: Gene Analysis Toolkit based on R</title>
<meta name="author" content="Yunze Liu">
<meta name="description" content="After selecting interested terms or pathways from genGO or genKEGG result, user could pass the data frame to plotEnrich, which includes many ready-made plot types for GO and KEGG result, including...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 10 Plot GO and KEGG | Genekitr: Gene Analysis Toolkit based on R">
<meta property="og:type" content="book">
<meta property="og:description" content="After selecting interested terms or pathways from genGO or genKEGG result, user could pass the data frame to plotEnrich, which includes many ready-made plot types for GO and KEGG result, including...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Plot GO and KEGG | Genekitr: Gene Analysis Toolkit based on R">
<meta name="twitter:description" content="After selecting interested terms or pathways from genGO or genKEGG result, user could pass the data frame to plotEnrich, which includes many ready-made plot types for GO and KEGG result, including...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.22/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genekitr: Gene Analysis Toolkit based on R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">üß¨ Welcome to genekitr!</a></li>
<li><a class="" href="quick-start.html"><span class="header-section-number">1</span> Quick start</a></li>
<li class="book-part">Part I: Search Information</li>
<li><a class="" href="search-gene-metadata-1.html"><span class="header-section-number">2</span> Search gene metadata</a></li>
<li><a class="" href="search-pubmed-1.html"><span class="header-section-number">3</span> Search PubMed records</a></li>
<li class="book-part">Part II: ID Conversion</li>
<li><a class="" href="gene-id-conversion-1.html"><span class="header-section-number">4</span> Gene ID conversion</a></li>
<li><a class="" href="protein-id-conversion-1.html"><span class="header-section-number">5</span> Protein ID conversion</a></li>
<li><a class="" href="probe-id-conversion-1.html"><span class="header-section-number">6</span> Probe ID conversion</a></li>
<li class="book-part">Part III: Enrichment Analysis</li>
<li><a class="" href="ora-go-analysis-1.html"><span class="header-section-number">7</span> ORA GO analysis</a></li>
<li><a class="" href="ora-kegg-analysis-1.html"><span class="header-section-number">8</span> ORA KEGG analysis</a></li>
<li><a class="" href="functional-class-scoring-1.html"><span class="header-section-number">9</span> Functional Class Scoring</a></li>
<li class="book-part">Part IV: Plotting</li>
<li><a class="active" href="plot-go-kegg-1.html"><span class="header-section-number">10</span> Plot GO and KEGG</a></li>
<li><a class="" href="plot-gsea-1.html"><span class="header-section-number">11</span> Plot GSEA</a></li>
<li><a class="" href="plot-others-1.html"><span class="header-section-number">12</span> Plot others</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="plot-go-kegg-1" class="section level1">
<h1>
<span class="header-section-number">10</span> Plot GO and KEGG<a class="anchor" aria-label="anchor" href="#plot-go-kegg-1"><i class="fas fa-link"></i></a>
</h1>
<p>After selecting interested terms or pathways from <code>genGO</code> or <code>genKEGG</code> result, user could pass the data frame to <code>plotEnrich</code>, which includes many <strong>ready-made plot types</strong> for GO and KEGG result, including barplot, dotplot, heatmap, wego-like plot, chord plot, network, wordcloud etc.</p>
<p>It is worth mentioning that <strong>almost all plots are based on <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a></strong> and <code>plot_theme</code> function could easily change their border, legend, label etc., which helps user make their own plot.</p>
<div id="gokegg-bar-plot" class="section level2">
<h2>
<span class="header-section-number">10.1</span> GO/KEGG: Bar Plot<a class="anchor" aria-label="anchor" href="#gokegg-bar-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Bar plot is the simplest way to show enriched terms. The x-axis is enrichment metric (e.g.¬†Gene ratio; Fold enrichment); the y-axis is selected terms. The bar color represents statistical value.</p>
<blockquote>
<p><strong>What‚Äôs the difference between pvalue and p.adjust?</strong>
<code>p.adjust</code> has seven adjustment methods: <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust</a>.
The adjusted p-value is always the p-value, multiplied with some factor: adj.p = f * p The actual size of this factor f depends on the strategy used to correct for multiple testing.
By the way, the ‚Äúq-value‚Äù stands for ‚Äúfalse discovery rate (FDR)‚Äù method.</p>
</blockquote>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package <span class="op">=</span> <span class="st">"genekitr"</span><span class="op">)</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1.5</span><span class="op">]</span>
<span class="va">logfc</span> <span class="op">&lt;-</span> <span class="va">geneList</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>

<span class="va">ego</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">id</span>,
  org <span class="op">=</span> <span class="st">"human"</span>, ont <span class="op">=</span> <span class="st">"bp"</span>, pvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>,
  qvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>
<span class="op">)</span>
<span class="co"># Here just show top ten terms, you can choose your own interested terms!</span>
<span class="va">ego</span> <span class="op">&lt;-</span> <span class="va">ego</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></code></pre></div>
<p>The basic arguments are:</p>
<ul>
<li>
<code>term_metric</code>: The x-axis could be ‚ÄúCount‚Äù, ‚ÄúGeneRatio‚Äù, ‚ÄúFoldEnrich‚Äù or ‚ÄúRichFactor‚Äù</li>
<li>
<code>stats_metric</code>: Statistic value of ‚Äúp.adjust‚Äù, ‚Äúpvalue‚Äù or ‚Äúqvalue‚Äù</li>
<li>
<code>up_color</code>: Color for stronger statistic value (e.g.¬†pvalue 0.01)</li>
<li>
<code>down_color</code>: Color for weaker statistic value (e.g.¬†pvalue 1)</li>
<li>
<code>wrap_length</code>: Wrap term text if longer than this number</li>
</ul>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, term_metric <span class="op">=</span> <span class="st">"GeneRatio"</span>, stats_metric <span class="op">=</span> <span class="st">"pvalue"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, up_color <span class="op">=</span> <span class="st">"#E69056"</span>, down_color <span class="op">=</span> <span class="st">"#325CAC"</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, wrap_length <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:barplot"></span>
<img src="genekitr_files/figure-html/barplot-1.png" alt="Bar plot of enrichment analysis. default (A), modify metrics (B), modify color (C) and modify term length (D)." width="98%"><p class="caption">
Figure 10.1: <strong>Bar plot of enrichment analysis.</strong> default (A), modify metrics (B), modify color (C) and modify term length (D).
</p>
</div>
</div>
<div id="gokegg-bubble-plot" class="section level2">
<h2>
<span class="header-section-number">10.2</span> GO/KEGG: Bubble Plot<a class="anchor" aria-label="anchor" href="#gokegg-bubble-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Enriched gene sets are shown as bubbles with different sizes.</p>
<p>The x-axis is statistic value and the y-axis is ‚ÄúFold Enrichment‚Äù.</p>
<p>The basic arguments are:</p>
<ul>
<li>
<code>stats_metric</code>: Statistic value of ‚Äúp.adjust‚Äù, ‚Äúpvalue‚Äù or ‚Äúqvalue‚Äù</li>
<li>
<code>scale_ratio</code>: Change bubble size. Default is 1.</li>
</ul>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bubble"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bubble"</span>, 
                 scale_ratio <span class="op">=</span> <span class="fl">0.5</span>, stats_metric <span class="op">=</span> <span class="st">"qvalue"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:bubbleplot"></span>
<img src="genekitr_files/figure-html/bubbleplot-1.png" alt="Bubble plot of enrichment analysis. default (A), modify bubble size (B)." width="98%"><p class="caption">
Figure 10.2: <strong>Bubble plot of enrichment analysis.</strong> default (A), modify bubble size (B).
</p>
</div>
</div>
<div id="gokegg-dot-plot" class="section level2">
<h2>
<span class="header-section-number">10.3</span> GO/KEGG: Dot Plot<a class="anchor" aria-label="anchor" href="#gokegg-dot-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Similar with bar plot, dot plot is also widely used in enrichment analysis plotting. Like bubble plot, dot size represents gene number of enriched term.</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"dot"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  scale_ratio <span class="op">=</span> <span class="fl">1.5</span>,
  stats_metric <span class="op">=</span> <span class="st">"pvalue"</span>,
  term_metric <span class="op">=</span> <span class="st">"RichFactor"</span>
<span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:dotplot"></span>
<img src="genekitr_files/figure-html/dotplot-1.png" alt="Dot plot of enrichment analysis. default (A), modify bubble size (B)." width="98%"><p class="caption">
Figure 10.3: <strong>Dot plot of enrichment analysis.</strong> default (A), modify bubble size (B).
</p>
</div>
</div>
<div id="go-wego-plot" class="section level2">
<h2>
<span class="header-section-number">10.4</span> GO: WEGO Plot<a class="anchor" aria-label="anchor" href="#go-wego-plot"><i class="fas fa-link"></i></a>
</h2>
<p>If user analyzed more than one ontology, he may want to show them in one figure.
Inspired by <a href="https://wego.genomics.cn/">WEGO</a>, <code>genekitr</code> utilized <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a> to reproduce this plot.</p>
<p>Here we generate all three ontologies (BP,MF and CC) result.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_ego</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">id</span>,
  org <span class="op">=</span> <span class="st">"human"</span>,
  ont <span class="op">=</span> <span class="st">"all"</span>,
  pvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>,
  qvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">all_ego</span><span class="op">)</span></code></pre></div>
<pre><code>##            ONTOLOGY  Hs_ALL_ID                           Description  GeneRatio
## GO:0006260       BP GO:0006260                       DNA replication 0.12893082
## GO:0006261       BP GO:0006261         DNA-dependent DNA replication 0.09119497
## GO:0044786       BP GO:0044786            cell cycle DNA replication 0.05660377
## GO:0006270       BP GO:0006270            DNA replication initiation 0.04088050
## GO:0033260       BP GO:0033260               nuclear DNA replication 0.04716981
## GO:0000082       BP GO:0000082 G1/S transition of mitotic cell cycle 0.08490566
##              BgRatio       pvalue     p.adjust       qvalue
## GO:0006260 273/18866 4.610000e-27 1.763325e-23 1.431041e-23
## GO:0006261 151/18866 1.639358e-22 3.135271e-19 2.544455e-19
## GO:0044786  65/18866 1.816419e-17 2.315934e-14 1.879515e-14
## GO:0006270  39/18866 3.805391e-14 3.638905e-11 2.953183e-11
## GO:0033260  60/18866 4.866339e-14 3.722749e-11 3.021228e-11
## GO:0000082 287/18866 5.168380e-13 3.294842e-10 2.673957e-10
##                                                                                                                                                                                                                                        geneID
## GO:0006260 3725/4172/10036/54962/84515/51053/83990/26271/4171/4176/5983/10721/79075/79733/4174/9837/4173/983/79915/4175/9768/91607/144455/253714/90381/23594/675/51659/4998/5427/157570/641/5888/6241/8318/9156/9134/55388/63967/51514/374393
## GO:0006261                                                                     4172/54962/51053/26271/4171/4176/5983/10721/79075/79733/4174/9837/4173/79915/4175/91607/144455/253714/90381/23594/675/51659/4998/5427/641/5888/8318/9134/55388
## GO:0044786                                                                                                                                    4172/54962/51053/26271/4171/4176/5983/79733/4174/9837/4173/79915/4175/144455/675/5427/5888/8318
## GO:0006270                                                                                                                                                                4172/4171/4176/4174/4173/4175/90381/23594/4998/5427/8318/9134/55388
## GO:0033260                                                                                                                                                       4172/54962/51053/4171/4176/5983/4174/9837/4173/79915/4175/675/5427/5888/8318
## GO:0000082                                                                                  4582/4172/84515/51053/1869/26271/4171/4176/10217/79733/4174/4173/983/4175/91607/144455/23594/4998/407007/5427/6241/595/407006/8318/993/9134/55388
##                                                                                                                                                                                                                                  geneID_symbol
## GO:0006260 JUN/MCM3/CHAF1A/TIPIN/MCM8/GMNN/BRIP1/FBXO5/MCM2/MCM7/RFC3/POLQ/DSCC1/E2F8/MCM5/GINS1/MCM4/CDK1/ATAD5/MCM6/PCLAF/SLFN11/E2F7/MMS22L/TICRR/ORC6/BRCA2/GINS2/ORC1/POLE2/ESCO2/BLM/RAD51/RRM2/CDC45/EXO1/CCNE2/MCM10/CLSPN/DTL/FAM111B
## GO:0006261                                                                    MCM3/TIPIN/GMNN/FBXO5/MCM2/MCM7/RFC3/POLQ/DSCC1/E2F8/MCM5/GINS1/MCM4/ATAD5/MCM6/SLFN11/E2F7/MMS22L/TICRR/ORC6/BRCA2/GINS2/ORC1/POLE2/BLM/RAD51/CDC45/CCNE2/MCM10
## GO:0044786                                                                                                                                   MCM3/TIPIN/GMNN/FBXO5/MCM2/MCM7/RFC3/E2F8/MCM5/GINS1/MCM4/ATAD5/MCM6/E2F7/BRCA2/POLE2/RAD51/CDC45
## GO:0006270                                                                                                                                                               MCM3/MCM2/MCM7/MCM5/MCM4/MCM6/TICRR/ORC6/ORC1/POLE2/CDC45/CCNE2/MCM10
## GO:0033260                                                                                                                                                   MCM3/TIPIN/GMNN/MCM2/MCM7/RFC3/MCM5/GINS1/MCM4/ATAD5/MCM6/BRCA2/POLE2/RAD51/CDC45
## GO:0000082                                                                              MUC1/MCM3/MCM8/GMNN/E2F1/FBXO5/MCM2/MCM7/CTDSPL/E2F8/MCM5/MCM4/CDK1/MCM6/SLFN11/E2F7/ORC6/ORC1/MIR222/POLE2/RRM2/CCND1/MIR221/CDC45/CDC25A/CCNE2/MCM10
##            Count FoldEnrich RichFactor
## GO:0006260    41   8.909922 0.15018315
## GO:0006261    29  11.393936 0.19205298
## GO:0044786    18  16.429028 0.27692308
## GO:0006270    13  19.775681 0.33333333
## GO:0033260    15  14.831761 0.25000000
## GO:0000082    27   5.581290 0.09407666</code></pre>
<blockquote>
<p>If you just want to show two ontologies, you can rbind both dataframes and give the new dataframe a new column ‚ÄúONTOLOGY‚Äù to distinguish different ontologies.</p>
</blockquote>
<p><strong>NOTICE:</strong> <code>plotEnrich</code> has a parameter <code>n_term</code> for WEGO plot, which specify number of terms. If you want to plot all terms, just set <code>n_term</code> higher.</p>


<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">all_ego</span>, plot_type <span class="op">=</span> <span class="st">"wego"</span>, n_term <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:wegoplot"></span>
<img src="genekitr_files/figure-html/wegoplot-1.png" alt="WEGO plot of enrichment analysis." width="98%"><p class="caption">
Figure 10.4: <strong>WEGO plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="gokegg-lollipop-plot" class="section level2">
<h2>
<span class="header-section-number">10.5</span> GO/KEGG: Lollipop Plot<a class="anchor" aria-label="anchor" href="#gokegg-lollipop-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Lollipop is like combination of barplot and dotplot</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"lollipop"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"lollipop"</span>,
  scale_ratio <span class="op">=</span> <span class="fl">1.2</span>,
  stats_metric <span class="op">=</span> <span class="st">"pvalue"</span>,
  term_metric <span class="op">=</span> <span class="st">"RichFactor"</span>,
  up_color <span class="op">=</span> <span class="st">"#a32a31"</span>,
  down_color <span class="op">=</span> <span class="st">"#f7dcca"</span>
<span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:lolliplot"></span>
<img src="genekitr_files/figure-html/lolliplot-1.png" alt="Lollipop plot of enrichment analysis. defult (A), selected genes (B)" width="98%"><p class="caption">
Figure 10.5: <strong>Lollipop plot of enrichment analysis.</strong> defult (A), selected genes (B)
</p>
</div>
</div>
<div id="gokegg-heatmap-plot" class="section level2">
<h2>
<span class="header-section-number">10.6</span> GO/KEGG: Heatmap Plot<a class="anchor" aria-label="anchor" href="#gokegg-heatmap-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Heatmap plot shows interactions between enriched terms and their genes.
If fold change is given, heatmap will add color for up and down-regulated genes.</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"geneheat"</span><span class="op">)</span>
<span class="va">show_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA2"</span>, <span class="st">"CDK1"</span>, <span class="st">"JUN"</span>, <span class="st">"MCM8"</span>, <span class="st">"TIPIN"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"geneheat"</span>, show_gene <span class="op">=</span> <span class="va">show_gene</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"geneheat"</span>, show_gene <span class="op">=</span> <span class="va">show_gene</span>, fold_change <span class="op">=</span> <span class="va">logfc</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:heatmap"></span>
<img src="genekitr_files/figure-html/heatmap-1.png" alt="Heatmap plot of enrichment analysis. all genes (A, default), selected genes (B), selected genes with logFC value (C)." width="98%"><p class="caption">
Figure 10.6: <strong>Heatmap plot of enrichment analysis.</strong> all genes (A, default), selected genes (B), selected genes with logFC value (C).
</p>
</div>
</div>
<div id="gokegg-chord-plot" class="section level2">
<h2>
<span class="header-section-number">10.7</span> GO/KEGG: Chord Plot<a class="anchor" aria-label="anchor" href="#gokegg-chord-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <a href="https://wencke.github.io/">GOplot</a>, chord plot is reproduced using <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a> and it shows similar content with heatmap plot.</p>
<ul>
<li>
<code>gene_space</code>: The space between the gene labels and the chord.</li>
</ul>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">show_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA2"</span>, <span class="st">"CDK1"</span>, <span class="st">"JUN"</span>, <span class="st">"MCM8"</span>, <span class="st">"TIPIN"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"genechord"</span>, 
                 show_gene <span class="op">=</span> <span class="va">show_gene</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"genechord"</span>, 
                 show_gene <span class="op">=</span> <span class="va">show_gene</span>, 
                 fold_change <span class="op">=</span> <span class="va">logfc</span>,
                 gene_space <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:chord"></span>
<img src="genekitr_files/figure-html/chord-1.png" alt="Heatmap plot of enrichment analysis. selected genes (A), selected genes with logFC value (B)." width="98%"><p class="caption">
Figure 10.7: <strong>Heatmap plot of enrichment analysis.</strong> selected genes (A), selected genes with logFC value (B).
</p>
</div>
</div>
<div id="gokegg-wordcloud-plot" class="section level2">
<h2>
<span class="header-section-number">10.8</span> GO/KEGG: Wordcloud Plot<a class="anchor" aria-label="anchor" href="#gokegg-wordcloud-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Wordcloud plot shows term emphasis based on text frequency.</p>


<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"wordcloud"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:wordcloud"></span>
<img src="genekitr_files/figure-html/wordcloud-1.png" alt="Wordcloud plot of enrichment analysis." width="98%"><p class="caption">
Figure 10.8: <strong>Wordcloud plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="gokegg-upset-plot" class="section level2">
<h2>
<span class="header-section-number">10.9</span> GO/KEGG: Upset Plot<a class="anchor" aria-label="anchor" href="#gokegg-upset-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <a href="https://CRAN.R-project.org/package=ComplexUpset">ComplexUpset</a>, the upset plot shows the association between genes and enriched terms. Unlike common Venn diagram, it could emphasize complex relationship among many gene sets.</p>


<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"upset"</span>,main_text_size <span class="op">=</span> <span class="fl">15</span>,legend_text_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:upset"></span>
<img src="genekitr_files/figure-html/upset-1.png" alt="Upset plot of enrichment analysis." width="98%"><p class="caption">
Figure 10.9: <strong>Upset plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="gokegg-network-plot" class="section level2">
<h2>
<span class="header-section-number">10.10</span> GO/KEGG: Network Plot<a class="anchor" aria-label="anchor" href="#gokegg-network-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <code><a href="https://rdrr.io/pkg/enrichplot/man/emapplot.html">enrichplot::emapplot</a></code>, <code>genekitr</code> reproduced this plot to enhance modification.
Enriched terms are the nodes in the network, the overlapping gene sets are edges. Terms with more overlapped genes are tend to cluster together and the edge will be thicker.</p>
<ul>
<li>GO analysis result could use five methods to calculate the similarity between nodes: ‚ÄúResnik‚Äù, ‚ÄúLin‚Äù, ‚ÄúRel‚Äù, ‚ÄúJiang‚Äù, ‚ÄúWang‚Äù and ‚ÄúJC‚Äù(Jaccard‚Äôs similarity index) methods.</li>
<li>KEGG only supports ‚ÄúJC‚Äù method.</li>
</ul>
<p>User could define <code>layout</code> argument derived from <a href="https://CRAN.R-project.org/package=ggraph">ggraph</a>, including ‚Äúnicely‚Äù (default), ‚Äúcircle‚Äù, ‚Äúdh‚Äù, ‚Äúdrl‚Äù, ‚Äúfr‚Äù, ‚Äúgraphopt‚Äù, ‚Äúgrid‚Äù,‚Äúlgl‚Äù, ‚Äúkk‚Äù, ‚Äúmds‚Äù, ‚Äúrandomly‚Äù, ‚Äústar‚Äù etc.</p>
<blockquote>
<p>For more information about the <code>layout</code>, you could refer to: <a href="https://www.data-imaginist.com/2017/ggraph-introduction-layouts/">‚ÄúIntroduction to ggraph: Layouts‚Äù</a></p>
</blockquote>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"network"</span>, scale_ratio <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"network"</span>, 
                 layout <span class="op">=</span> <span class="st">"circle"</span>, scale_ratio <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"network"</span>, 
                 layout <span class="op">=</span> <span class="st">"grid"</span>, sim_method <span class="op">=</span> <span class="st">"Wang"</span>,
                 up_color <span class="op">=</span> <span class="st">"#a32a31"</span>, down_color <span class="op">=</span> <span class="st">"#f7dcca"</span><span class="op">)</span>
<span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:network"></span>
<img src="genekitr_files/figure-html/network-1.png" alt="Network plot of enrichment analysis. JC method and nicely layout(A, default), circle layout (B), grid layout and Want method (C)." width="98%"><p class="caption">
Figure 10.10: <strong>Network plot of enrichment analysis.</strong> JC method and nicely layout(A, default), circle layout (B), grid layout and Want method (C).
</p>
</div>
</div>
<div id="go-map-plot" class="section level2">
<h2>
<span class="header-section-number">10.11</span> GO: Map Plot<a class="anchor" aria-label="anchor" href="#go-map-plot"><i class="fas fa-link"></i></a>
</h2>
<p>GO terms are built in a directed acyclic graph with a parent-child relationship.
Here the map plot utilized <a href="http://bioconductor.org/packages/GOSemSim">GOSemSim</a> to extract parent and child terms, also utilized <a href="https://CRAN.R-project.org/package=ggraph">ggraph</a> and <a href="https://CRAN.R-project.org/package=igraph">igraph</a> to draw with default layout ‚Äúsugiyama‚Äù.</p>
<p>To avoid too much unrelated terms messed up, <code>genekitr</code> <strong>only shows the closest parent and child with selected terms</strong>. Besides, the top three parent term with more edges will be plotted.</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"gomap"</span>, wrap_length <span class="op">=</span> <span class="fl">25</span>,
           up_color <span class="op">=</span> <span class="st">'#a32a31'</span>,down_color <span class="op">=</span> <span class="st">'#3665a6'</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:map"></span>
<img src="genekitr_files/figure-html/map-1.png" alt="Map plot of enrichment analysis." width="98%"><p class="caption">
Figure 10.11: <strong>Map plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="go-terms-heatmap-plot" class="section level2">
<h2>
<span class="header-section-number">10.12</span> GO: Terms Heatmap Plot<a class="anchor" aria-label="anchor" href="#go-terms-heatmap-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <a href="http://bioconductor.org/packages/rrvgo">rrvgo</a>, <code>genekitr</code> scratches main codes to cluster GO terms. Also it could use five methods to calculate the similarity between terms.</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"goheat"</span>, sim_method <span class="op">=</span> <span class="st">"Rel"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:goheat"></span>
<img src="genekitr_files/figure-html/goheat-1.png" alt="GO heatmap plot of enrichment analysis." width="98%"><p class="caption">
Figure 10.12: <strong>GO heatmap plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="go-terms-tangram-plot" class="section level2">
<h2>
<span class="header-section-number">10.13</span> GO: Terms Tangram Plot<a class="anchor" aria-label="anchor" href="#go-terms-tangram-plot"><i class="fas fa-link"></i></a>
</h2>
<p>According to <a href="http://bioconductor.org/packages/release/bioc/vignettes/rrvgo/inst/doc/rrvgo.html">rrvgo vignettes</a>, tangram plot is space-filling visualization of hierarchical structures. The terms are grouped and colored based on their parent, and the space used by the term is proportional to the score.</p>


<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"gotangram"</span>, sim_method <span class="op">=</span> <span class="st">"Rel"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:gotangram"></span>
<img src="genekitr_files/figure-html/gotangram-1.png" alt="GO tangram plot of enrichment analysis." width="98%"><p class="caption">
Figure 10.13: <strong>GO tangram plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="plot-theme" class="section level2">
<h2>
<span class="header-section-number">10.14</span> Plot Theme<a class="anchor" aria-label="anchor" href="#plot-theme"><i class="fas fa-link"></i></a>
</h2>
<p><code>Genekitr</code> provides a function <code><a href="https://rdrr.io/pkg/genekitr/man/plot_theme.html">plot_theme()</a></code> to modify all plots theme including text size, border, legend, color, etc.</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"dot"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  main_text_size <span class="op">=</span> <span class="fl">10</span>,
  legend_text_size <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  border_thick <span class="op">=</span> <span class="fl">3</span>,
  remove_grid <span class="op">=</span> <span class="cn">F</span>
<span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  remove_main_text <span class="op">=</span> <span class="cn">T</span>,
  remove_legend_text <span class="op">=</span> <span class="cn">T</span>,
  remove_legend <span class="op">=</span> <span class="cn">T</span>
<span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/patchwork/man/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:theme"></span>
<img src="genekitr_files/figure-html/theme-1.png" alt="Plot theme. default theme (A), modify text size (B), modify grid line and border size (C) and remove all text and legend (D)." width="98%"><p class="caption">
Figure 10.14: <strong>Plot theme.</strong> default theme (A), modify text size (B), modify grid line and border size (C) and remove all text and legend (D).
</p>
</div>
</div>
<div id="advanced-plot" class="section level2">
<h2>
<span class="header-section-number">10.15</span> Advanced Plot<a class="anchor" aria-label="anchor" href="#advanced-plot"><i class="fas fa-link"></i></a>
</h2>
<div id="two-group-barplot-for-updown-regulated-pathways" class="section level3">
<h3>
<span class="header-section-number">10.15.1</span> Two-group barplot for up/down regulated pathways<a class="anchor" aria-label="anchor" href="#two-group-barplot-for-updown-regulated-pathways"><i class="fas fa-link"></i></a>
</h3>
<p>If user does <code>genGO</code> or <code>genKEGG</code> for up and down regulated genes separately and wants to visualize them together, the two-group barplot is well suited. Here we take GO result as an example:</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Since the geneList is logFC decreasing ordered, we could take first 100 as up-regulated genes and vice versa.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package <span class="op">=</span> <span class="st">"genekitr"</span><span class="op">)</span>
<span class="va">up_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">down_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>

<span class="va">up_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">up_genes</span>,
               org <span class="op">=</span> <span class="st">"human"</span>, 
               ont <span class="op">=</span> <span class="st">"bp"</span>, 
               pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,
               qvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>
<span class="op">)</span>

<span class="va">down_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">down_genes</span>,
                 org <span class="op">=</span> <span class="st">"human"</span>, 
                 ont <span class="op">=</span> <span class="st">"bp"</span>, 
                 pvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>,
                 qvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">up_go</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 62 12</code></pre>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">down_go</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 114  12</code></pre>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># seems that up/down-regulated pathways are too many, here we only take 10 of them</span>
<span class="va">up_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">up_go</span>, <span class="fl">10</span><span class="op">)</span>
<span class="va">down_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">down_go</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>There are two visulization types:</p>
<ul>
<li>
<code>plot_type = "one"</code>: both up and down-regulated pathways are plotted together</li>
<li>
<code>plot_type = "two"</code>: up and down-regulated pathways are plotted separately. <strong>Recommended if the number of both groups is similar.</strong>
</li>
</ul>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrichAdv.html">plotEnrichAdv</a></span><span class="op">(</span><span class="va">up_go</span>, <span class="va">down_go</span>,
              plot_type <span class="op">=</span> <span class="st">"one"</span>,
              stats_metric <span class="op">=</span> <span class="st">"p.adjust"</span>,
              xlim_left <span class="op">=</span> <span class="fl">25</span>, xlim_right <span class="op">=</span> <span class="fl">15</span>
<span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:twogroup1"></span>
<img src="genekitr_files/figure-html/twogroup1-1.png" alt="Visualize two groups together when plot_type = " one width="98%"><p class="caption">
Figure 10.15: <strong>Visualize two groups together when <code>plot_type = "one"</code>.</strong>
</p>
</div>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrichAdv.html">plotEnrichAdv</a></span><span class="op">(</span><span class="va">up_go</span>, <span class="va">down_go</span>,
              plot_type <span class="op">=</span> <span class="st">"two"</span>,
              stats_metric <span class="op">=</span> <span class="st">"qvalue"</span>
<span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:twogroup2"></span>
<img src="genekitr_files/figure-html/twogroup2-1.png" alt="Visualize two groups seperately when plot_type = " two width="98%"><p class="caption">
Figure 10.16: <strong>Visualize two groups seperately when <code>plot_type = "two"</code>.</strong>
</p>
</div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="functional-class-scoring-1.html"><span class="header-section-number">9</span> Functional Class Scoring</a></div>
<div class="next"><a href="plot-gsea-1.html"><span class="header-section-number">11</span> Plot GSEA</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot-go-kegg-1"><span class="header-section-number">10</span> Plot GO and KEGG</a></li>
<li><a class="nav-link" href="#gokegg-bar-plot"><span class="header-section-number">10.1</span> GO/KEGG: Bar Plot</a></li>
<li><a class="nav-link" href="#gokegg-bubble-plot"><span class="header-section-number">10.2</span> GO/KEGG: Bubble Plot</a></li>
<li><a class="nav-link" href="#gokegg-dot-plot"><span class="header-section-number">10.3</span> GO/KEGG: Dot Plot</a></li>
<li><a class="nav-link" href="#go-wego-plot"><span class="header-section-number">10.4</span> GO: WEGO Plot</a></li>
<li><a class="nav-link" href="#gokegg-lollipop-plot"><span class="header-section-number">10.5</span> GO/KEGG: Lollipop Plot</a></li>
<li><a class="nav-link" href="#gokegg-heatmap-plot"><span class="header-section-number">10.6</span> GO/KEGG: Heatmap Plot</a></li>
<li><a class="nav-link" href="#gokegg-chord-plot"><span class="header-section-number">10.7</span> GO/KEGG: Chord Plot</a></li>
<li><a class="nav-link" href="#gokegg-wordcloud-plot"><span class="header-section-number">10.8</span> GO/KEGG: Wordcloud Plot</a></li>
<li><a class="nav-link" href="#gokegg-upset-plot"><span class="header-section-number">10.9</span> GO/KEGG: Upset Plot</a></li>
<li><a class="nav-link" href="#gokegg-network-plot"><span class="header-section-number">10.10</span> GO/KEGG: Network Plot</a></li>
<li><a class="nav-link" href="#go-map-plot"><span class="header-section-number">10.11</span> GO: Map Plot</a></li>
<li><a class="nav-link" href="#go-terms-heatmap-plot"><span class="header-section-number">10.12</span> GO: Terms Heatmap Plot</a></li>
<li><a class="nav-link" href="#go-terms-tangram-plot"><span class="header-section-number">10.13</span> GO: Terms Tangram Plot</a></li>
<li><a class="nav-link" href="#plot-theme"><span class="header-section-number">10.14</span> Plot Theme</a></li>
<li>
<a class="nav-link" href="#advanced-plot"><span class="header-section-number">10.15</span> Advanced Plot</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#two-group-barplot-for-updown-regulated-pathways"><span class="header-section-number">10.15.1</span> Two-group barplot for up/down regulated pathways</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genekitr: Gene Analysis Toolkit based on R</strong>" was written by Yunze Liu. It was last built on 2022-06-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
