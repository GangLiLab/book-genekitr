<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Plot GO and KEGG | Genekitr: Gene Analysis Toolkit based on R</title>
<meta name="author" content="Yunze Liu">
<meta name="description" content="After selecting interested terms or pathways from genGO or genKEGG result, user could pass the data frame to plotEnrich, which includes many ready-made plot types for GO and KEGG result, including...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 11 Plot GO and KEGG | Genekitr: Gene Analysis Toolkit based on R">
<meta property="og:type" content="book">
<meta property="og:description" content="After selecting interested terms or pathways from genGO or genKEGG result, user could pass the data frame to plotEnrich, which includes many ready-made plot types for GO and KEGG result, including...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Plot GO and KEGG | Genekitr: Gene Analysis Toolkit based on R">
<meta name="twitter:description" content="After selecting interested terms or pathways from genGO or genKEGG result, user could pass the data frame to plotEnrich, which includes many ready-made plot types for GO and KEGG result, including...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.22/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genekitr: Gene Analysis Toolkit based on R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">üß¨ Welcome to genekitr!</a></li>
<li><a class="" href="quick-start.html"><span class="header-section-number">1</span> Quick start</a></li>
<li class="book-part">Part I: Search Information</li>
<li><a class="" href="search-gene-metadata-1.html"><span class="header-section-number">2</span> Search gene metadata</a></li>
<li><a class="" href="search-pubmed-1.html"><span class="header-section-number">3</span> Search PubMed records</a></li>
<li class="book-part">Part II: ID Conversion</li>
<li><a class="" href="gene-id-conversion-1.html"><span class="header-section-number">4</span> Gene ID conversion</a></li>
<li><a class="" href="protein-id-conversion-1.html"><span class="header-section-number">5</span> Protein ID conversion</a></li>
<li><a class="" href="probe-id-conversion-1.html"><span class="header-section-number">6</span> Probe ID conversion</a></li>
<li class="book-part">Part III: Enrichment Analysis</li>
<li><a class="" href="ora-go-analysis-1.html"><span class="header-section-number">7</span> ORA GO analysis</a></li>
<li><a class="" href="ora-kegg-analysis-1.html"><span class="header-section-number">8</span> ORA KEGG analysis</a></li>
<li><a class="" href="functional-class-scoring-1.html"><span class="header-section-number">9</span> Functional Class Scoring</a></li>
<li><a class="" href="import-external-data.html"><span class="header-section-number">10</span> Import External Data</a></li>
<li class="book-part">Part IV: Plotting</li>
<li><a class="active" href="plot-go-kegg-1.html"><span class="header-section-number">11</span> Plot GO and KEGG</a></li>
<li><a class="" href="plot-gsea-1.html"><span class="header-section-number">12</span> Plot GSEA</a></li>
<li><a class="" href="plot-others-1.html"><span class="header-section-number">13</span> Plot others</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="plot-go-kegg-1" class="section level1">
<h1>
<span class="header-section-number">11</span> Plot GO and KEGG<a class="anchor" aria-label="anchor" href="#plot-go-kegg-1"><i class="fas fa-link"></i></a>
</h1>
<p>After selecting interested terms or pathways from <code>genGO</code> or <code>genKEGG</code> result, user could pass the data frame to <code>plotEnrich</code>, which includes many <strong>ready-made plot types</strong> for GO and KEGG result, including barplot, dotplot, heatmap, wego-like plot, chord plot, network, wordcloud etc.</p>
<p>It is worth mentioning that <strong>almost all plots are based on <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a></strong> and <code>plot_theme</code> function could easily change their border, legend, label etc., which helps user make their own plot.</p>
<div id="gokegg-bar-plot" class="section level2">
<h2>
<span class="header-section-number">11.1</span> GO/KEGG: Bar Plot<a class="anchor" aria-label="anchor" href="#gokegg-bar-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Bar plot is the simplest way to show enriched terms. The x-axis is enrichment metric (e.g.¬†Gene ratio; Fold enrichment); the y-axis is selected terms. The bar color represents statistical value.</p>
<blockquote>
<p><strong>What‚Äôs the difference between pvalue and p.adjust?</strong>
<code>p.adjust</code> has seven adjustment methods: <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust" class="uri">https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust</a>.
The adjusted p-value is always the p-value, multiplied with some factor: adj.p = f * p The actual size of this factor f depends on the strategy used to correct for multiple testing.
By the way, the ‚Äúq-value‚Äù stands for ‚Äúfalse discovery rate (FDR)‚Äù method.</p>
</blockquote>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package <span class="op">=</span> <span class="st">"genekitr"</span><span class="op">)</span>
<span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1.5</span><span class="op">]</span>
<span class="va">logfc</span> <span class="op">&lt;-</span> <span class="va">geneList</span><span class="op">[</span><span class="va">id</span><span class="op">]</span>

<span class="va">ego</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">id</span>,
  org <span class="op">=</span> <span class="st">"human"</span>, ont <span class="op">=</span> <span class="st">"bp"</span>, pvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>,
  qvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>
<span class="op">)</span>
<span class="co"># Here just show top ten terms, you can choose your own interested terms!</span>
<span class="va">ego</span> <span class="op">&lt;-</span> <span class="va">ego</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></code></pre></div>
<p>The basic arguments are:</p>
<ul>
<li>
<code>term_metric</code>: The x-axis could be ‚ÄúCount‚Äù, ‚ÄúGeneRatio‚Äù, ‚ÄúFoldEnrich‚Äù or ‚ÄúRichFactor‚Äù</li>
<li>
<code>stats_metric</code>: Statistic value of ‚Äúp.adjust‚Äù, ‚Äúpvalue‚Äù or ‚Äúqvalue‚Äù</li>
<li>
<code>up_color</code>: Color for stronger statistic value (e.g.¬†pvalue 0.01)</li>
<li>
<code>down_color</code>: Color for weaker statistic value (e.g.¬†pvalue 1)</li>
<li>
<code>wrap_length</code>: Wrap term text if longer than this number</li>
</ul>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, term_metric <span class="op">=</span> <span class="st">"GeneRatio"</span>, stats_metric <span class="op">=</span> <span class="st">"pvalue"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, up_color <span class="op">=</span> <span class="st">"#E69056"</span>, down_color <span class="op">=</span> <span class="st">"#325CAC"</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>, wrap_length <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:barplot"></span>
<img src="genekitr_files/figure-html/barplot-1.png" alt="Bar plot of enrichment analysis. default (A), modify metrics (B), modify color (C) and modify term length (D)." width="98%"><p class="caption">
Figure 11.1: <strong>Bar plot of enrichment analysis.</strong> default (A), modify metrics (B), modify color (C) and modify term length (D).
</p>
</div>
</div>
<div id="gokegg-bubble-plot" class="section level2">
<h2>
<span class="header-section-number">11.2</span> GO/KEGG: Bubble Plot<a class="anchor" aria-label="anchor" href="#gokegg-bubble-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Enriched gene sets are shown as bubbles with different sizes.</p>
<p>The x-axis is statistic value and the y-axis is ‚ÄúFold Enrichment‚Äù.</p>
<p>The basic arguments are:</p>
<ul>
<li>
<code>stats_metric</code>: Statistic value of ‚Äúp.adjust‚Äù, ‚Äúpvalue‚Äù or ‚Äúqvalue‚Äù</li>
<li>
<code>scale_ratio</code>: Change bubble size. Default is 1.</li>
</ul>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bubble"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"bubble"</span>, 
                 scale_ratio <span class="op">=</span> <span class="fl">0.5</span>, stats_metric <span class="op">=</span> <span class="st">"qvalue"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:bubbleplot"></span>
<img src="genekitr_files/figure-html/bubbleplot-1.png" alt="Bubble plot of enrichment analysis. default (A), modify bubble size (B)." width="98%"><p class="caption">
Figure 11.2: <strong>Bubble plot of enrichment analysis.</strong> default (A), modify bubble size (B).
</p>
</div>
</div>
<div id="gokegg-dot-plot" class="section level2">
<h2>
<span class="header-section-number">11.3</span> GO/KEGG: Dot Plot<a class="anchor" aria-label="anchor" href="#gokegg-dot-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Similar with bar plot, dot plot is also widely used in enrichment analysis plotting. Like bubble plot, dot size represents gene number of enriched term.</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"dot"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  scale_ratio <span class="op">=</span> <span class="fl">1.5</span>,
  stats_metric <span class="op">=</span> <span class="st">"pvalue"</span>,
  term_metric <span class="op">=</span> <span class="st">"RichFactor"</span>
<span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:dotplot"></span>
<img src="genekitr_files/figure-html/dotplot-1.png" alt="Dot plot of enrichment analysis. default (A), modify bubble size (B)." width="98%"><p class="caption">
Figure 11.3: <strong>Dot plot of enrichment analysis.</strong> default (A), modify bubble size (B).
</p>
</div>
<p>After analyzing group enrichment analysis for <a href="ora-go-analysis-1.html#go-group-enrichment">GO</a> or <a href="ora-kegg-analysis-1.html#kegg-group-enrichment">KEGG</a>, we could use <code>dotplot</code> to show the result:</p>


<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">gego2</span>,
           plot_type <span class="op">=</span> <span class="st">'dot'</span>,
           scale_ratio <span class="op">=</span> <span class="fl">2</span>, <span class="co"># dot size</span>
           main_text_size <span class="op">=</span> <span class="fl">10</span>,
           legend_text_size <span class="op">=</span><span class="fl">8</span>,
           n_term <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> <span class="co"># show terms</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:dotplotGroup"></span>
<img src="genekitr_files/figure-html/dotplotGroup-1.png" alt="Dot plot of group enrichment analysis." width="98%"><p class="caption">
Figure 11.4: <strong>Dot plot of group enrichment analysis.</strong>
</p>
</div>
</div>
<div id="go-wego-plot" class="section level2">
<h2>
<span class="header-section-number">11.4</span> GO: WEGO Plot<a class="anchor" aria-label="anchor" href="#go-wego-plot"><i class="fas fa-link"></i></a>
</h2>
<p>If user analyzed more than one ontology, he may want to show them in one figure.
Inspired by <a href="https://wego.genomics.cn/">WEGO</a>, <code>genekitr</code> utilized <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a> to reproduce this plot.</p>
<p>Here we generate all three ontologies (BP,MF and CC) result.</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_ego</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">id</span>,
  org <span class="op">=</span> <span class="st">"human"</span>,
  ont <span class="op">=</span> <span class="st">"all"</span>,
  pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,
  qvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">all_ego</span><span class="op">)</span></code></pre></div>
<pre><code>##            ONTOLOGY  Hs_ALL_ID
## GO:0006260       BP GO:0006260
## GO:0050673       BP GO:0050673
## GO:1901992       BP GO:1901992
## GO:0010165       BP GO:0010165
## GO:1901989       BP GO:1901989
## GO:0045931       BP GO:0045931
##                                                           Description
## GO:0006260                                            DNA replication
## GO:0050673                              epithelial cell proliferation
## GO:1901992 positive regulation of mitotic cell cycle phase transition
## GO:0010165                                          response to X-ray
## GO:1901989         positive regulation of cell cycle phase transition
## GO:0045931                  positive regulation of mitotic cell cycle
##             GeneRatio   BgRatio       pvalue     p.adjust       qvalue
## GO:0006260 0.12121212 273/18866 2.001739e-08 4.966314e-05 3.923408e-05
## GO:0050673 0.14141414 453/18866 1.024312e-07 1.270658e-04 1.003825e-04
## GO:1901992 0.07070707  94/18866 6.231910e-07 4.011247e-04 3.168901e-04
## GO:0010165 0.05050505  32/18866 6.467146e-07 4.011247e-04 3.168901e-04
## GO:1901989 0.07070707 110/18866 1.809525e-06 8.978861e-04 7.093337e-04
## GO:0045931 0.08080808 168/18866 2.878804e-06 1.190385e-03 9.404092e-04
##                                                                              geneID
## GO:0006260        5427/157570/641/5888/6241/8318/9156/9134/55388/63967/51514/374393
## GO:0050673 5176/26471/3488/6591/8549/407007/6422/29128/595/7039/7099/374/3690/10468
## GO:1901992                                  407007/113130/595/407006/8318/993/51514
## GO:0010165                                                   6422/641/5888/595/7516
## GO:1901989                                  407007/113130/595/407006/8318/993/51514
## GO:0045931                             407007/113130/595/407006/7039/8318/993/51514
##                                                                                 geneID_symbol
## GO:0006260                POLE2/ESCO2/BLM/RAD51/RRM2/CDC45/EXO1/CCNE2/MCM10/CLSPN/DTL/FAM111B
## GO:0050673 SERPINF1/NUPR1/IGFBP5/SNAI2/LGR5/MIR222/SFRP1/UHRF1/CCND1/TGFA/TLR4/AREG/ITGB3/FST
## GO:1901992                                         MIR222/CDCA5/CCND1/MIR221/CDC45/CDC25A/DTL
## GO:0010165                                                        SFRP1/BLM/RAD51/CCND1/XRCC2
## GO:1901989                                         MIR222/CDCA5/CCND1/MIR221/CDC45/CDC25A/DTL
## GO:0045931                                    MIR222/CDCA5/CCND1/MIR221/TGFA/CDC45/CDC25A/DTL
##            Count FoldEnrich RichFactor
## GO:0006260    12   8.376512 0.04395604
## GO:0050673    14   5.889446 0.03090508
## GO:1901992     7  14.191060 0.07446809
## GO:0010165     5  29.775884 0.15625000
## GO:1901989     7  12.126905 0.06363636
## GO:0045931     8   9.074555 0.04761905</code></pre>
<blockquote>
<p>If you just want to show two ontologies, you can rbind both dataframes and give the new dataframe a new column ‚ÄúONTOLOGY‚Äù to distinguish different ontologies.</p>
</blockquote>
<p><strong>NOTICE:</strong> <code>plotEnrich</code> has a parameter <code>n_term</code> for WEGO plot, which specify number of terms. If you want to plot all terms, just set <code>n_term</code> higher.</p>


<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">all_ego</span>, plot_type <span class="op">=</span> <span class="st">"wego"</span>, n_term <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:wegoplot"></span>
<img src="genekitr_files/figure-html/wegoplot-1.png" alt="WEGO plot of enrichment analysis." width="98%"><p class="caption">
Figure 11.5: <strong>WEGO plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="gokegg-lollipop-plot" class="section level2">
<h2>
<span class="header-section-number">11.5</span> GO/KEGG: Lollipop Plot<a class="anchor" aria-label="anchor" href="#gokegg-lollipop-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Lollipop is like combination of barplot and dotplot</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"lollipop"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"lollipop"</span>,
  scale_ratio <span class="op">=</span> <span class="fl">1.2</span>,
  stats_metric <span class="op">=</span> <span class="st">"pvalue"</span>,
  term_metric <span class="op">=</span> <span class="st">"RichFactor"</span>,
  up_color <span class="op">=</span> <span class="st">"#a32a31"</span>,
  down_color <span class="op">=</span> <span class="st">"#f7dcca"</span>
<span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:lolliplot"></span>
<img src="genekitr_files/figure-html/lolliplot-1.png" alt="Lollipop plot of enrichment analysis. defult (A), selected genes (B)" width="98%"><p class="caption">
Figure 11.6: <strong>Lollipop plot of enrichment analysis.</strong> defult (A), selected genes (B)
</p>
</div>
</div>
<div id="gokegg-heatmap-plot" class="section level2">
<h2>
<span class="header-section-number">11.6</span> GO/KEGG: Heatmap Plot<a class="anchor" aria-label="anchor" href="#gokegg-heatmap-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Heatmap plot shows interactions between enriched terms and their genes.
If fold change is given, heatmap will add color for up and down-regulated genes.</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"geneheat"</span><span class="op">)</span>
<span class="va">show_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA2"</span>, <span class="st">"CDK1"</span>, <span class="st">"JUN"</span>, <span class="st">"MCM8"</span>, <span class="st">"TIPIN"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"geneheat"</span>, show_gene <span class="op">=</span> <span class="va">show_gene</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"geneheat"</span>, show_gene <span class="op">=</span> <span class="va">show_gene</span>, fold_change <span class="op">=</span> <span class="va">logfc</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:heatmap"></span>
<img src="genekitr_files/figure-html/heatmap-1.png" alt="Heatmap plot of enrichment analysis. all genes (A, default), selected genes (B), selected genes with logFC value (C)." width="98%"><p class="caption">
Figure 11.7: <strong>Heatmap plot of enrichment analysis.</strong> all genes (A, default), selected genes (B), selected genes with logFC value (C).
</p>
</div>
</div>
<div id="gokegg-chord-plot" class="section level2">
<h2>
<span class="header-section-number">11.7</span> GO/KEGG: Chord Plot<a class="anchor" aria-label="anchor" href="#gokegg-chord-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <a href="https://wencke.github.io/">GOplot</a>, chord plot is reproduced using <a href="https://CRAN.R-project.org/package=ggplot2">ggplot2</a> and it shows similar content with heatmap plot.</p>
<ul>
<li>
<code>gene_space</code>: The space between the gene labels and the chord.</li>
</ul>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">show_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BRCA2"</span>, <span class="st">"CDK1"</span>, <span class="st">"JUN"</span>, <span class="st">"MCM8"</span>, <span class="st">"TIPIN"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"genechord"</span>, 
                 show_gene <span class="op">=</span> <span class="va">show_gene</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"genechord"</span>, 
                 show_gene <span class="op">=</span> <span class="va">show_gene</span>, 
                 fold_change <span class="op">=</span> <span class="va">logfc</span>,
                 gene_space <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:chord"></span>
<img src="genekitr_files/figure-html/chord-1.png" alt="Heatmap plot of enrichment analysis. selected genes (A), selected genes with logFC value (B)." width="98%"><p class="caption">
Figure 11.8: <strong>Heatmap plot of enrichment analysis.</strong> selected genes (A), selected genes with logFC value (B).
</p>
</div>
</div>
<div id="gokegg-wordcloud-plot" class="section level2">
<h2>
<span class="header-section-number">11.8</span> GO/KEGG: Wordcloud Plot<a class="anchor" aria-label="anchor" href="#gokegg-wordcloud-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Wordcloud plot shows term emphasis based on text frequency.</p>


<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"wordcloud"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:wordcloud"></span>
<img src="genekitr_files/figure-html/wordcloud-1.png" alt="Wordcloud plot of enrichment analysis." width="98%"><p class="caption">
Figure 11.9: <strong>Wordcloud plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="gokegg-upset-plot" class="section level2">
<h2>
<span class="header-section-number">11.9</span> GO/KEGG: Upset Plot<a class="anchor" aria-label="anchor" href="#gokegg-upset-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <a href="https://CRAN.R-project.org/package=ComplexUpset">ComplexUpset</a>, the upset plot shows the association between genes and enriched terms. Unlike common Venn diagram, it could emphasize complex relationship among many gene sets.</p>


<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"upset"</span>,main_text_size <span class="op">=</span> <span class="fl">15</span>,legend_text_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:upset"></span>
<img src="genekitr_files/figure-html/upset-1.png" alt="Upset plot of enrichment analysis." width="98%"><p class="caption">
Figure 11.10: <strong>Upset plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="gokegg-network-plot" class="section level2">
<h2>
<span class="header-section-number">11.10</span> GO/KEGG: Network Plot<a class="anchor" aria-label="anchor" href="#gokegg-network-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <code><a href="https://rdrr.io/pkg/enrichplot/man/emapplot.html">enrichplot::emapplot</a></code>, <code>genekitr</code> reproduced this plot to enhance modification.
Enriched terms are the nodes in the network, the overlapping gene sets are edges. Terms with more overlapped genes are tend to cluster together and the edge will be thicker.</p>
<ul>
<li>GO analysis result could use five methods to calculate the similarity between nodes: ‚ÄúResnik‚Äù, ‚ÄúLin‚Äù, ‚ÄúRel‚Äù, ‚ÄúJiang‚Äù, ‚ÄúWang‚Äù and ‚ÄúJC‚Äù(Jaccard‚Äôs similarity index) methods.</li>
<li>KEGG only supports ‚ÄúJC‚Äù method.</li>
</ul>
<p>User could define <code>layout</code> argument derived from <a href="https://CRAN.R-project.org/package=ggraph">ggraph</a>, including ‚Äúnicely‚Äù (default), ‚Äúcircle‚Äù, ‚Äúdh‚Äù, ‚Äúdrl‚Äù, ‚Äúfr‚Äù, ‚Äúgraphopt‚Äù, ‚Äúgrid‚Äù,‚Äúlgl‚Äù, ‚Äúkk‚Äù, ‚Äúmds‚Äù, ‚Äúrandomly‚Äù, ‚Äústar‚Äù etc.</p>
<blockquote>
<p>For more information about the <code>layout</code>, you could refer to: <a href="https://www.data-imaginist.com/2017/ggraph-introduction-layouts/">‚ÄúIntroduction to ggraph: Layouts‚Äù</a></p>
</blockquote>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"network"</span>, scale_ratio <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"network"</span>, 
                 layout <span class="op">=</span> <span class="st">"circle"</span>, scale_ratio <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"network"</span>, 
                 layout <span class="op">=</span> <span class="st">"grid"</span>, sim_method <span class="op">=</span> <span class="st">"Wang"</span>,
                 up_color <span class="op">=</span> <span class="st">"#a32a31"</span>, down_color <span class="op">=</span> <span class="st">"#f7dcca"</span><span class="op">)</span>
<span class="op">(</span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span><span class="op">)</span> <span class="op">/</span> <span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:network"></span>
<img src="genekitr_files/figure-html/network-1.png" alt="Network plot of enrichment analysis. JC method and nicely layout(A, default), circle layout (B), grid layout and Want method (C)." width="98%"><p class="caption">
Figure 11.11: <strong>Network plot of enrichment analysis.</strong> JC method and nicely layout(A, default), circle layout (B), grid layout and Want method (C).
</p>
</div>
</div>
<div id="go-map-plot" class="section level2">
<h2>
<span class="header-section-number">11.11</span> GO: Map Plot<a class="anchor" aria-label="anchor" href="#go-map-plot"><i class="fas fa-link"></i></a>
</h2>
<p>GO terms are built in a directed acyclic graph with a parent-child relationship.
Here the map plot utilized <a href="http://bioconductor.org/packages/GOSemSim">GOSemSim</a> to extract parent and child terms, also utilized <a href="https://CRAN.R-project.org/package=ggraph">ggraph</a> and <a href="https://CRAN.R-project.org/package=igraph">igraph</a> to draw with default layout ‚Äúsugiyama‚Äù.</p>
<p>To avoid too much unrelated terms messed up, <code>genekitr</code> <strong>only shows the closest parent and child with selected terms</strong>. Besides, the top three parent term with more edges will be plotted.</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"gomap"</span>, wrap_length <span class="op">=</span> <span class="fl">25</span>,
           up_color <span class="op">=</span> <span class="st">'#a32a31'</span>,down_color <span class="op">=</span> <span class="st">'#3665a6'</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:map"></span>
<img src="genekitr_files/figure-html/map-1.png" alt="Map plot of enrichment analysis." width="98%"><p class="caption">
Figure 11.12: <strong>Map plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="go-terms-heatmap-plot" class="section level2">
<h2>
<span class="header-section-number">11.12</span> GO: Terms Heatmap Plot<a class="anchor" aria-label="anchor" href="#go-terms-heatmap-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Inspired by <a href="http://bioconductor.org/packages/rrvgo">rrvgo</a>, <code>genekitr</code> scratches main codes to cluster GO terms. Also it could use five methods to calculate the similarity between terms.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"goheat"</span>, sim_method <span class="op">=</span> <span class="st">"Rel"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:goheat"></span>
<img src="genekitr_files/figure-html/goheat-1.png" alt="GO heatmap plot of enrichment analysis." width="98%"><p class="caption">
Figure 11.13: <strong>GO heatmap plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="go-terms-tangram-plot" class="section level2">
<h2>
<span class="header-section-number">11.13</span> GO: Terms Tangram Plot<a class="anchor" aria-label="anchor" href="#go-terms-tangram-plot"><i class="fas fa-link"></i></a>
</h2>
<p>According to <a href="http://bioconductor.org/packages/release/bioc/vignettes/rrvgo/inst/doc/rrvgo.html">rrvgo vignettes</a>, tangram plot is space-filling visualization of hierarchical structures. The terms are grouped and colored based on their parent, and the space used by the term is proportional to the score.</p>


<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"gotangram"</span>, sim_method <span class="op">=</span> <span class="st">"Rel"</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:gotangram"></span>
<img src="genekitr_files/figure-html/gotangram-1.png" alt="GO tangram plot of enrichment analysis." width="98%"><p class="caption">
Figure 11.14: <strong>GO tangram plot of enrichment analysis.</strong>
</p>
</div>
</div>
<div id="plot-theme" class="section level2">
<h2>
<span class="header-section-number">11.14</span> Plot Theme<a class="anchor" aria-label="anchor" href="#plot-theme"><i class="fas fa-link"></i></a>
</h2>
<p><code>Genekitr</code> provides a function <code><a href="https://rdrr.io/pkg/genekitr/man/plot_theme.html">plot_theme()</a></code> to modify all plots theme including text size, border, legend, color, etc.</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>, plot_type <span class="op">=</span> <span class="st">"dot"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  main_text_size <span class="op">=</span> <span class="fl">10</span>,
  legend_text_size <span class="op">=</span> <span class="fl">10</span>
<span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  border_thick <span class="op">=</span> <span class="fl">3</span>,
  remove_grid <span class="op">=</span> <span class="cn">F</span>
<span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">ego</span>,
  plot_type <span class="op">=</span> <span class="st">"dot"</span>,
  remove_main_text <span class="op">=</span> <span class="cn">T</span>,
  remove_legend_text <span class="op">=</span> <span class="cn">T</span>,
  remove_legend <span class="op">=</span> <span class="cn">T</span>
<span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="va">p3</span> <span class="op">+</span> <span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:theme"></span>
<img src="genekitr_files/figure-html/theme-1.png" alt="Plot theme. default theme (A), modify text size (B), modify grid line and border size (C) and remove all text and legend (D)." width="98%"><p class="caption">
Figure 11.15: <strong>Plot theme.</strong> default theme (A), modify text size (B), modify grid line and border size (C) and remove all text and legend (D).
</p>
</div>
</div>
<div id="advanced-plot" class="section level2">
<h2>
<span class="header-section-number">11.15</span> Advanced Plot<a class="anchor" aria-label="anchor" href="#advanced-plot"><i class="fas fa-link"></i></a>
</h2>
<div id="two-group-barplot-for-updown-regulated-pathways" class="section level3">
<h3>
<span class="header-section-number">11.15.1</span> Two-group barplot for up/down regulated pathways<a class="anchor" aria-label="anchor" href="#two-group-barplot-for-updown-regulated-pathways"><i class="fas fa-link"></i></a>
</h3>
<p>If user does <code>genGO</code> or <code>genKEGG</code> for up and down regulated genes separately and wants to visualize them together, the two-group barplot is well suited. Here we take GO result as an example:</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Since the geneList is logFC decreasing ordered, we could take first 100 as up-regulated genes and vice versa.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package <span class="op">=</span> <span class="st">"genekitr"</span><span class="op">)</span>
<span class="va">up_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">down_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span>, <span class="fl">100</span><span class="op">)</span>

<span class="va">up_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">up_genes</span>,
               org <span class="op">=</span> <span class="st">"human"</span>, 
               ont <span class="op">=</span> <span class="st">"bp"</span>, 
               pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,
               qvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>
<span class="op">)</span>

<span class="va">down_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/genGO.html">genGO</a></span><span class="op">(</span><span class="va">down_genes</span>,
                 org <span class="op">=</span> <span class="st">"human"</span>, 
                 ont <span class="op">=</span> <span class="st">"bp"</span>, 
                 pvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>,
                 qvalueCutoff <span class="op">=</span> <span class="fl">0.01</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">up_go</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 62 12</code></pre>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">down_go</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 114  12</code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># seems that up/down-regulated pathways are too many, here we only take 10 of them</span>
<span class="va">up_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">up_go</span>, <span class="fl">10</span><span class="op">)</span>
<span class="va">down_go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">down_go</span>, <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>There are two visulization types:</p>
<ul>
<li>
<code>plot_type = "one"</code>: both up and down-regulated pathways are plotted together</li>
<li>
<code>plot_type = "two"</code>: up and down-regulated pathways are plotted separately. <strong>Recommended if the number of both groups is similar.</strong>
</li>
</ul>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrichAdv.html">plotEnrichAdv</a></span><span class="op">(</span><span class="va">up_go</span>, <span class="va">down_go</span>,
              plot_type <span class="op">=</span> <span class="st">"one"</span>,
              term_metric <span class="op">=</span> <span class="st">"FoldEnrich"</span>,
              stats_metric <span class="op">=</span> <span class="st">"p.adjust"</span>,
              xlim_left <span class="op">=</span> <span class="fl">25</span>, xlim_right <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:twogroup1"></span>
<img src="genekitr_files/figure-html/twogroup1-1.png" alt="Visualize two groups together when plot_type = " one width="98%"><p class="caption">
Figure 11.16: <strong>Visualize two groups together when <code>plot_type = "one"</code>.</strong>
</p>
</div>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrichAdv.html">plotEnrichAdv</a></span><span class="op">(</span><span class="va">up_go</span>, <span class="va">down_go</span>,
              plot_type <span class="op">=</span> <span class="st">"two"</span>,
              term_metric <span class="op">=</span> <span class="st">"FoldEnrich"</span>,
              stats_metric <span class="op">=</span> <span class="st">"qvalue"</span>
<span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:twogroup2"></span>
<img src="genekitr_files/figure-html/twogroup2-1.png" alt="Visualize two groups seperately when plot_type = " two width="98%"><p class="caption">
Figure 11.17: <strong>Visualize two groups seperately when <code>plot_type = "two"</code>.</strong>
</p>
</div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="import-external-data.html"><span class="header-section-number">10</span> Import External Data</a></div>
<div class="next"><a href="plot-gsea-1.html"><span class="header-section-number">12</span> Plot GSEA</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot-go-kegg-1"><span class="header-section-number">11</span> Plot GO and KEGG</a></li>
<li><a class="nav-link" href="#gokegg-bar-plot"><span class="header-section-number">11.1</span> GO/KEGG: Bar Plot</a></li>
<li><a class="nav-link" href="#gokegg-bubble-plot"><span class="header-section-number">11.2</span> GO/KEGG: Bubble Plot</a></li>
<li><a class="nav-link" href="#gokegg-dot-plot"><span class="header-section-number">11.3</span> GO/KEGG: Dot Plot</a></li>
<li><a class="nav-link" href="#go-wego-plot"><span class="header-section-number">11.4</span> GO: WEGO Plot</a></li>
<li><a class="nav-link" href="#gokegg-lollipop-plot"><span class="header-section-number">11.5</span> GO/KEGG: Lollipop Plot</a></li>
<li><a class="nav-link" href="#gokegg-heatmap-plot"><span class="header-section-number">11.6</span> GO/KEGG: Heatmap Plot</a></li>
<li><a class="nav-link" href="#gokegg-chord-plot"><span class="header-section-number">11.7</span> GO/KEGG: Chord Plot</a></li>
<li><a class="nav-link" href="#gokegg-wordcloud-plot"><span class="header-section-number">11.8</span> GO/KEGG: Wordcloud Plot</a></li>
<li><a class="nav-link" href="#gokegg-upset-plot"><span class="header-section-number">11.9</span> GO/KEGG: Upset Plot</a></li>
<li><a class="nav-link" href="#gokegg-network-plot"><span class="header-section-number">11.10</span> GO/KEGG: Network Plot</a></li>
<li><a class="nav-link" href="#go-map-plot"><span class="header-section-number">11.11</span> GO: Map Plot</a></li>
<li><a class="nav-link" href="#go-terms-heatmap-plot"><span class="header-section-number">11.12</span> GO: Terms Heatmap Plot</a></li>
<li><a class="nav-link" href="#go-terms-tangram-plot"><span class="header-section-number">11.13</span> GO: Terms Tangram Plot</a></li>
<li><a class="nav-link" href="#plot-theme"><span class="header-section-number">11.14</span> Plot Theme</a></li>
<li>
<a class="nav-link" href="#advanced-plot"><span class="header-section-number">11.15</span> Advanced Plot</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#two-group-barplot-for-updown-regulated-pathways"><span class="header-section-number">11.15.1</span> Two-group barplot for up/down regulated pathways</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genekitr: Gene Analysis Toolkit based on R</strong>" was written by Yunze Liu. It was last built on 2022-06-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
