[{"path":"index.html","id":"introduction","chapter":"üìñ Introduction","heading":"üìñ Introduction","text":"Welcome use genekitr!book tutorial gene information query, ID conversion, enrichment analysis, publication-level plotting. new R, worry, set enough example codes guide book. reading book, plot figures based analysis result.","code":""},{"path":"index.html","id":"content","chapter":"üìñ Introduction","heading":"üìö Content","text":"Part 1 (Search information) introduces search gene metadata PubMed papers.Part 2 (ID conversion) describes ID conversion among symbol & alias, NCBI Entrez, Ensembl, Uniprot.Part 3 (Enrichment analysis) describes accessible functions enrichment results, including GO, KEGG, GSEA.Part 4 (Plotting) includes 14 GO plots, 7 KEGG plots, 5 GSEA plots, 2 Venn plots, 1 Volcano plot.","code":""},{"path":"index.html","id":"welcome-to-contribute","chapter":"üìñ Introduction","heading":"‚ù§Ô∏è Welcome to contribute","text":"Book source code https://github.com/GangLiLab/book_genekitr.get ideas issues, please feel free post feedback.","code":""},{"path":"search-gene-metadata.html","id":"search-gene-metadata","chapter":"1 Search gene metadata","heading":"1 Search gene metadata","text":"users groups genes check names, location, GC content etc., can use genInfo() function quickly check.","code":""},{"path":"search-gene-metadata.html","id":"geninfo-supported-species","chapter":"1 Search gene metadata","heading":"1.1 Supported organisms","text":"Support 196 vertebrate species, 120 plant species 2 bacteria species. data --date.user select organism name latin_short_name column. common name acceptable popular research species (e.g., human, mouse, rat, fly, zebrafish, worm, chicken). Take human example; official Latin short name ‚Äúhappens,‚Äù hg,\" ‚Äúhsa,‚Äù ‚Äúhs,‚Äù ‚Äúhuman‚Äù also acceptable.","code":"\n# install.packages('DT')\nlibrary(genekitr)\nDT::datatable(ensOrg_name, options = list(pageLength = 10))"},{"path":"search-gene-metadata.html","id":"geninfo-basic-usage","chapter":"1 Search gene metadata","heading":"1.2 Basic usage","text":"three arguments genInfo():id: gene id (symbol, Entrez Ensembl) protein idid: gene id (symbol, Entrez Ensembl) protein idorg: organism name, default humanorg: organism name, default humanunique: TRUE FALSE. Commonly, one gene many types matched records. example, human HBD gene three matched Entrez IDs: 3045, 85349, 100187828. TRUE, return one--one match result minimal NAs.unique: TRUE FALSE. Commonly, one gene many types matched records. example, human HBD gene three matched Entrez IDs: 3045, 85349, 100187828. TRUE, return one--one match result minimal NAs.one--many mapping happens user wants get unique match, ID maximum information return (minimum NAs).","code":"\nid <- \"HBD\"\nuniq_info <- genInfo(id, org = 'hs', unique = TRUE)\nuniq_info[1:4]##   input_id symbol  entrezid         ensembl\n## 1      HBD    HBD 100187828 ENSG00000223609\nall_info <- genInfo(id, org = 'hs', unique = FALSE)\nall_info[1:4]##   input_id symbol  entrezid         ensembl\n## 1      HBD    HBD 100187828 ENSG00000223609\n## 2      HBD KRT87P     85349 ENSG00000135477\ncolnames(all_info)##  [1] \"input_id\"         \"symbol\"           \"entrezid\"         \"ensembl\"          \"uniprot\"         \n##  [6] \"chr\"              \"start\"            \"end\"              \"width\"            \"strand\"          \n## [11] \"gene_name\"        \"ncbi_alias\"       \"ensembl_alias\"    \"gc_content\"       \"gene_biotype\"    \n## [16] \"transcript_count\" \"hgnc_id\"          \"omim\"             \"ccds\"             \"reactome\"        \n## [21] \"ucsc\"             \"mirbase_id\""},{"path":"search-gene-metadata.html","id":"geninfo-features","chapter":"1 Search gene metadata","heading":"1.3 Features","text":"","code":""},{"path":"search-gene-metadata.html","id":"geninfo-feature-1","chapter":"1 Search gene metadata","heading":"1.3.1 Feature1: keep input id order","text":"genInfo result strictly keep input order even unrecognized ids.user gives misspelled gene id id belong organism, result provide columns NA.","code":"\nid <- c(\"MCM10\", \"CDC20\", \"S100A9\", \n        \"FAKEID\", \"TP53\", \"HBD\", \"NUDT10\")\n# for human id, no need to input the org argument\ninfo <- genInfo(id)\nidentical(id, unique(info$input_id))## [1] TRUE\nDT::datatable(info, options = list(pageLength = 10))"},{"path":"search-gene-metadata.html","id":"geninfo-feature-2","chapter":"1 Search gene metadata","heading":"1.3.2 Feature2: recognize both gene symbol and alias","text":"Many common gene names gene alias, many programs accept gene symbols cause gene information lost. example, ‚ÄúBCC7‚Äù alias ‚ÄúTP53‚Äù, ‚ÄúPD1‚Äù three aliases: ‚ÄúPDCD1‚Äù, ‚ÄúSNCA‚Äù ‚ÄúSPATA2‚Äù.","code":"\nid <- c(\"BCC7\",\"PD1\")\ngenInfo(id)[1:4]##   input_id symbol entrezid         ensembl\n## 1     BCC7   TP53     7157 ENSG00000141510\n## 2      PD1  PDCD1     5133 ENSG00000188389\n## 3      PD1  PDCD1     5133 ENSG00000276977\n## 4      PD1   SNCA     6622 ENSG00000145335\n## 5      PD1 SPATA2     9825 ENSG00000158480"},{"path":"search-gene-metadata.html","id":"geninfo-feature-3","chapter":"1 Search gene metadata","heading":"1.3.3 Feature3: count organism gene types","text":", need calculate symbols one--many matched types. course, many genes NA biotypes uncategorized.","code":"\nuniq_symbol <- genInfo(org = 'hs') %>% \n  dplyr::filter(!is.na(gene_biotype)) %>% \n  dplyr::distinct(symbol,.keep_all = T) \n\nuniq_symbol %>%  {table(.$gene_biotype)}## \n##                          IG_C_gene                    IG_C_pseudogene \n##                                 14                                  8 \n##                          IG_D_gene                          IG_J_gene \n##                                 37                                 18 \n##                    IG_J_pseudogene                          IG_V_gene \n##                                  3                                144 \n##                    IG_V_pseudogene                             lncRNA \n##                                185                               6096 \n##                              miRNA                           misc_RNA \n##                               1852                               1034 \n##                            Mt_rRNA                            Mt_tRNA \n##                                  2                                 23 \n##             polymorphic_pseudogene               processed_pseudogene \n##                                 46                               7196 \n##                     protein_coding                           ribozyme \n##                              19578                                  4 \n##                               rRNA                    rRNA_pseudogene \n##                                 46                                496 \n##                             scaRNA                              scRNA \n##                                 18                                  1 \n##                             snoRNA                              snRNA \n##                                437                               1834 \n##                               sRNA                                TEC \n##                                  1                                 28 \n##                          TR_C_gene                          TR_D_gene \n##                                  7                                  4 \n##                          TR_J_gene                    TR_J_pseudogene \n##                                 79                                  4 \n##                          TR_V_gene                    TR_V_pseudogene \n##                                107                                 33 \n##   transcribed_processed_pseudogene     transcribed_unitary_pseudogene \n##                                353                                130 \n## transcribed_unprocessed_pseudogene    translated_processed_pseudogene \n##                                776                                  2 \n##  translated_unprocessed_pseudogene                 unitary_pseudogene \n##                                  2                                 78 \n##             unprocessed_pseudogene \n##                               1703"},{"path":"search-gene-metadata.html","id":"geninfo-feature-4","chapter":"1 Search gene metadata","heading":"1.3.4 Feature4: extract specific biotype genes","text":"want get human protein-coding genes:Compare HGNC data:Check missing gene names result:seems gene ‚ÄúABTB3‚Äù recently modified, GeneCards also shows result.look EntrezID 121551, also known ‚ÄúBTBD11‚Äù matched Ensembl data: ENSG00000151136So reason mismatch --sync extensive database Ensembl NCBI.","code":"\nhg_pro_gene <- uniq_symbol %>% \n  dplyr::filter(gene_biotype == 'protein_coding') %>% \n  dplyr::pull(symbol) \n  \nlength(hg_pro_gene)## [1] 19578\nhgnc_data <- rio::import('http://ftp.ebi.ac.uk/pub/databases/genenames/hgnc/tsv/locus_types/gene_with_protein_product.txt') \nhgnc_symbol <- hgnc_data$symbol\nplotVenn(list(genekitr_symbol = hg_pro_gene,\n              hgnc_symbol = hgnc_symbol))\ncheck_genes <- head(hgnc_symbol[!hgnc_symbol%in%hg_pro_gene],3)\nhgnc_data %>% dplyr::filter(symbol %in% check_genes) %>% \n  dplyr::select(symbol,date_approved_reserved,date_symbol_changed,\n                entrez_id)##   symbol date_approved_reserved date_symbol_changed entrez_id\n## 1  ABTB3             2003-12-15          2022-05-13    121551\n## 2 ADGRF2             2002-11-26          2015-03-03    222611\n## 3  AKR7L             2008-12-09                <NA>    246181\ngenInfo('121551')[1:3]##   input_id         ensembl symbol\n## 1   121551 ENSG00000151136 BTBD11"},{"path":"search-pubmed.html","id":"search-pubmed","chapter":"2 Search PubMed records","heading":"2 Search PubMed records","text":"getPubmed function use europepmc easily get PubMed records searching paper abstract.user needs input term argument; supplement information, keys parameter available.example, want check papers genes ‚ÄúTp53‚Äù, ‚ÄúBrca1,‚Äù ‚ÄúTet2‚Äù mouse stem cells, write codes like :NOTICE:\nminor update made version 0.8.6 . Argument keys replaced add_term easy understanding, num parameter added specify number returned records.","code":"\nterm <- c(\"Tp53\",\"Brca1\",\"Tet2\")\nkeys <- c('stem cell','mouse')\nl <- getPubmed(term,keys)\nnames(l)## [1] \"Tp53\"  \"Brca1\" \"Tet2\"\nDT::datatable(l$Tp53, options = list(pageLength = 10))\nterm <- c(\"Tp53\",\"Brca1\",\"Tet2\")\nadd_term <- c('stem cell','mouse')\nl <- getPubmed(term,add_term,num=30)"},{"path":"gene-id-conversion.html","id":"gene-id-conversion","chapter":"3 Gene ID conversion","heading":"3 Gene ID conversion","text":"popular gene ID types include Symbol, NCBI Entrez Ensembl. ID conversion among different types common.","code":""},{"path":"gene-id-conversion.html","id":"convertion-current-tools","chapter":"3 Gene ID conversion","heading":"3.1 Current tools","text":"Now many tools handle id conversion including biomaRt, clusterProfiler. .biomaRt frequently used access Ensembl database clusterProfiler depends NCBI database via Bioconductor annotation packages.Genekitr combines Ensembl NCBI database provide comprehensive gene id mapping. Also id conversion supports many species (see also session 1.2)","code":""},{"path":"gene-id-conversion.html","id":"transid-basic-usage","chapter":"3 Gene ID conversion","heading":"3.2 Basic usage","text":"transId sub function genInfo, five arguments:id: gene id (symbol, Entrez Ensembl) protein idid: gene id (symbol, Entrez Ensembl) protein idtransTo: conversion target type. User select one ‚Äúsymbol‚Äù, ‚Äúentrez‚Äù, ‚Äúensembl‚Äù ‚Äúuniprot‚ÄùtransTo: conversion target type. User select one ‚Äúsymbol‚Äù, ‚Äúentrez‚Äù, ‚Äúensembl‚Äù ‚Äúuniprot‚Äùorg: organism name, default humanorg: organism name, default humanunique: TRUE FALSE. TRUE, returns one matched id. Default FALSE.unique: TRUE FALSE. TRUE, returns one matched id. Default FALSE.keepNA: TRUE FALSE. id none matched id, save . Default FALSE.keepNA: TRUE FALSE. id none matched id, save . Default FALSE.","code":"\nid <- c('AKT3','SSX6P','FAKE_ID','BCC7')\n\n# Here \"ens\" represents \"ensembl\", if you do not want to type too many characters like me, just spell first several ones\ntransId(id,'ens')##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2     AKT3 ENSG00000117020\n## 3    SSX6P ENSG00000171483\n## 4     BCC7 ENSG00000141510\n# Due to NA was removed, the result order is slightly different from input id. If you want to get the same order, you can save NA:\ntransId(id,'ens',keepNA = TRUE)##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2     AKT3 ENSG00000117020\n## 3    SSX6P ENSG00000171483\n## 4  FAKE_ID            <NA>\n## 5     BCC7 ENSG00000141510\n# If you want to get one-to-one mapping and keep input id order:\ntransId(id,'ens',keepNA = TRUE,unique = TRUE)##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2    SSX6P ENSG00000171483\n## 3  FAKE_ID            <NA>\n## 4     BCC7 ENSG00000141510"},{"path":"gene-id-conversion.html","id":"transid-features","chapter":"3 Gene ID conversion","heading":"3.3 Features","text":"","code":""},{"path":"gene-id-conversion.html","id":"transid-feature-1","chapter":"3 Gene ID conversion","heading":"3.3.1 Feature1: convert to several types","text":"Just pass wanted types transTo parameter:","code":"\ntransId(id, transTo = c('ens','ent'))##   input_id         ensembl entrezid\n## 1     AKT3 ENSG00000275199    10000\n## 2     AKT3 ENSG00000117020    10000\n## 3    SSX6P ENSG00000171483   280657\n## 4     BCC7 ENSG00000141510     7157"},{"path":"gene-id-conversion.html","id":"transid-feature-2","chapter":"3 Gene ID conversion","heading":"3.3.2 Feature2: distinguish from symbol and alias","text":"Gene alias alternative name official gene symbol, like ‚ÄúBCC7‚Äù actually alias ‚ÄúTP53‚Äù. Sometimes gene alias much famous official symbol, example, ‚ÄúPDL1‚Äù alias ‚ÄúCD274‚Äù fact., transId utilize NCBI Ensembl alias metadata easily recognize , user just need set transTo = 'symbol'","code":"\ntransId(c(\"BCC7\",\"TP53\",\"PD1\",\"PDL1\",\"TET2\"),'sym')##   input_id symbol\n## 1     BCC7   TP53\n## 2     TP53   TP53\n## 3      PD1  PDCD1\n## 4      PD1   SNCA\n## 5      PD1 SPATA2\n## 6     PDL1  CD274\n## 7     TET2   TET2"},{"path":"gene-id-conversion.html","id":"transid-feature-3","chapter":"3 Gene ID conversion","heading":"3.3.3 Feature3: no worry for Ensembl version","text":"Ensembl stable ID consists five parts: ENS(species)(object type)(identifier). (version)\nexample, ENSG00000141510.11 TP53 version .11 may confuse many tools.\nHowever using transId, user worry issue .","code":"\ntransId('ENSG00000141510.11','symbol')##          input_id symbol\n## 1 ENSG00000141510   TP53"},{"path":"gene-id-conversion.html","id":"transid-real-exp","chapter":"3 Gene ID conversion","heading":"3.4 Real Example","text":"","code":""},{"path":"gene-id-conversion.html","id":"transid-real-exp-data","chapter":"3 Gene ID conversion","heading":"3.4.1 Example data","text":"got differential expression analysis result GSE42872.take gene symbols result compare id conversion efficiency various tools.","code":"\ndata(deg,package = 'genekitr')\nid = deg$ENTREZID\nlength(id)## [1] 18591"},{"path":"gene-id-conversion.html","id":"transid-real-exp-bitr","chapter":"3 Gene ID conversion","heading":"3.4.2 bitr from clusterProfiler","text":"","code":"\n### Using bitr\nsuppressWarnings(library(org.Hs.eg.db))\nsuppressMessages(library(clusterProfiler))\nbitr_res = bitr(id,fromType = 'ENTREZID',toType = 'SYMBOL',OrgDb = 'org.Hs.eg.db')\nbitr_sym = unique(bitr_res$SYMBOL)\nlength(bitr_sym)## [1] 18579"},{"path":"gene-id-conversion.html","id":"transid-real-exp-transid","chapter":"3 Gene ID conversion","heading":"3.4.3 transId from genekitr","text":"","code":"\ntransid_res = transId(id,'sym')\ntransid_sym = unique(transid_res$symbol)\nlength(transid_sym)## [1] 18600"},{"path":"gene-id-conversion.html","id":"transid-real-exp-compare","chapter":"3 Gene ID conversion","heading":"3.4.4 compare results","text":"114 genes bitr result:search NCBI 159091 see official symbol ‚ÄúPABIR3‚Äù now ‚ÄúFAM122C‚Äù alias. look back transId result, keeps update NCBI web.Besides, 140 unique symbols transId result:NCBI web also showed result transId: 100287896, bitr gets LOC100287896 symbol .total 18591 entrez id input, get 18578 ids transId result, ?search NCBI web, found reason, replaced new one. example, first one 23285 discontinued 9-Nov-2019 replaced 284697.","code":"\nplotVenn(list(bitr_sym=bitr_sym,transid_sym=transid_sym))\nbitr_sym[!bitr_sym%in%transid_sym] %>% head()## [1] \"FAM122C\"      \"LOC100287896\" \"TMEM159\"      \"C8orf31\"      \"RRNAD1\"       \"CCDC58\"\n# let's take a look for the first one FAM122C, which is converted from gene 159091\nbitr_res %>% filter(SYMBOL%in%'FAM122C') %>% pull(ENTREZID)## [1] \"159091\"\ntransid_res %>% filter(input_id%in%'159091') %>% pull(symbol)## [1] \"PABIR3\"\ntransid_sym[!transid_sym%in%bitr_sym] %>% head()## [1] \"PABIR3\"    \"LIPT2-AS1\" \"LDAF1\"     \"LINC02904\" \"METTL25B\"  \"MIX23\"\n# take a look at the second one: LIPT2-AS1\ntransid_res %>% filter(symbol == \"LIPT2-AS1\") %>% pull(input_id)## [1] \"100287896\"\ntransid_id <- unique(transid_res$input_id)\nlength(transid_id)## [1] 18578\nid[!id%in%transid_id]##  [1] \"23285\"     \"283174\"    \"105377021\" \"102724237\" \"101928841\" \"643763\"    \"54748\"     \"338809\"   \n##  [9] \"387638\"    \"246734\"    \"84953\"     \"105374089\" \"10896\"\n# As we get the latest id, we could convert it immediately!\ntransId('284697','sym')##   input_id symbol\n## 1   284697  BTBD8"},{"path":"protein-id-conversion.html","id":"protein-id-conversion","chapter":"4 Protein ID conversion","heading":"4 Protein ID conversion","text":"","code":""}]
