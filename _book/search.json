[{"path":"index.html","id":"welcome-to-genekitr","chapter":"🧬 Welcome to genekitr!","heading":"🧬 Welcome to genekitr!","text":"\nbook tutorial gene information query, gene/protein/probe identifier conversion, gene enrichment analysis, publication-level plotting.new R, worry, book set enough example codes help . reading book, plot figures based data.","code":""},{"path":"index.html","id":"content","chapter":"🧬 Welcome to genekitr!","heading":"🍱 Content","text":"Part 1 (Search Information) introduces search gene metadata PubMed papers.Part 2 (ID Conversion) describes ID conversion among symbol & alias, NCBI Entrez, Ensembl, Uniprot microarray probe.Part 3 (Enrichment Analysis) describes gene sets two widely used functional enrichment methods: -representation analysis (ORA) functional class scoring (FCS).Part 4 (Plotting) includes 13 ORA plots, 5 FCS-GSEA plots, 2 Venn plots, 1 Volcano plot.","code":""},{"path":"index.html","id":"welcome-to-contribute","chapter":"🧬 Welcome to genekitr!","heading":"💝 Welcome to contribute","text":"Book source code https://github.com/GangLiLab/book_genekitr.get ideas issues, please feel free post feedback.","code":""},{"path":"quick-start.html","id":"quick-start","chapter":"1 Quick start","heading":"1 Quick start","text":"part helps users quickly go function usage. Click title view details.","code":""},{"path":"quick-start.html","id":"search-gene-metadata","chapter":"1 Quick start","heading":"1.1 Search gene metadata","text":"","code":"\nid <- c(\"MCM10\", \"CDC20\", \"S100A9\", \"MMP1\", \"BCC7\",\"FAKEID\",\"HBD\", \"NUDT10\")\ninfo <- genInfo(id, org = \"hs\")\n# keep unique records\ninfo2 <- genInfo(id, org = \"hs\", unique = TRUE)"},{"path":"quick-start.html","id":"search-pubmed-records","chapter":"1 Quick start","heading":"1.2 Search PubMed records","text":"","code":"\n## check package version\npackageVersion(\"genekitr\")\n\n## for version < 0.8.6\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nkeys <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, keys)\n\n## for version > 0.8.6\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nadd_term <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, add_term, num = 30)\n\n# set \"num\" larger to get all records\nall <- getPubmed(term, add_term, num = 666666)"},{"path":"quick-start.html","id":"gene-id-conversion","chapter":"1 Quick start","heading":"1.3 Gene ID conversion","text":"","code":"\nid <-  c(\"Cyp2c23\", \"Fhit\", \"Gal3st2b\", \"Trp53\", \"Tp53\")\nsym2ens <- transId(id ,transTo = \"ensembl\", org = \"mouse\")\n# keep unique records\nsym2ensent <- transId(id ,transTo = c(\"ensembl\",\"entrez\"), org = \"mouse\", unique = TRUE)"},{"path":"quick-start.html","id":"protein-id-conversion","chapter":"1 Quick start","heading":"1.4 Protein ID conversion","text":"","code":"\nid <-  c(\"P27364\", \"P14046\", \"P15650\", \"P16638\", \"P24483\")\nprotein2sym <- transId(id ,transTo = \"sym\", org = \"rat\")"},{"path":"quick-start.html","id":"probe-id-conversion","chapter":"1 Quick start","heading":"1.5 Probe ID conversion","text":"faciliate gene enrichment analysis, developed geneset","code":"\nid <-  c('205647_at','204857_at','201394_s_at','210377_at')\nprobe2sym <- transProbe(id, transTo = 'sym',org = 'hs')"},{"path":"quick-start.html","id":"get-gene-sets","chapter":"1 Quick start","heading":"1.6 Get gene sets","text":"","code":"\n# install.packages(\"geneset\")\nlibrary(geneset)\ngs <- getGO(org = \"human\",ont = \"mf\")\ngs <- getKEGG(org = \"hsa\",category = \"pathway\")\ngs <- getMesh(org = \"human\", method = \"gendoo\", category = \"A\")\ngs <- getMsigdb(org = \"human\", category = \"H\")\ngs <- getWiki(org = \"human\")\ngs <- getReactome(org = \"human\")\ngs <- getEnrichrdb(org = \"human\", library = \"COVID-19_Related_Gene_Sets\")\ngs <- getHgDisease(source = \"do\")"},{"path":"quick-start.html","id":"ora-analysis-over-representation-analysis","chapter":"1 Quick start","heading":"1.7 ORA analysis (over-representation analysis)","text":"","code":"\n# 1st step: get input IDs\nid <- c(\"TP53\",\"BRCA1\", \"PD1\", \"PDL1\")\n# 2nd step: get gene set\ngs <- geneset::getGO(org = \"human\",ont = \"mf\")\n# 3rd: analysis\nego <- genORA(id,\n              geneset = gs,\n              p_cutoff = 0.05,\n              q_cutoff = 0.05\n)"},{"path":"quick-start.html","id":"fcs-gsea-analysis","chapter":"1 Quick start","heading":"1.8 FCS GSEA analysis","text":"FCS stands “functional-class-scoring”.geneList order ranked gene list decreasing order. Input IDs can Entrez, Ensembl, symbol UniProt IDs.","code":"\n# 1st step: get pre-ranked gene list\ndata(geneList, package = \"genekitr\")\n# 2nd step: get gene set\ngs <- geneset::getGO(org = \"human\",ont = \"mf\")\n# 3rd: analysis\ngse <- genGSEA(genelist = geneList, \n               geneset = gs,\n               p_cutoff = 0.05,\n               q_cutoff = 0.05)"},{"path":"quick-start.html","id":"import-external-data","chapter":"1 Quick start","heading":"1.9 Import external data","text":"","code":""},{"path":"quick-start.html","id":"import-panther-of-geneontology-website","chapter":"1 Quick start","heading":"1.9.1 Import Panther of GeneOntology website","text":"","code":"\n# here we save panther result as \"analysis.txt\"\npanther_res <- importPanther(\"analysis.txt\")"},{"path":"quick-start.html","id":"import-clusterprofiler-result","chapter":"1 Quick start","heading":"1.9.2 Import clusterProfiler result","text":"","code":"\nlibrary(clusterProfiler)\nlibrary(org.Hs.eg.db)\ndata(geneList, package=\"DOSE\")\ngene <- names(geneList)[abs(geneList) > 2]\n\n## GO result from clusterProfiler\ngo <- enrichGO(gene          = gene,\n                OrgDb         = org.Hs.eg.db,\n                ont           = \"BP\",\n                pAdjustMethod = \"BH\",\n                pvalueCutoff  = 0.01,\n                qvalueCutoff  = 0.05)\n## GSEA result from clusterProfiler\nkk <- gseKEGG(geneList     = geneList,\n               organism     = 'hsa',\n               minGSSize    = 120,\n               pvalueCutoff = 0.05,\n               verbose      = FALSE)\n## Other ORA result from clusterProfiler \n# (e.g. KEGG/DOSE/WikiPathways...)\ndo <- enrichDO(gene          = gene,\n              ont           = \"DO\",\n              pvalueCutoff  = 0.05,\n              pAdjustMethod = \"BH\",\n              universe      = names(geneList),\n              minGSSize     = 5,\n              maxGSSize     = 500,\n              qvalueCutoff  = 0.05)\n\n## Import \ngo_easy <- importCP(go, type = \"go\")\nkk_easy <- importCP(kk,type = 'gsea')\ndo_easy <- importCP(do,type = 'other')"},{"path":"quick-start.html","id":"plot-ora","chapter":"1 Quick start","heading":"1.10 Plot ORA","text":"Supported types include: bar, wego, bubble, dot, lollipop, geneheat, genechord,\nnetwork, gomap, goheat, gotangram, wordcloud, upset two-group barplot","code":"\nplotEnrich(ego, plot_type = \"dot\")\nplotEnrich(keg, plot_type = \"bar\")\nplotEnrich(ego, plot_type = \"geneheat\")\nplotEnrich(ego, plot_type = \"network\", scale_ratio = 0.5)"},{"path":"quick-start.html","id":"plot-gsea","chapter":"1 Quick start","heading":"1.11 Plot GSEA","text":"Supported types include: volcano, classic, fgsea, ridge bar","code":"\nplotGSEA(gse, plot_type = \"volcano\", show_pathway = 3)\n\ngenes <- c(\"MET\", \"TP53\", \"PMM2\")\nplotGSEA(gse, plot_type = \"classic\", show_pathway = pathways, show_gene = genes)\n\nplotGSEA(gse, plot_type = \"fgsea\", show_pathway = 3)"},{"path":"quick-start.html","id":"plot-venn","chapter":"1 Quick start","heading":"1.12 Plot Venn","text":"","code":"\nset1 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset2 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset3 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\n\n# classic venn plot\nplotVenn(list(gset1 = set1, gset2 = set2, gset3 = set3), use_venn = TRUE)\n# UpSet plot\nplotVenn(list(gset1 = set1, gset2 = set2, gset3 = set3), use_venn = FALSE)"},{"path":"quick-start.html","id":"plot-deg-volcano","chapter":"1 Quick start","heading":"1.13 Plot DEG Volcano","text":"","code":"\ndata(deg, package = \"genekitr\")\nplotVolcano(deg, \"p.adjust\",\n  remove_legend = T,\n  show_gene = c(\"CD36\", \"DUSP6\", \"IER3\", \"CDH7\")\n)"},{"path":"search-gene-metadata-1.html","id":"search-gene-metadata-1","chapter":"2 Search gene metadata","heading":"2 Search gene metadata","text":"genInfo() function helps user quickly search batch gene metadata names, location, GC content, etc.","code":""},{"path":"search-gene-metadata-1.html","id":"geninfo-supported-species","chapter":"2 Search gene metadata","heading":"2.1 Supported organisms","text":"supports 195 vertebrate species, 120 plant species, two bacteria species. data --date.user select organism name latin_short_name column.common name also acceptable popular research species (e.g., human, mouse, rat, fly, zebrafish, worm, chicken). Take human example, official latin short name “hsapiens”, \" hg“,”hsa“,”hs“, ”human\" also acceptable.","code":"\n# install.packages('DT')\nlibrary(genekitr)\nDT::datatable(ensOrg_name, options = list(pageLength = 10))"},{"path":"search-gene-metadata-1.html","id":"geninfo-basic-usage","chapter":"2 Search gene metadata","heading":"2.2 Basic usage","text":"genInfo three arguments:id: gene id (symbol, Entrez Ensembl) protein idid: gene id (symbol, Entrez Ensembl) protein idorg: organism name, default humanorg: organism name, default humanunique: TRUE FALSE. Commonly, one gene many types matched records. example, human HBD gene three matched Entrez IDs: 3045, 85349, 100187828. TRUE, return one--one match result smallest entrezid maximal information (minimal NAs). See example genekitr feature2.unique: TRUE FALSE. Commonly, one gene many types matched records. example, human HBD gene three matched Entrez IDs: 3045, 85349, 100187828. TRUE, return one--one match result smallest entrezid maximal information (minimal NAs). See example genekitr feature2.","code":"\nid <- c(\"TP53\", \"BRCA1\", \"TET2\")\ninfo <- genInfo(id)\ncolnames(info)##  [1] \"input_id\"         \"symbol\"           \"entrezid\"         \"ensembl\"         \n##  [5] \"uniprot\"          \"chr\"              \"start\"            \"end\"             \n##  [9] \"width\"            \"strand\"           \"gene_name\"        \"ncbi_alias\"      \n## [13] \"ensembl_alias\"    \"gc_content\"       \"gene_biotype\"     \"transcript_count\"\n## [17] \"hgnc_id\"          \"omim\"             \"ccds\"             \"reactome\"        \n## [21] \"ucsc\"             \"mirbase_id\"       \"cell_marker\"\nhead(info, 3)##   input_id symbol entrezid         ensembl\n## 1     TP53   TP53     7157 ENSG00000141510\n## 2    BRCA1  BRCA1      672 ENSG00000012048\n## 3     TET2   TET2    54790 ENSG00000168769\n##                                                              uniprot chr\n## 1 K7PPA8; P04637; Q53GA5; H2EHT1; A0A087X1Q1; A0A087WXZ1; A0A087WT22  17\n## 2                                                 P38398; A0A024R1V0  17\n## 3                                     A0A158SIU0; Q6N021; A0A024RDF7   4\n##       start       end  width strand                        gene_name\n## 1   7661779   7687538  25760     -1                tumor protein p53\n## 2  43044295  43170245 125951     -1      BRCA1 DNA repair associated\n## 3 105145875 105279816 133942      1 tet methylcytosine dioxygenase 2\n##                                                        ncbi_alias\n## 1                                   BCC7; BMFS5; LFS1; P53; TRP53\n## 2 BRCAI; BRCC1; BROVCA1; FANCS; IRIS; PNCA4; PPP1R53; PSCP; RNF53\n## 3                                            IMD75; KIAA1546; MDS\n##                  ensembl_alias gc_content   gene_biotype transcript_count\n## 1                    LFS1; p53      48.85 protein_coding               27\n## 2 BRCC1; FANCS; PPP1R53; RNF53      44.09 protein_coding               34\n## 3           FLJ20032; KIAA1546      36.29 protein_coding                9\n##      hgnc_id   omim\n## 1 HGNC:11998 191170\n## 2  HGNC:1100 113705\n## 3 HGNC:25941 612839\n##                                                                                                                                 ccds\n## 1 CCDS73967; CCDS73966; CCDS73968; CCDS73964; CCDS73965; CCDS73963; CCDS73969; CCDS45606; CCDS45605; CCDS73970; CCDS73971; CCDS11118\n## 2                                                                              CCDS11453; CCDS11456; CCDS11455; CCDS11459; CCDS11454\n## 3                                                                                                              CCDS3666; ; CCDS47120\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                reactome\n## 1 R-HSA-1643685; R-HSA-392499; R-HSA-597592; R-HSA-109582; R-HSA-168256; R-HSA-212436; R-HSA-2262752; R-HSA-73857; R-HSA-74160; R-HSA-8953897; R-HSA-162582; R-HSA-5688426; R-HSA-5689880; R-HSA-2990846; R-HSA-3108232; R-HSA-5693532; R-HSA-73894; R-HSA-109581; R-HSA-109606; R-HSA-114452; R-HSA-1257604; R-HSA-5357801; R-HSA-9006925; R-HSA-1640170; R-HSA-69278; R-HSA-69620; R-HSA-3700989; R-HSA-5633008; R-HSA-6803207; R-HSA-5218859; R-HSA-157118; R-HSA-6807070; R-HSA-8943724; R-HSA-983231; R-HSA-2559583; R-HSA-8853884; R-HSA-6796648; R-HSA-453274; R-HSA-69275; R-HSA-1912408; R-HSA-1912422; R-HSA-6803204; R-HSA-8878159; R-HSA-390466; R-HSA-390471; R-HSA-391251; R-HSA-1280215; R-HSA-449147; R-HSA-69481; R-HSA-6785807; R-HSA-2559580; R-HSA-2559585; R-HSA-349425; R-HSA-69541; R-HSA-69563; R-HSA-69580; R-HSA-69615; R-HSA-8852276; R-HSA-3232118; R-HSA-5693565; R-HSA-5693606; R-HSA-5633007; R-HSA-6804756; R-HSA-69473; R-HSA-9645723; R-HSA-5689896; R-HSA-8941855; R-HSA-2559586; R-HSA-5628897; R-HSA-6804757; R-HSA-6804759; R-HSA-6806003; R-HSA-6803211; R-HSA-5620971; R-HSA-6804754; R-HSA-6804758; R-HSA-139915; R-HSA-6803205; R-HSA-6791312; R-HSA-6804115; R-HSA-6804114; R-HSA-6804116; R-HSA-69560; R-HSA-69895; R-HSA-2559584; R-HSA-6804760; R-HSA-6811555; R-HSA-111448; R-HSA-9723905; R-HSA-9723907\n## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      R-HSA-1643685; R-HSA-392499; R-HSA-597592; R-HSA-212436; R-HSA-73857; R-HSA-74160; R-HSA-5688426; R-HSA-2990846; R-HSA-3108214; R-HSA-3108232; R-HSA-5685938; R-HSA-5693532; R-HSA-5693538; R-HSA-5693567; R-HSA-73894; R-HSA-1640170; R-HSA-69620; R-HSA-3700989; R-HSA-6796648; R-HSA-69481; R-HSA-5693565; R-HSA-5693606; R-HSA-1474165; R-HSA-1221632; R-HSA-1500620; R-HSA-5633007; R-HSA-5685942; R-HSA-5689901; R-HSA-5693537; R-HSA-5693554; R-HSA-5693568; R-HSA-5693571; R-HSA-5693579; R-HSA-5693607; R-HSA-5693616; R-HSA-6804756; R-HSA-69473; R-HSA-8953750; R-HSA-912446; R-HSA-9663199; R-HSA-9675135; R-HSA-9675136; R-HSA-9699150; R-HSA-9701193; R-HSA-9704331; R-HSA-9704646\n## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              R-HSA-74160; R-HSA-212165; R-HSA-5221030\n##                                                                                                                                                                                                                                                                                                                                                                                                                     ucsc\n## 1                                                                                     uc002gig.2; uc284ohw.1; uc002gih.5; uc060auo.1; uc060aup.1; uc060auq.1; uc010cnf.2; uc010cng.2; uc002gii.2; uc031qyq.2; uc002gij.4; uc060aus.1; uc060aut.1; uc010cnh.4; uc060auu.1; uc060auv.1; uc060aur.2; uc002gim.5; uc060auw.1; uc060auy.1; uc060auz.1; uc010cnj.2; uc060ava.1; uc060avb.1; uc060avc.1; uc060avd.1; uc032esw.2\n## 2 uc060fri.1; uc002icq.6; uc002ict.5; uc002icu.4; uc285oaj.1; uc010whm.3; uc010whn.3; uc060frj.1; uc010cyx.4; uc060frk.1; uc060frl.1; uc060frm.1; uc060frn.1; uc060fro.1; uc060frp.1; uc060frq.1; uc060frr.1; uc060frs.1; uc002idd.5; uc284oig.1; uc060frt.1; uc060fru.1; uc287jed.1; uc060frv.1; uc060frw.1; uc060frx.1; uc060fry.1; uc060frz.1; uc285oak.1; uc060fsa.1; uc060fsb.1; uc060fsc.1; uc285oal.1; uc060fsd.1\n## 3                                                                                                                                                                                                                                                                                                             uc021xqk.1; uc011cez.3; uc062ysb.1; uc003hxj.3; uc003hxk.5; uc062ysc.1; uc010ilp.3; uc062yse.1; uc062ysf.1\n##   mirbase_id\n## 1       <NA>\n## 2       <NA>\n## 3       <NA>\n##                                                                                                                                                                                                                                                                          cell_marker\n## 1                               Fetal gonad|T|Mitotic fetal germ cell; Fetal gonad|T|Gonadal endothelial cell; Fetal kidney|T|Natural killer T (NKT) cell; Fetal gonad|N|Mitotic fetal germ cell; Fetal gonad|N|Gonadal endothelial cell; Fetal kidney|N|Natural killer T (NKT) cell\n## 2                                                                                                                                                                                             Fetal kidney|T|Natural killer T (NKT) cell; Fetal kidney|N|Natural killer T (NKT) cell\n## 3 Embryo|T|Trophectoderm cell; Liver|T|Exhausted CD8+ T cell; Liver|T|Regulatory T (Treg) cell; Fetal kidney|T|Natural killer T (NKT) cell; Embryo|N|Trophectoderm cell; Liver|T|Exhausted CD8+ T cell; Liver|T|Regulatory T (Treg) cell; Fetal kidney|N|Natural killer T (NKT) cell"},{"path":"search-gene-metadata-1.html","id":"geninfo-features","chapter":"2 Search gene metadata","heading":"2.3 Features","text":"","code":""},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-1","chapter":"2 Search gene metadata","heading":"2.3.1 f1: keep input order","text":"genInfo result strictly keep input order.gene id unrecognized (e.g., misspelled belong organism), return data NA.","code":"\nid <- c(\n  \"MCM10\", \"CDC20\", \"S100A9\",\n  \"FAKEID\", \"TP53\", \"HBD\", \"NUDT10\"\n)\n# for human id, no need to input the org argument\ninfo <- genInfo(id, unique = TRUE)\nidentical(id, info$input_id)## [1] TRUE\nhead(info, 3)##   input_id symbol entrezid         ensembl uniprot chr     start       end\n## 1    MCM10  MCM10    55388 ENSG00000065328  Q7L590  10  13161558  13211110\n## 2    CDC20  CDC20      991 ENSG00000117399  Q12834   1  43358981  43363203\n## 3   S100A9 S100A9     6280 ENSG00000163220  P06702   1 153357854 153361023\n##   width strand                                                   gene_name\n## 1 49553      1 minichromosome maintenance 10 replication initiation factor\n## 2  4223      1                                      cell division cycle 20\n## 3  3170      1                             S100 calcium binding protein A9\n##                                                                    ncbi_alias\n## 1                                                CNA43; DNA43; IMD80; PRO2249\n## 2                                                  CDC20A; bA276H19.3; p55CDC\n## 3 60B8AG; CAGB; CFAG; CGLB; L1AG; LIAG; MAC387; MIF; MRP14; NIF; P14; S100-A9\n##                                                                   ensembl_alias\n## 1                                                         CNA43; DNA43; PRO2249\n## 2                                                                CDC20A; p55CDC\n## 3 60B8AG; CAGB; CFAG; CGLB; LIAG; MAC387; MIF; MRP-14; MRP14; NIF; P14; S100-A9\n##   gc_content   gene_biotype transcript_count    hgnc_id   omim\n## 1      43.59 protein_coding                7 HGNC:18043 609357\n## 2      52.17 protein_coding                4  HGNC:1723 603618\n## 3      52.56 protein_coding                1 HGNC:10499 123886\n##                   ccds\n## 1 CCDS7095; ; CCDS7096\n## 2              CCDS484\n## 3             CCDS1036\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         reactome\n## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                           R-HSA-1640170; R-HSA-69278; R-HSA-69620; R-HSA-69306; R-HSA-176187; R-HSA-453279; R-HSA-68962; R-HSA-69002; R-HSA-69206; R-HSA-69481\n## 2 R-HSA-392499; R-HSA-597592; R-HSA-168256; R-HSA-162582; R-HSA-194315; R-HSA-195258; R-HSA-5688426; R-HSA-5689880; R-HSA-9716542; R-HSA-1280218; R-HSA-141424; R-HSA-141444; R-HSA-1640170; R-HSA-2467813; R-HSA-2500257; R-HSA-2555396; R-HSA-5663220; R-HSA-68877; R-HSA-68882; R-HSA-68886; R-HSA-69278; R-HSA-69618; R-HSA-69620; R-HSA-9648025; R-HSA-983168; R-HSA-983169; R-HSA-141405; R-HSA-141430; R-HSA-174048; R-HSA-174143; R-HSA-174154; R-HSA-174178; R-HSA-174184; R-HSA-176407; R-HSA-176408; R-HSA-176409; R-HSA-176814; R-HSA-179409; R-HSA-179419; R-HSA-453276; R-HSA-174113; R-HSA-176417\n## 3                                                                                                                                                                                                                       R-HSA-1643685; R-HSA-168249; R-HSA-168256; R-HSA-6798695; R-HSA-162582; R-HSA-194315; R-HSA-195258; R-HSA-9716542; R-HSA-1280218; R-HSA-983169; R-HSA-166016; R-HSA-168898; R-HSA-5668599; R-HSA-1236974; R-HSA-1236975; R-HSA-6803157; R-HSA-166058; R-HSA-168179; R-HSA-168188; R-HSA-181438; R-HSA-5260271; R-HSA-5602358; R-HSA-5602498; R-HSA-5603041; R-HSA-6799990; R-HSA-5686938\n##                                                                                 ucsc\n## 1 uc001imb.4; uc057rtn.1; uc001ima.4; uc057rto.1; uc057rtp.1; uc057rtq.1; uc057rtr.1\n## 2                                     uc001cix.5; uc001ciy.4; uc057fmt.1; uc057fmu.1\n## 3                                                                         uc001fbq.4\n##   mirbase_id\n## 1       <NA>\n## 2       <NA>\n## 3       <NA>\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               cell_marker\n## 1                                                                                                                                                                                                                                                                                            Fetal gonad|T|Migration phase fetal germ cell; Umbilical cord blood|T|Granulocyte-monocyte progenitor; Fetal gonad|N|Migration phase fetal germ cell; Umbilical cord blood|N|Granulocyte-monocyte progenitor\n## 2                                                                                                                                                                                                                                                                    Embryonic prefrontal cortex|T|Neural progenitor cell; Muscle|T|Myoblast; Large intestine|T|MKI67+ progenitor cell; Embryonic prefrontal cortex|N|Neural progenitor cell; Muscle|N|Myoblast; Large intestine|N|MKI67+ progenitor cell\n## 3 Small intestine|T|Enterocyte progenitor cell; Fetal gonad|T|Granulosa cell; Blood|T|CD1C+_B dendritic cell; Fetal kidney|T|Monocyte; Kidney|T|Neutrophil; Kidney|T|Plasma cell; Kidney|T|Neutrophil; Undefined|N|Eosinophil; Undefined|N|Neutrophil; Bone marrow|N|Monocyte derived dendritic cell; Small intestine|N|Enterocyte progenitor cell; Fetal gonad|N|Granulosa cell; Blood|N|CD1C+_B dendritic cell; Fetal kidney|N|Monocyte; Kidney|N|Neutrophil; Kidney|T|Plasma cell; Kidney|T|Neutrophil"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-2","chapter":"2 Search gene metadata","heading":"2.3.2 f2: keep unique or not","text":"unique = TRUE, one record maximal information returned.","code":"\nid <- \"HBD\"\nuniq_info <- genInfo(id, org = \"hs\", unique = TRUE)\nuniq_info[, 1:4]##   input_id symbol entrezid         ensembl\n## 2      HBD    HBD     3045 ENSG00000223609\nall_info <- genInfo(id, org = \"hs\", unique = FALSE)\nall_info[, 1:4]##   input_id symbol  entrezid         ensembl\n## 1      HBD    HBD 100187828 ENSG00000223609\n## 2      HBD    HBD      3045 ENSG00000223609\n## 3      HBD KRT87P     85349 ENSG00000135477"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-3","chapter":"2 Search gene metadata","heading":"2.3.3 f3: disambiguation feature","text":"","code":""},{"path":"search-gene-metadata-1.html","id":"distinguish-from-gene-symbol-and-alias","chapter":"2 Search gene metadata","heading":"2.3.3.1 distinguish from gene symbol and alias","text":"Many common gene names gene alias, many tools accept gene symbols cause gene information lost. example, “BCC7” alias “TP53” “PD1” three aliases: “PDCD1”, “SNCA” “SPATA2” enrichment analyses tools recognize “BCC7”.","code":"\nid <- c(\"BCC7\", \"PD1\")\ngenInfo(id)[1:4]##   input_id symbol entrezid         ensembl\n## 1     BCC7   TP53     7157 ENSG00000141510\n## 2      PD1  PDCD1     5133 ENSG00000276977\n## 3      PD1  PDCD1     5133 ENSG00000188389\n## 4      PD1   SNCA     6622 ENSG00000145335\n## 5      PD1 SPATA2     9825 ENSG00000158480"},{"path":"search-gene-metadata-1.html","id":"distinguish-gene-symbol-with-special-characters","chapter":"2 Search gene metadata","heading":"2.3.3.2 distinguish gene symbol with special characters","text":"","code":"\nid <- c(\"TNF-α\", \"κB-Ras2\")\ngenInfo(id)[1:4]##   input_id  symbol entrezid         ensembl\n## 1    TNF-α     TNF     7124 ENSG00000228978\n## 2    TNF-α     TNF     7124 ENSG00000228321\n## 3    TNF-α     TNF     7124 ENSG00000232810\n## 4    TNF-α     TNF     7124 ENSG00000204490\n## 5    TNF-α     TNF     7124 ENSG00000230108\n## 6    TNF-α     TNF     7124 ENSG00000223952\n## 7    TNF-α     TNF     7124 ENSG00000206439\n## 8    TNF-α     TNF     7124 ENSG00000228849\n## 9  κB-Ras2 NKIRAS2    28511 ENSG00000168256"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-4","chapter":"2 Search gene metadata","heading":"2.3.4 f4: count organism gene types","text":"","code":"\norg <- \"hs\"\nuniq_symbol <- genInfo(org = org) %>%\n  dplyr::filter(!is.na(gene_biotype)) %>%\n  dplyr::distinct(symbol, .keep_all = T)\n\nuniq_symbol %>%\n  {\n    table(.$gene_biotype)\n  }## \n##                          IG_C_gene                    IG_C_pseudogene \n##                                 14                                  9 \n##                          IG_D_gene                          IG_J_gene \n##                                 37                                 18 \n##                    IG_J_pseudogene                          IG_V_gene \n##                                  3                                144 \n##                    IG_V_pseudogene                            Mt_rRNA \n##                                184                                  2 \n##                            Mt_tRNA                                TEC \n##                                 23                                 27 \n##                          TR_C_gene                          TR_D_gene \n##                                  7                                  4 \n##                          TR_J_gene                    TR_J_pseudogene \n##                                 79                                  4 \n##                          TR_V_gene                    TR_V_pseudogene \n##                                107                                 33 \n##                             lncRNA                              miRNA \n##                               6095                               1852 \n##                           misc_RNA             polymorphic_pseudogene \n##                               1034                                 49 \n##               processed_pseudogene                     protein_coding \n##                               7199                              19572 \n##                               rRNA                    rRNA_pseudogene \n##                                 46                                496 \n##                           ribozyme                               sRNA \n##                                  4                                  1 \n##                              scRNA                             scaRNA \n##                                  1                                 18 \n##                              snRNA                             snoRNA \n##                               1833                                437 \n##   transcribed_processed_pseudogene     transcribed_unitary_pseudogene \n##                                355                                132 \n## transcribed_unprocessed_pseudogene    translated_processed_pseudogene \n##                                770                                  2 \n##  translated_unprocessed_pseudogene                 unitary_pseudogene \n##                                  2                                 78 \n##             unprocessed_pseudogene \n##                               1706"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-5","chapter":"2 Search gene metadata","heading":"2.3.5 f5: extract all metadata","text":"user wants get information, just give org argument alone.","code":"\nall_human_data <- genInfo(org = \"human\")\ndim(all_human_data)## [1] 92441    22"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-6","chapter":"2 Search gene metadata","heading":"2.3.6 f6: extract specific biotype genes","text":"","code":""},{"path":"search-gene-metadata-1.html","id":"get-all-human-protein-coding-genes","chapter":"2 Search gene metadata","heading":"2.3.6.0.1 Get all human protein-coding genes:","text":"","code":"\nhg_pro_gene <- uniq_symbol %>%\n  dplyr::filter(gene_biotype == \"protein_coding\") %>%\n  dplyr::pull(symbol)\n\nlength(hg_pro_gene)## [1] 19572"},{"path":"search-gene-metadata-1.html","id":"compare-with-hgnc-data","chapter":"2 Search gene metadata","heading":"2.3.6.0.2 Compare with HGNC data:","text":"Check missing gene names result:Let’s look first one “ABTB3”:seems gene “ABTB3” recently modified, also known “BTBD11” matched Ensembl data: ENSG00000151136So reason mismatch --sync large database Ensembl NCBI. However, mismatch number small effect serious.personal view:NCBI updates backend data everydata Ensembl follows quarterly update cycle.long genes outdated, can also finish gene annotation enrichment analysis. recommended keep gene names updated like NCBI large databases follow high updating frequency.example, gene “BTBD11” (BTB/POZ domain-containing protein 11) recognized GeneOntology latest one “ABTB3” synced yet. using NCBI name, user may get related enrichment information gene.\nFigure 2.1: BTBD11 vs ABTB3 GeneOntology\n","code":"\nhgnc_data <- vroom::vroom(\"http://ftp.ebi.ac.uk/pub/databases/genenames/hgnc/tsv/locus_types/gene_with_protein_product.txt\")\nhgnc_symbol <- hgnc_data$symbol\nplotVenn(list(\n  genekitr_symbol = hg_pro_gene,\n  hgnc_symbol = hgnc_symbol\n))\ncheck_genes <- head(hgnc_symbol[!hgnc_symbol %in% hg_pro_gene], 3)\nhgnc_data %>%\n  dplyr::filter(symbol %in% check_genes) %>%\n  dplyr::select(\n    symbol, date_approved_reserved, date_symbol_changed,\n    entrez_id\n  )##   symbol date_approved_reserved date_symbol_changed entrez_id\n## 1  ABTB3             2003-12-15          2022-05-13    121551\n## 2 ADGRF2             2002-11-26          2015-03-03    222611\n## 3  AKR7L             2008-12-09                <NA>    246181\ngenInfo(\"121551\")[1:3]##   input_id         ensembl symbol\n## 1   121551 ENSG00000151136 BTBD11"},{"path":"search-gene-metadata-1.html","id":"compare-with-orgdb-in-bioconductor","chapter":"2 Search gene metadata","heading":"2.3.6.0.3 Compare with orgDb in Bioconductor","text":"genekitr combines Ensembl NCBI data, handle gene ids common organism-level (‘org’) packages Bioconductor.genes exist genekitr:example, gene 100101268 officially named SPDYE12, orgdb name :worry, use genekitr, can still get exact match:","code":"\n# using orgdb\nlibrary(org.Hs.eg.db)\norg_dat = AnnotationDbi::select(org.Hs.eg.db,\n                keys = AnnotationDbi::keys(org.Hs.eg.db),\n                keytype = 'ENTREZID',\n                columns = 'SYMBOL')\norg_sym <- unique(org_dat$SYMBOL)\nlength(org_sym)## [1] 61538\n# using genekitr\ngenekitr_sym <- unique(na.omit(all_human_data$symbol))\nlength(genekitr_sym)## [1] 66229\nplotVenn(list(\n  org_sym = org_sym,\n  genekitr_sym = genekitr_sym\n))\ngenekitr_sym[!genekitr_sym%in%org_sym] %>% head()## [1] \"SPDYE12\"      \"MCTS2\"        \"NAV2-AS6\"     \"SLC66A2P2\"    \"ARHGAP44-AS1\"\n## [6] \"PHB1P16\"\ngenInfo(\"SPDYE12\")[1:4]##   input_id  symbol  entrezid         ensembl\n## 1  SPDYE12 SPDYE12 100101268 ENSG00000184616\norg_dat[org_dat$ENTREZID==\"100101268\",\"SYMBOL\"]## [1] \"SPDYE12P\"\ngenInfo(\"SPDYE12P\")[1:4]##   input_id  symbol  entrezid         ensembl\n## 1 SPDYE12P SPDYE12 100101268 ENSG00000184616"},{"path":"search-gene-metadata-1.html","id":"geneinfo-feature-7","chapter":"2 Search gene metadata","heading":"2.3.7 f7: extract human cell markers","text":"CellMarker database manually curated 100,000 published papers, 4,124 entries including cell marker information, tissue type, cell type, cancer information source., geneInfo integrated human cell markers cell_marker column.naming rules : tissue_type | cancer_type: Tumor(T) Normal(N) | cell_type, one gene matches many cell types, seperated ;.","code":"\nhg_marker_all <- genInfo(org = \"human\") %>%\n  dplyr::select(symbol, cell_marker) %>%\n  dplyr::filter(!is.na(cell_marker)) %>%\n  tidyr::separate_rows(cell_marker, sep = \"; \") %>%\n  dplyr::mutate(cell_marker = gsub(\"^.*\\\\|\", \"\", cell_marker)) %>%\n  dplyr::distinct()\nhead(hg_marker_all)## # A tibble: 6 × 2\n##   symbol cell_marker                                       \n##   <chr>  <chr>                                             \n## 1 A1BG   Retinoid acid signaling-responsive fetal germ cell\n## 2 ADA    Brush cell (Tuft cell)                            \n## 3 ADA    Neuroendocrine cell                               \n## 4 ADA    Retinoid acid signaling-responsive fetal germ cell\n## 5 ADA    Oogenesis phase fetal germ cell                   \n## 6 ADA    Mitotic arrest phase fetal germ cell\n# select stromal cell markers\nhg_marker_all %>%\n  dplyr::filter(cell_marker == \"Stromal cell\") %>%\n  dplyr::pull(symbol) %>%\n  sort()##  [1] \"ALCAM\"   \"ANPEP\"   \"BST1\"    \"CD34\"    \"CD44\"    \"COL5A1\"  \"ENG\"    \n##  [8] \"GREM1\"   \"ICAM1\"   \"ICAM2\"   \"ICAM3\"   \"ITGA1\"   \"ITGA4\"   \"ITGAV\"  \n## [15] \"ITGB1\"   \"ITGB3\"   \"KIT\"     \"KLF6\"    \"LTBR\"    \"LUM\"     \"MADCAM1\"\n## [22] \"MCAM\"    \"MME\"     \"MMP1\"    \"MMP2\"    \"MMP9\"    \"NGFR\"    \"NT5E\"   \n## [29] \"PDGFRA\"  \"PDGFRB\"  \"PDPN\"    \"PECAM1\"  \"PROM1\"   \"PTPRC\"   \"THY1\"   \n## [36] \"TIMP1\"   \"TIMP2\"   \"TLR1\"    \"TLR2\"    \"TLR3\"    \"TLR4\"    \"VCAM1\"  \n## [43] \"VIM\""},{"path":"search-pubmed-1.html","id":"search-pubmed-1","chapter":"3 Search PubMed records","heading":"3 Search PubMed records","text":"getPubmed function utilizes europepmc easily get PubMed records searching paper abstract.Users need input term argument; supplement information, keys parameter available.example, user wants check papers genes “Tp53”, “Brca1,” “Tet2” research mouse stem cells:NOTICE:\nminor update made version 0.8.6 . Argument keys replaced add_term easy understanding, num parameter added specify number returned records.","code":"\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nkeys <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, keys)\nnames(l)## [1] \"Tp53\"  \"Brca1\" \"Tet2\"\nhead(l$Tp53, 5)## # A tibble: 5 × 28\n##   id      source pmid  doi   title authorString journalTitle issue journalVolume\n##   <chr>   <chr>  <chr> <chr> <chr> <chr>        <chr>        <chr> <chr>        \n## 1 358640… MED    3586… 10.1… \"Bia… Ohno T, Aka… Nat Commun   1     13           \n## 2 354091… MED    3540… 10.3… \"Enh… Gringmuth M… Int J Mol S… 7     23           \n## 3 357633… MED    3576… 10.1… \"Deg… Sellar RS, … J Clin Inve… <NA>  <NA>         \n## 4 PPR467… PPR    <NA>  10.1… \"Bia… Ohno T, Aka… <NA>         <NA>  <NA>         \n## 5 354353… MED    3543… 10.1… \"Ide… Thirouard L… Adv Sci (We… 17    9            \n## # … with 19 more variables: pubYear <chr>, journalIssn <chr>, pageInfo <chr>,\n## #   pubType <chr>, isOpenAccess <chr>, inEPMC <chr>, inPMC <chr>, hasPDF <chr>,\n## #   hasBook <chr>, hasSuppl <chr>, citedByCount <int>, hasReferences <chr>,\n## #   hasTextMinedTerms <chr>, hasDbCrossReferences <chr>, hasLabsLinks <chr>,\n## #   hasTMAccessionNumbers <chr>, firstIndexDate <chr>,\n## #   firstPublicationDate <chr>, pmcid <chr>\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nadd_term <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, add_term, num = 30)\n# set \"num\" larger to get all records\nall <- getPubmed(term, add_term, num = 666666)"},{"path":"gene-id-conversion-1.html","id":"gene-id-conversion-1","chapter":"4 Gene ID conversion","heading":"4 Gene ID conversion","text":"handled genomics analysis, may spend much time converting gene identifiers types.example, gene set enrichment analysis common omics downstream process mainly based MsigDb. According release note, since MSigDB 7.0, identifiers genes mapped HGNC approved Gene Symbol NCBI Gene ID annotations extracted Ensembl’s BioMart data service, updated MSigDB release latest available version Ensembl. Currently, MSigDB 7.5 updated human gene annotations Ensembl v105.Hence, id conversion help keeping update latest annotations.common gene id types symbol (e.g. TP53),NCBI Entrez (e.g. 7157) Ensembl (e.g. ENSG00000141510). ID conversion among different types common two main concerns: performance flexibility.","code":""},{"path":"gene-id-conversion-1.html","id":"convertion-current-tools","chapter":"4 Gene ID conversion","heading":"4.1 Current tools","text":"Currently various tools available, however different methods drawbacks:biomaRt: R package frequently used access --date Ensembl database. access online database time built-parameters many.clusterProfiler: R package depends Bioconductor annotation packages extract NCBI gene. NCBI database updates every day Bioconductor package updates nearly every six months. Besides, supports 20 organisms user download load annotation data mapping.gProfiler: web server supports 40 types IDs 60 species. supports one--one conversion, example, user want convert gene symbol Entrez Ensembl, happen. Besides, output result convenient process.DAVID: web server interface user-friendly.UniProt: large protein database may support almost species user needs specify input id type converts protein id.GIDcon: web server covers human, mouse rat. User must seperates gene ids comma batch query. Five symbols take 8 secs convert.Considered problems, genekitr combines Ensembl NCBI database provide comprehensive result optimizes running speed.Also supports 195 vertebrate species, 120 plant species 2 bacteria species (see also session 1.1).","code":""},{"path":"gene-id-conversion-1.html","id":"transid-basic-usage","chapter":"4 Gene ID conversion","heading":"4.2 Basic usage","text":"transId provides five arguments:id: gene id (symbol, Entrez Ensembl), protein id (see also session 4.2) microarray id (see also session 5.1)id: gene id (symbol, Entrez Ensembl), protein id (see also session 4.2) microarray id (see also session 5.1)transTo: conversion target type. User select one “symbol”, “entrez”, “ensembl” “uniprot”. Besides, abbreviation acceptable (e.g. “ens” fine “ensembl” “en” raise error separate “entrez”)transTo: conversion target type. User select one “symbol”, “entrez”, “ensembl” “uniprot”. Besides, abbreviation acceptable (e.g. “ens” fine “ensembl” “en” raise error separate “entrez”)org: organism name, default humanorg: organism name, default humanunique: TRUE FALSE (default). TRUE, returns one matched id.unique: TRUE FALSE (default). TRUE, returns one matched id.keepNA: TRUE FALSE (default). id matched one, keep .keepNA: TRUE FALSE (default). id matched one, keep .See human example , due NA removed, result order slightly different input id.want get order, can set keepNA = TRUE:want get one--one mapping, can set unique = TRUE result comprehensive information return:","code":"\n# human genes\nid <- c(\"AKT3\", \"SSX6P\", \"FAKE_ID\", \"BCC7\")\ntransId(id, transTo = \"ens\")##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2     AKT3 ENSG00000117020\n## 3    SSX6P ENSG00000171483\n## 4     BCC7 ENSG00000141510\n# fruit fly genes\ntransId(\n  id = c(\"10178780\", \"10178777\", \"10178786\", \"10178792\"),\n  transTo = \"sym\", org = \"fly\"\n)##   input_id          symbol\n## 1 10178780         CR33929\n## 2 10178777         CG42835\n## 3 10178786 Su(Ste):CR40820\n## 4 10178792         CG42694\ntransId(id, transTo = \"ens\", keepNA = TRUE)##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2     AKT3 ENSG00000117020\n## 3    SSX6P ENSG00000171483\n## 4  FAKE_ID            <NA>\n## 5     BCC7 ENSG00000141510\ntransId(id, transTo = \"ens\", keepNA = TRUE, unique = TRUE)##    input_id         ensembl\n## 21     AKT3 ENSG00000117020\n## 1     SSX6P ENSG00000171483\n## 2   FAKE_ID            <NA>\n## 3      BCC7 ENSG00000141510"},{"path":"gene-id-conversion-1.html","id":"transid-features","chapter":"4 Gene ID conversion","heading":"4.3 Features","text":"","code":""},{"path":"gene-id-conversion-1.html","id":"transid-feature-1","chapter":"4 Gene ID conversion","heading":"4.3.1 f1: convert to several types","text":"transTo accepts one type:","code":"\ntransId(id, transTo = c(\"ens\", \"ent\"))##   input_id         ensembl entrezid\n## 1     AKT3 ENSG00000275199    10000\n## 2     AKT3 ENSG00000117020    10000\n## 3    SSX6P ENSG00000171483   280657\n## 4     BCC7 ENSG00000141510     7157"},{"path":"gene-id-conversion-1.html","id":"transid-feature-2","chapter":"4 Gene ID conversion","heading":"4.3.2 f2: distinguish from symbol and alias","text":"One big common problem current tools confusion gene symbol gene alias.Gene alias alternative name official gene symbol, like “BCC7” actually alias “TP53”. Sometimes gene alias widely used official symbol. example, “PDL1” alias “CD274” fact.Due combination NCBI Ensembl metadata, transId easily recognize gene symbol alias setting transTo = 'symbol'.","code":"\ntransId(c(\"BCC7\", \"TP53\", \"PD1\", \"PDL1\", \"TET2\"), \"sym\")##   input_id symbol\n## 1     BCC7   TP53\n## 2     TP53   TP53\n## 3      PD1  PDCD1\n## 4      PD1   SNCA\n## 5      PD1 SPATA2\n## 6     PDL1  CD274\n## 7     TET2   TET2"},{"path":"gene-id-conversion-1.html","id":"transid-feature-3","chapter":"4 Gene ID conversion","heading":"4.3.3 f3: no worry for Ensembl version","text":"Ensembl stable ID consists five parts: ENS(species)(object type)(identifier). (version)\nexample, ENSG00000141510.11 TP53 version .11 may confuse many tools.\nHowever using transId, user worry issue .","code":"\ntransId(\"ENSG00000141510.11\", \"symbol\")##          input_id symbol\n## 1 ENSG00000141510   TP53"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-data","chapter":"4 Gene ID conversion","heading":"4.4 Excercise 1: DEG result","text":"built-example data differentially expressed genes : GSE42872","code":"\ndata(deg, package = \"genekitr\")\ntable(deg$change)## \n##   down stable     up \n##    451  17009    579\nid <- deg$entrezid\nlength(id)## [1] 18039"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-bitr","chapter":"4 Gene ID conversion","heading":"4.4.1 clusterProfiler::bitr","text":"User needs specify input id type converted type columns(org.Hs.eg.db).","code":"\n# User must firstly install the org.Hs.eg.db\n# BiocManager::install('org.Hs.eg.db')\nlibrary(org.Hs.eg.db)\nlibrary(clusterProfiler)\nAnnotationDbi::columns(org.Hs.eg.db)##  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n##  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n## [11] \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"          \"OMIM\"        \n## [16] \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"         \"PMID\"        \n## [21] \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"       \"UNIGENE\"     \n## [26] \"UNIPROT\"\nbitr_res <- bitr(id, fromType = \"ENTREZID\", toType = \"SYMBOL\", OrgDb = \"org.Hs.eg.db\")\nbitr_sym <- unique(bitr_res$SYMBOL)\nlength(bitr_sym)## [1] 18036"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-biomart","chapter":"4 Gene ID conversion","heading":"4.4.2 biomaRt::getBM","text":"initializing process depends mainly Ensembl’s web access speed. Usually, may take tens seconds.","code":"\n# initializing...\nensembl <- biomaRt::useEnsembl(\n  biomart = \"genes\",\n  dataset = \"hsapiens_gene_ensembl\"\n)\n# conversion\nbiomart_res <- biomaRt::getBM(\n  attributes = c(\"entrezgene_id\", \"external_gene_name\"),\n  filters = c(\"entrezgene_id\"),\n  mart = ensembl,\n  values = id\n)\nbiomart_sym <- unique(biomart_res$external_gene_name) %>%\n  stringi::stri_remove_empty()\nlength(biomart_sym)## [1] 16085"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-transid","chapter":"4 Gene ID conversion","heading":"4.4.3 genekitr::transId","text":"","code":"\ntransid_res <- genekitr::transId(id, transTo = \"sym\", unique = T)\ntransid_sym <- unique(transid_res$symbol)\nlength(transid_sym)## [1] 18039"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-compare","chapter":"4 Gene ID conversion","heading":"4.4.4 compare three results","text":"","code":"\nplotVenn(list(\n  bitr = bitr_sym,\n  transid = transid_sym,\n  biomart = biomart_sym\n))"},{"path":"gene-id-conversion-1.html","id":"bitr-vs-transid","chapter":"4 Gene ID conversion","heading":"4.4.4.1 bitr vs transId","text":"117 genes bitr result:Let’s take look first one LINC00337, converted gene 148645When search NCBI see official symbol “ICMT-DT” now “LINC00337” alias. look back transId result, keeps update NCBI web.Besides, 118 unique symbols transId result:gene ICMT-DT listed.","code":"\nbitr_sym[!bitr_sym %in% transid_sym] %>% head(5)## [1] \"C19orf71\"     \"LINC00476\"    \"LOC100129484\" \"PP2672\"       \"LOC100130449\"\nbitr_res %>%\n  filter(SYMBOL %in% \"LINC00337\") %>%\n  pull(ENTREZID)## [1] \"148645\"\ntransid_res %>%\n  filter(input_id %in% \"148645\") %>%\n  pull(symbol)## [1] \"ICMT-DT\"\ntransid_sym[!transid_sym %in% bitr_sym] %>% head(5)## [1] \"TEKTIP1\"     \"ERCC6L2-AS1\" \"LINC02983\"   \"LINC02961\"   \"GPC1-AS1\""},{"path":"gene-id-conversion-1.html","id":"biomart-vs-transid","chapter":"4 Gene ID conversion","heading":"4.4.4.2 biomart vs transId","text":"13 genes biomart result:search NCBI 100528032 see official symbol “KLRC4-KLRK1”. look back transId bitr result, NCBI web.","code":"\nbiomart_sym[!biomart_sym %in% transid_sym] %>% head()## [1] \"KLRK1\"     \"FLJ37453\"  \"C11orf49\"  \"C19orf71\"  \"ZNF761\"    \"LINC01588\"\nbiomart_res %>%\n  filter(external_gene_name %in% \"KLRK1\") %>%\n  pull(entrezgene_id)## [1] 100528032\nbitr_res %>%\n  filter(ENTREZID == \"100528032\") %>%\n  pull(SYMBOL)## [1] \"KLRC4-KLRK1\"\ntransid_res %>%\n  filter(input_id %in% \"100528032\") %>%\n  pull(symbol)## [1] \"KLRC4-KLRK1\""},{"path":"gene-id-conversion-1.html","id":"transid-ex2-data","chapter":"4 Gene ID conversion","heading":"4.5 Excercise 2: mixture of gene symbol and alias","text":"Compared Entrez Ensembl, gene symbol alias hard distinguish. real science life, impact misunderstanding names huge.Takehara et al. (2018) retract published paper authors just misused “TAZ” actual research target “WWTR1” “TAZ” alias “WWTR1”.similar issues published paper: risks using unapproved gene symbols. course, happens human research. must raise alert gene alias.","code":""},{"path":"gene-id-conversion-1.html","id":"hgnchelper-vs-transid","chapter":"4 Gene ID conversion","heading":"4.5.1 HGNChelper vs transId","text":"HGNChelper mainly built human research, give simple human gene list example.first three genes omitted HGNChelper.","code":"\nid <- c(\"TBET\", \"B220\", \"BCC7\", \"PD1\", \"PDL1\")\n\ntransid_res <- genekitr::transId(id, transTo = \"sym\", unique = FALSE)\ntransid_res##   input_id symbol\n## 1     TBET  TBX21\n## 2     B220  PTPRC\n## 3     BCC7   TP53\n## 4      PD1  PDCD1\n## 5      PD1   SNCA\n## 6      PD1 SPATA2\n## 7     PDL1  CD274\nhgnc_res <- HGNChelper::checkGeneSymbols(id)\nhgnc_res##      x Approved          Suggested.Symbol\n## 1 TBET    FALSE                      <NA>\n## 2 B220    FALSE                      <NA>\n## 3 BCC7    FALSE                      <NA>\n## 4  PD1    FALSE PDCD1 /// SNCA /// SPATA2\n## 5 PDL1    FALSE                     CD274"},{"path":"gene-id-conversion-1.html","id":"genesymbolthesarus-vs-transid","chapter":"4 Gene ID conversion","heading":"4.5.2 GeneSymbolThesarus vs transId","text":"GeneSymbolThesarus function Seurat finds current gene symbols HUGO Gene Nomenclature Committee (HGNC). search online speed fast.Seurat returns one records.","code":"\nlibrary(Seurat)## Attaching SeuratObject## \n## Attaching package: 'Seurat'## The following object is masked from 'package:DT':\n## \n##     JS\nstart <- Sys.time()\nseurat_res <- Seurat::GeneSymbolThesarus(symbols = id)\nend <- Sys.time()\n(end - start)## Time difference of 57.88858 secs\nseurat_res##    PDL1 \n## \"CD274\""},{"path":"gene-id-conversion-1.html","id":"alias2symbol-vs-transid","chapter":"4 Gene ID conversion","heading":"4.5.3 alias2Symbol vs transId","text":"alias2Symbol function limma depends organism annotation package Bioconductor.seems alias2Symbol result remains disorder input id, may cause misunderstanding users, transId keeps original order (user want get one--one match, just pass unique = TRUE function).","code":"\nlimma_res <- limma::alias2Symbol(id, species = \"Hs\")\n# compare with transId result\nid## [1] \"TBET\" \"B220\" \"BCC7\" \"PD1\"  \"PDL1\"\nlimma_res## [1] \"CD274\"  \"TBX21\"  \"PDCD1\"  \"PTPRC\"  \"SNCA\"   \"TP53\"   \"SPATA2\"\ntransid_res$symbol## [1] \"TBX21\"  \"PTPRC\"  \"TP53\"   \"PDCD1\"  \"SNCA\"   \"SPATA2\" \"CD274\""},{"path":"protein-id-conversion-1.html","id":"protein-id-conversion-1","chapter":"5 Protein ID conversion","heading":"5 Protein ID conversion","text":"handled proteomics metabolomics data (e.g. mass spectrometry), may need convert protein gene id downstream analysis.","code":""},{"path":"protein-id-conversion-1.html","id":"protein-example-data","chapter":"5 Protein ID conversion","heading":"5.1 Example data","text":"example, data article Dataset proteomic analysis rat, mouse, human liver microsomes S9 fractions , get rat proteomic analysis dataFirstly, take look data:second column rat protein id, third one gene name.","code":"\ncolnames(rat_prodata)## [1] \"GI\"       \"Acc\"      \"Gene\"     \"Name\"     \"GRAVY\"    \"Length\"   \"Sequence\"\nhead(rat_prodata, 5)##       GI    Acc      Gene\n## 1 112774 P27364 3BHS5_RAT\n## 2 112889 P17475  A1AT_RAT\n## 3 112893 P14046  A1I3_RAT\n## 4 112987 P00507  AATM_RAT\n## 5 113016 P15650 ACADL_RAT\n##                                                        Name      GRAVY Length\n## 1                3 beta-hydroxysteroid dehydrogenase type 5 -0.2168901    373\n## 2                                    Alpha-1-antiproteinase -0.1576642    411\n## 3                                       Alpha-1-inhibitor 3 -0.2164523   1477\n## 4                 Aspartate aminotransferase, mitochondrial -0.2295349    430\n## 5 Long-chain specific acyl-CoA dehydrogenase, mitochondrial -0.2227907    430\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Sequence\n## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 MPGWSCLVTGAGGFLGQRIVQMLVQEKELQEVRVLYRTFSPKHKEELSKLQTKAKVTVLRGDIVDAQFLRRACQGMSVIIHTAAALDIAGFLPRQTILDVNVKGTQLLLDACVEASVPAFIYSSSTGVAGPNSYKETILNDREEEHRESTWSNPYPYSKRMAEKAVLAANGSILKNGGTFHTCALRLPFIYGEESQIISTMVNRALKNNSIIKRHATFSIANPVYVGNAAWAHILAARGLRDPEKSQSIQGQFYYISDDTPHQSYDDLNYTLSKEWGFCLDSSWSLPLPLLYWLAFLLETVSFLLRPFYNYRPPFNRFMVTILNSVFTISYKKAQRDLGYEPLVSWEEAKQKTSEWIGTLVEQHRETLDTKSQ\n## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           MAPSISRGLLLLAALCCLAPSFLAEDAQETDTSQQDQSPTYRKISSNLADFAFSLYRELVHQSNTSNIFFSPMSITTAFAMLSLGSKGDTRKQILEGLEFNLTQIPEADIHKAFHHLLQTLNRPDSELQLNTGNGLFVNKNLKLVEKFLEEVKNNYHSEAFSVNFADSEEAKKVINDYVEKGTQGKIVDLMKQLDEDTVFALVNYIFFKGKWKRPFNPEHTRDADFHVDKSTTVKVPMMNRLGMFDMHYCSTLSSWVLMMDYLGNATAIFLLPDDGKMQHLEQTLTKDLISRFLLNRQTRSAILYFPKLSISGTYNLKTLLSSLGITRVFNNDADLSGITEDAPLKLSQAVHKAVLTLDERGTEAAGATVVEAVPMSLPPQVKFDHPFIFMIVESETQSPLFVGKVIDPTR\n## 3 MKKDREAQLCLFSALLAFLPFASLLNGNSKYMVLVPSQLYTETPEKICLHLYHLNETVTVTASLISQRGTRKLFDELVVDKDLFHCVSFTIPRLPSSEEEESLDINIEGAKHKFSERRVVLVKNKESVVFVQTDKPMYKPGQSVKFRVVSMDKNLHPLNELFPLAYIEDPKMNRIMQWQDVKTENGLKQLSFSLSAEPIQGPYKIVILKQSGVKEEHSFTVMEFVLPRFGVDVKVPNAISVYDEIINVTACATYTYGKPVPGHVKISLCHGNPTFSSETKSGCKEEDSRLDNNGCSTQEVNITEFQLKENYLKMHQAFHVNATVTEEGTGSEFSGSGRIEVERTRNKFLFLKADSHFRHGIPFFVKVRLVDIKGDPIPNEQVLIKARDAGYTNATTTDQHGLAKFSIDTNGISDYSLNIKVYHKEESSCIHSSCTAERHAEAHHTAYAVYSLSKSYIYLDTEAGVLPCNQIHTVQAHFILKGQVLGVLQQIVFHYLVMAQGSILQTGNHTHQVEPGESQVQGNFALEIPVEFSMVPVAKMLIYTILPDGEVIADSVKFQVEKCLRNKVHLSFSPSQSLPASQTHMRVTASPQSLCGLRAVDQSVLLQKPEAELSPSLIYDLPGMQDSNFIASSNDPFEDEDYCLMYQPIAREKDVYRYVRETGLMAFTNLKIKLPTYCNTDYDMVPLAVPAVALDSSTDRGMYESLPVVAVKSPLPQEPPRKDPPPKDPVIETIRNYFPETWIWDLVTVNSSGVTELEMTVPDTITEWKAGALCLSNDTGLGLSSVASFQAFQPFFVELTMPYSVIRGEAFTLKATVLNYLPTSLPMAVLLEASPDFTAVPVENNQDSYCLGANGRHTSSWLVTPKSLGNVNFSVSAEARQSPGPCGSEVATVPETGRKDTVVKVLIVEPEGIKKEHTFSSLLCASDAELSETLSLLLPPTVVKDSARAHFSVMGDILSSAIKNTQNLIQMPYGCGEQNMVLFAPNIYVLKYLNETQQLTEKIKSKALGYLRAGYQRELNYKHKDGSYSAFGDHNGQGQGNTWLTAFVLKSFAQARAFIFIDESHITDAFTWLSKQQKDSGCFRSSGSLLNNAMKGGVDDEITLSAYITMALLESSLPDTDPVVSKALSCLESSWENIEQGGNGSFVYTKALMAYAFALAGNQEKRNEILKSLDKEAIKEDNSIHWERPQKPTKSEGYLYTPQASSAEVEMSAYVVLARLTAQPAPSPEDLALSMGTIKWLTKQQNSYGGFSSTQDTVVALDALSKYGAATFSKSQKTPSVTVQSSGSFSQKFQVDKSNRLLLQQVSLPYIPGNYTVSVSGEGCVYAQTTLRYNVPLEKQQPAFALKVQTVPLTCNNPKGQNSFQISLEISYMGSRPASNMVIADVKMLSGFIPLKPTVKKLERLGHVSRTEVTTNNVLLYLDQVTNQTLSFSFIIQQDIPVKNLQPAIVKVYDYYETDEVAFAEYSSPCSSDDQNV\n## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        MALLHSGRVLSGMAAAFHPGLAAAASARASSWWTHVEMGPPDPILGVTEAFKRDTNSKKMNLGVGAYRDDNGKPYVLPSVRKAEAQIAGKNLDKEYLPIGGLADFCKASAELALGENSEVLKSGRFVTVQTISGTGALRVGASFLQRFFKFSRDVFLPKPSWGNHTPIFRDAGMQLQGYRYYDPKTCGFDFSGALEDISKIPEQSVLLLHACAHNPTGVDPRPEQWKEMAAVVKKKNLFAFFDMAYQGFASGDGDKDAWAVRHFIEQGINVCLCQSYAKNMGLYGERVGAFTVVCKDAEEAKRVESQLKILIRPLYSNPPLNGARIAATILTSPDLRKQWLQEVKGMADRIISMRTQLVSNLKKEGSSHNWQHITDQIGMFCFTGLKPEQVERLTKEFSVYMTKDGRISVAGVTSGNVGYLAHAIHQVTK\n## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        MAARLLLRSLRVLSARSATLPPPSARCSHSGAEARLETPSAKKLTDIGIRRIFSSEHDIFRESVRKFFQEEVIPYHEEWEKAGEVSRELWEKAGKQGLLGINIAEKHGGIGGDLLSTAVTWEEQAYSNCTGPGFSLHSDIVMPYIANYGTKEQIEQFIPQMTAGKCIGAIAMTEPGAGSDLQGVRTNAKRSGSDWILNGSKVFITNGWLSDLVIVVAVTNREARSPAHGISLFLVENGMKGFIKGKKLHKMGMKAQDTAELFFEDVRLPASALLGEENKGFYYLMQELPQERLLIADLAISACEFMFEETRNYVRQRKAFGKTVAHIQTVQHKLAELKTNICVTRAFVDSCLQLHETKRLDSASASMAKYWASELQNTVAYQCVQLHGGWGYMWEYPIAKAYVDARVQPIYGGTNEIMKELIARQIVSDS"},{"path":"protein-id-conversion-1.html","id":"protein-id-conversion-2","chapter":"5 Protein ID conversion","heading":"5.2 Id conversion","text":"convert protein id gene symbol compare original one.Maybe noticed gene names different original data. example, second one: A0JPQ8 called Alkmo , latest name Agmo.proteins new gene names like , may names now.see result : protein id P01835 replaced gene name NA.Venn plot shows primary protein ids changed gene names. users continue use old gene names, may lose latest gene information even enriched pathways.","code":"\nprotein_id <- rat_prodata[, \"Acc\"]\ngname <- transId(protein_id, \"symbol\", \"rat\", unique = T)\n\nnew_res <- merge(rat_prodata, gname,\n  by.x = \"Acc\", by.y = \"input_id\", all.x = T\n) %>%\n  dplyr::relocate(symbol, .after = Gene)\n\nhead(new_res, 5)##      Acc        GI      Gene       symbol\n## 1 A0FKI7 123797828 ACBD5_RAT        Acbd5\n## 2 A0JPQ8 158512263 ALKMO_RAT         Agmo\n## 3 A0JPQ9 134035401 CHID1_RAT LOC100911881\n## 4 A1L134 221222583  AUP1_RAT         Aup1\n## 5 A1L1J9 171704593  LMF2_RAT         Lmf2\n##                                           Name       GRAVY Length\n## 1 Acyl-CoA-binding domain-containing protein 5 -0.81245059    506\n## 2                  Alkylglycerol monooxygenase  0.23579418    447\n## 3        Chitinase domain-containing protein 1 -0.20229008    393\n## 4                 Ancient ubiquitous protein 1 -0.09902439    410\n## 5                   Lipase maturation factor 2  0.04757835    702\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Sequence\n## 1                                                                                                                                                                                                     MLFLSFYAGSWESWICCCCVIPVDRPWDRGRRWQLEMADTRSVYETRFEAAVKVIQSLPKNGSFQPTNEMMLRFYSFYKQATEGPCKLSRPGFWDPIGRYKWDAWSSLGDMTKEEAMIAYVEEMKKIIETMPMTEKVEELLHVIGPFYEIVEDKKNSKSSDLTSDLGNVLTSSNAKAVNGKAESSDSGAESEEEEAQEELKGAEQSGSDDKKMMTKSTDKNLEIIVTNGYKDSFAQDSDIHTDSSRSARRSEDKKPTDQSSQQTGNTVLCVHQDTNEDPGEDASGVHHLTSDSDSEVYCDSMEQFGQEEYYLGGDPAQHLEGSGFCEDAQLSPGNGSIGKMQMRAVKGKGEVKHGGEDGRSSSGTPHREKRGGESEDISGVRRGRGHRMPHLSEGTKGRQVGSGGDGERWGSDRGSRGSLNEQIALVLIRLQEDMQNVLQRLHKLETLTASQAKLSWQTSNQPSSQRPSWWPFEMSPGALAFAIIWPFIAQWLVHLYYQRRRRKLN\n## 2                                                                                                                                                                                                                                                                MRNPGAQDNVSVSQGMRAMFYMMKPSETAFQTVEEVPDYVKKATPFFIFLILLELVVSWILKGKPSGRLDDILTSMSAGVVSRLPNLFFRSLEVTSYIYIWENYRVCELPWDSPWTWYLTFLGVDFGYYWFHRMAHEINIIWAAHQAHHSSEDYNLSTALRQSVLQQYSSWVFYCPLALFVPPSVFAVHIQFNLLYQFWIHTEVIRTLGPLELVLNTPSHHRVHHGRNRYCIDKNYAGTLIIWDRIFGTFEAENEQVIYGLTHPIGTFEPFKVQFHHLLYIWTTFWATPGFCHKFSVLFKGPGWGPGKPRLGLSEEIPEVTGQEVPFTSSASQFLKIYAVLQFAVMLVFYEETFANTAVLSQVTILLRICFIILTLTSIGFLLDQRPKAAIVETLRCLLFLTLYRFGHLKPLIESLSFAFEIFFSVCIAFWGVRSITHLASGSWKKP\n## 3                                                                                                                                                                                                                                                                                                                      MWPLLHVLWLALVCGSVHTTLSKSDAKKAASKTLLEKTQFSDKPVQDRGLVVTDIKAEDVVLEHRSYCSARARERNFAGEVLGYVTPWNSHGYDVAKVFGSKFTQISPVWLQLKRRGREMFEITGLHDVDQGWMRAVKKHAKGVRIVPRLLFEDWTYDDFRSVLDSEDEIEELSKTVVQVAKNQHFDGFVVEVWSQLLSQKHVGLIHMLTHLAEALHQARLLVILVIPPAVTPGTDQLGMFTHKEFEQLAPILDGFSLMTYDYSTSQQPGPNAPLSWIRACVQVLDPKSQWRSKILLGLNFYGMDYAASKDAREPVIGARYIQTLKDHRPRVVWDSQAAEHFFEYKKNRGGRHVVFYPTLKSLQVRLELARELGVGVSIWELGQGLDYFYDLL\n## 4                                                                                                                                                                                                                                                                                                     MEPPPAPGPERLFDSHRLPSDGFLLLALLLYAPVGLCLLVLRLFLGLHVFLVSCALPDSVLRRFVVRTMCAVLGLVARQEDSGLRDHRVRVLISNHVTPFDHNIVNLLTTCSTPLLNSPPSFVCWSRGFMEMDRRVELVESLKKFCASTRLPPTPLLLFPEEEATNGREGLLRFSSWPFSIQDVVQPLTLQVQRPLVSVTVSDASWVSELLWSLFVPFTVYQVRWLHPIRRQLGEENEEFALRVQQLVAKELGQIGTRLTPADKAEHMKRQRHPRLRPQSVQSSFPSPPSPSSDVQLTILAQRVKEVLPHVPLNVIQRDLARTGCVDLTITNLLEGAVAFMPEDVTEGSQSLPTASAPKFPSSGLVTPQPTALTFAKSSWARQESLQERKQALYEYARRRFRERQAQEAE\n## 5 MASARVPQQLFLQGVAAVYLFAFASLYTQIPGLYGPEGILPARRTLRPQGKGRWQQLWETPTILWEAPRLGLDTAQGLDLLTLLGTVLALGALLLNSLRHPFIYLLLWAAYLSACQVGQVFLYFQWDSLLLETGFLAILVAPLRRPSKHKIPQGGLAGALPHEDLPFWLVRWLLFRLMFASGVVKLTSRCPAWWGLTALTYHYETQCLPTPAAWFAHHLPVWLHRLSVVATFLIEIAVPPLFFAPIRRLRLSAFYAQALLQILIIITGNYNFFNLLTLVLTTALLDDRHLSAEPELRCHKKMPTSWPKTLLTSLSLMLELTVYGLLAYGTIYYFGLEVDWQQQIVLSKTTFTFHQFSQWLKMVTLPTVWLGTASLAWELLIALWRWIQVQGWSRKFFAGIQLSVLGTATVFLFLISLVPYSYVEPGTHGRLWTGAHRLFSSVEHLQLANSYGLFRRMTGLGGRPEVVLEGSHDGHHWTEIEFMYKPGNVSRPPPFLIPHQPRLDWQMWFAALGPHTHSPWFTSLVLRLLQGKEPVIRLIQNQVANYPFREQPPTYLRAQRYKYWFSKPGDQSRWWHRQWVEEFFPSVSLGDPTLETLLQQFGLKDKSPPRARSSKNALAQTLNWVRAQLSPLEPSILLWGLLGAVVAIRVVRTLLTPRPLQSSKQTREEKRKQAPKKDSRAVSEQTAPNSNSNGSWAPRRKK\nold_name <- unique(new_res$Gene) %>%\n  stringr::str_remove_all(\"_RAT\")\nnew_name <- unique(toupper(new_res$symbol))\nnew_res[which(is.na(new_res$symbol)), ] %>%\n  dplyr::select(Acc, Gene, symbol)##        Acc      Gene symbol\n## 103 P01835  KACB_RAT   <NA>\n## 215 P0C169 H2A1C_RAT   <NA>\n## 305 P16391  HA12_RAT   <NA>\n## 485 P50169  RDH3_RAT   <NA>\n## 544 P62161  CALM_RAT   <NA>\n## 620 P81828   UP2_RAT   <NA>\n## 623 P83121   UP3_RAT   <NA>\n## 950 Q6P6G2 CF089_RAT   <NA>\nplotVenn(list(old_name = old_name, new_name = na.omit(new_name)))"},{"path":"probe-id-conversion-1.html","id":"probe-id-conversion-1","chapter":"6 Probe ID conversion","heading":"6 Probe ID conversion","text":"Probes used measure expression level many genes. getting micro array data, first important thing downstream analysis maybe probe id conversion.Ensembl database regularly maps probes sets latest set transcript models using pipeline., transProbe utilizes Ensembl --date annotation datasets join together genekitr functions fluently.Notice: now support human data","code":""},{"path":"probe-id-conversion-1.html","id":"transProbe-supported-platforms","chapter":"6 Probe ID conversion","heading":"6.1 Supported platforms","text":"36 probe platforms include Affymetrix, Agilent, Illumina, Codelink Phalanx.","code":"\nDT::datatable(hsapiens_probe_platform, options = list(pageLength = 10))"},{"path":"probe-id-conversion-1.html","id":"probe-basic-usage","chapter":"6 Probe ID conversion","heading":"6.2 Basic usage","text":"transProbe four arguments:id: probe idtransTo: conversion target type. User select one “symbol”, “entrez”, “ensembl” “uniprot”.org: human (default)platform: Probe platform. given, program detect automatically.","code":"\ndata(deg, package = \"genekitr\")\nprobes <- deg$probe_id\n\nres <- transProbe(probes, transTo = \"ensembl\", org = \"human\")\nhead(probes)## [1] \"8144866\" \"8066431\" \"8022674\" \"7925531\" \"8081358\" \"7979931\"\nhead(res)## # A tibble: 6 × 2\n## # Groups:   probe_id [6]\n##   probe_id ensembl        \n##   <chr>    <chr>          \n## 1 8144866  ENSG00000156006\n## 2 8066431  ENSG00000196839\n## 3 8022674  ENSG00000170558\n## 4 7925531  ENSG00000275199\n## 5 8081358  ENSG00000256628\n## 6 7979931  ENSG00000133997"},{"path":"probe-id-conversion-1.html","id":"convert-probe-types","chapter":"6 Probe ID conversion","heading":"6.3 Convert to more than one type","text":"User define transTo many types:Let’s take first record example:[ENSG00000228794](https://www.ensembl.org/id/ENSG00000228794) 38 transcripts.look second transcript ENST00000445118.7, probe 7896759 listed AFFY HuGene-1_0-st-v1 database.","code":"\nres2 <- transProbe(probes, transTo = c(\"ensembl\",\"symbol\"), org = \"human\")\nhead(res2)##       probe_id         ensembl     symbol\n## 9023   8144866 ENSG00000156006       NAT2\n## 15007  8066431 ENSG00000196839        ADA\n## 11595  8022674 ENSG00000170558       CDH2\n## 17512  7925531 ENSG00000275199       AKT3\n## 17126  8081358 ENSG00000256628 ZBTB11-AS1\n## 6218   7979931 ENSG00000133997       MED6"},{"path":"get-gene-sets-1.html","id":"get-gene-sets-1","chapter":"7 Get gene sets","heading":"7 Get gene sets","text":"Gene sets statistical methods central parts gene enrichment analysis (GEA).facilitate GEA, developed package geneset, provides comprehensive list monthly-updating gene set (GS) libraries.","code":""},{"path":"get-gene-sets-1.html","id":"geneset-package-intruduction","chapter":"7 Get gene sets","heading":"7.1 Geneset package intruduction","text":"R package curated GO (BP, CC MF), KEGG (pathway, module, enzyme, network, drug disease), WikiPathway, MsigDb, EnrichrDb, Reactome, MeSH, DisGeNET, Disease Ontology (), Network Cancer Gene (NCG) (version 6 v7) COVID-19.supports model non-model species.details, please refer site.GO supports 143 speciesKEGG supports 8213 speciesMeSH supports 71 speciesMsigDb supports 20 speciesWikiPahtwaysupports 16 speciesReactome supports 11 speciesEnrichrDB supports 5 speciesDisease-related support human (, NCG, DisGeNET COVID-19)","code":""},{"path":"get-gene-sets-1.html","id":"geneset-go","chapter":"7 Get gene sets","heading":"7.2 Get GO geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"go-introduction","chapter":"7 Get gene sets","heading":"7.2.1 GO introduction","text":"According Wikipedia, “Ontologies consist detectable directly observable representations things relationships things.”GO short Gene Ontology. GO analysis find associations gene products GO terms， three domains:Biological Processes (BP)\nbiological process represents specific objective organism genetically programmed achieve.\nbiological process represents specific objective organism genetically programmed achieve.Molecular Functions (MF)\nmolecular process can carried action single macromolecular machine, usually via direct physical interactions molecular entities.\nmolecular process can carried action single macromolecular machine, usually via direct physical interactions molecular entities.Cellular Components (CC)\nlocation, relative cellular compartments structures, occupied macromolecular machine carries molecular function.\nlocation, relative cellular compartments structures, occupied macromolecular machine carries molecular function.GO terms built directed acyclic graph parent-child relationship.comprehensive introduction GO, may visit: https://advaitabio.com/faq-items/understanding-gene-ontology/ http://geneontology.org/docs/ontology-documentation/","code":""},{"path":"get-gene-sets-1.html","id":"usage","chapter":"7 Get gene sets","heading":"7.2.2 Usage","text":"arguments include:\n- org: organism name\n- ont: choose “bp”, “mf” “cc”result list includes four parts:gene set (formated data frame): two columns contains GO term IDs matched gene IDsgeneset_name (formated data frame): two columns contains GO term IDs matched GO descriptionsorganism: stores org informationtype: stores ont information","code":"\ngs <- getGO(org = \"human\", ont = \"mf\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    280115 obs. of  2 variables:\n##   ..$ mf  : chr [1:280115] \"GO:0000009\" \"GO:0000009\" \"GO:0000010\" \"GO:0000010\" ...\n##   ..$ gene: chr [1:280115] \"PIGV\" \"ALG12\" \"PDSS1\" \"PDSS2\" ...\n##  $ geneset_name:'data.frame':    4878 obs. of  2 variables:\n##   ..$ go_id: chr [1:4878] \"GO:0000009\" \"GO:0000010\" \"GO:0000014\" \"GO:0000016\" ...\n##   ..$ Term : chr [1:4878] \"alpha-1,6-mannosyltransferase activity\" \"trans-hexaprenyltranstransferase activity\" \"single-stranded DNA endodeoxyribonuclease activity\" \"lactase activity\" ...\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"mf\""},{"path":"get-gene-sets-1.html","id":"geneset-kegg","chapter":"7 Get gene sets","heading":"7.3 Get KEGG geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"kegg-intruduction","chapter":"7 Get gene sets","heading":"7.3.1 KEGG intruduction","text":"KEGG short “Kyoto Encyclopedia Genes Genomes,” collection databases dealing genomes, biological pathways, diseases, drugs, chemical substances.pathway maps classified following sections:MetabolismGenetic information processing (transcription, translation, replication repair, etc.)Environmental information processing (membrane transport, signal transduction, etc.)Cellular processes (cell growth, cell death, cell membrane functions, etc.)Organismal systems (immune system, endocrine system, nervous system, etc.)Human diseasesDrug development\nFigure 7.1: KEGG overview. Figure taken https://paintomics.readthedocs.io/en/stable/1_kegg/.\n","code":""},{"path":"get-gene-sets-1.html","id":"usage-1","chapter":"7 Get gene sets","heading":"7.3.2 Usage","text":"arguments include:\n- org: organism name (e.g. “hsa”)\n- category: choose “pathway”,“module”, “enzyme”, “disease” (human ), “drug” (human ) “network” (human )","code":"\ngs <- getKEGG(org = \"hsa\",category = \"pathway\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    35570 obs. of  2 variables:\n##   ..$ id  : chr [1:35570] \"hsa00010\" \"hsa00010\" \"hsa00010\" \"hsa00010\" ...\n##   ..$ gene: chr [1:35570] \"10327\" \"124\" \"125\" \"126\" ...\n##  $ geneset_name:'data.frame':    551 obs. of  2 variables:\n##   ..$ id  : chr [1:551] \"hsa00010\" \"hsa00020\" \"hsa00030\" \"hsa00040\" ...\n##   ..$ name: chr [1:551] \"Glycolysis / Gluconeogenesis\" \"Citrate cycle (TCA cycle)\" \"Pentose phosphate pathway\" \"Pentose and glucuronate interconversions\" ...\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"kegg\""},{"path":"get-gene-sets-1.html","id":"geneset-mesh","chapter":"7 Get gene sets","heading":"7.4 Get MeSH geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"mesh-intruduction","chapter":"7 Get gene sets","heading":"7.4.1 MeSH intruduction","text":"Medical Subject Headings comprehensive controlled vocabulary purpose indexing journal articles books life sciences. serves thesaurus facilitates searching.","code":""},{"path":"get-gene-sets-1.html","id":"usage-2","chapter":"7 Get gene sets","heading":"7.4.2 Usage","text":"arguments include:\n- org: organism name (e.g. “human”)\n- method: Method mapping MeSH ID gene ID. Choose one “gendoo”, “gene2pubmed” “RBBH” (mainly minor species).\n- category: MeSH descriptor categories. details refer : use MeSH-related Packages]","code":"\ngs <- getMesh(org = \"human\", method = \"gendoo\", category = \"A\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    3031273 obs. of  2 variables:\n##   ..$ id  : chr [1:3031273] \"D000001\" \"D000001\" \"D000001\" \"D000001\" ...\n##   ..$ gene: chr [1:3031273] \"100\" \"10016\" \"1003\" \"10076\" ...\n##  $ geneset_name:'data.frame':    30194 obs. of  2 variables:\n##   ..$ id  : chr [1:30194] \"D000001\" \"D000002\" \"D000003\" \"D000004\" ...\n##   ..$ name: chr [1:30194] \"Calcimycin\" \"Temefos\" \"Abattoirs\" \"Abbreviations as Topic\" ...\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"mesh\""},{"path":"get-gene-sets-1.html","id":"geneset-msigdb","chapter":"7 Get gene sets","heading":"7.5 Get MsigDB geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"msigdb-intruduction","chapter":"7 Get gene sets","heading":"7.5.1 MsigDB intruduction","text":"Msigdb categories best GSEA partner 9 major collections several sub-collections 32880 gene sets:H: hallmark gene sets (50 gene sets)C1: positional gene sets (299 gene sets)\nchromosome: chr1 => MT\nchromosome: chr1 => MTC2: curated gene sets (6366 gene sets)\nCGP (chemical genetic perturbations, 3384 gene sets)\nCP (canonical pathways, 2982 gene sets) includes BioCarta, KEGG, PID, Reactome WikiPathways\nCGP (chemical genetic perturbations, 3384 gene sets)CP (canonical pathways, 2982 gene sets) includes BioCarta, KEGG, PID, Reactome WikiPathwaysC3: regulatory target gene sets (3726 gene sets)\nMIR (microRNA targets, 2598 gene sets)\nTFT (transcription factor targets, 1128 gene sets)\nMIR (microRNA targets, 2598 gene sets)TFT (transcription factor targets, 1128 gene sets)C4: computational gene sets (858 gene sets)\nCGN (cancer gene neighborhoods, 427 gene sets)\nCM (cancer modules, 431 gene sets)\nCGN (cancer gene neighborhoods, 427 gene sets)CM (cancer modules, 431 gene sets)C5: ontology gene sets (15473 gene sets) includes BP, CC MFC6: oncogenic signature gene sets (189 gene sets)C7: immunologic signature gene sets (5219 gene sets)\nIMMUNESIGDB (ImmuneSigDB gene sets, 4872 gene sets)\nVAX (vaccine response gene sets, 347 gene sets)\nIMMUNESIGDB (ImmuneSigDB gene sets, 4872 gene sets)VAX (vaccine response gene sets, 347 gene sets)C8: cell type signature gene sets (700 gene sets)","code":""},{"path":"get-gene-sets-1.html","id":"usage-3","chapter":"7 Get gene sets","heading":"7.5.2 Usage","text":"arguments include:\n- org: organism name (e.g. “human”)\n- category: choose “H”, “C1”, “C2-CGP”, “C2-CP-BIOCARTA”, “C2-CP-KEGG”, “C2-CP-PID”,\n“C2-CP-REACTOME”, “C2-CP-WIKIPATHWAYS”, “C3-MIR-MIRDB”,“C3-MIR-MIR_Legacy”, “C3-TFT-GTRD”,\n“C3-TFT-TFT_Legacy”,“C4-CGN”, “C4-CM”, “C5-GO-BP”, “C5-GO-CC”, “C5-GO-MF”,“C5-HPO”, “C6”,\n“C7-IMMUNESIGDB”, “C7-VAX”, “C8”result list includes four parts:gene set (formated data frame): two columns contains pathway IDs matched gene IDsgeneset_name: NA (pathway IDs names , just ignore )organism: stores org informationtype: stores ont information","code":"\ngs <- getMsigdb(org = \"human\", category = \"H\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    8209 obs. of  2 variables:\n##   ..$ gs_name    : chr [1:8209] \"HALLMARK_ADIPOGENESIS\" \"HALLMARK_ADIPOGENESIS\" \"HALLMARK_ADIPOGENESIS\" \"HALLMARK_ADIPOGENESIS\" ...\n##   ..$ entrez_gene: int [1:8209] 19 11194 10449 33 34 35 47 50 51 112 ...\n##  $ geneset_name: logi NA\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"msigdb\""},{"path":"get-gene-sets-1.html","id":"geneset-wikipath","chapter":"7 Get gene sets","heading":"7.6 Get WikiPathways geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"wikipathways-intruduction","chapter":"7 Get gene sets","heading":"7.6.1 WikiPathways intruduction","text":"WikiPathways established facilitate contribution maintenance pathway information biology community. month produces set pathways .gmt files https://wikipathways-data.wmcloud.org/.","code":""},{"path":"get-gene-sets-1.html","id":"usage-4","chapter":"7 Get gene sets","heading":"7.6.2 Usage","text":"need input organism name.","code":"\ngs <- getWiki(org = \"human\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    30871 obs. of  2 variables:\n##   ..$ id  : chr [1:30871] \"WP5187\" \"WP5187\" \"WP5187\" \"WP5187\" ...\n##   ..$ gene: chr [1:30871] \"7098\" \"8792\" \"51284\" \"64135\" ...\n##  $ geneset_name:'data.frame':    746 obs. of  2 variables:\n##   ..$ id  : chr [1:746] \"WP5187\" \"WP5143\" \"WP2916\" \"WP4871\" ...\n##   ..$ name: chr [1:746] \"mRNA vaccine activation of dendritic cell and induction of IFN-1\" \"GDNF signaling\" \"Interactome of polycomb repressive complex 2 (PRC2) \" \"Kisspeptin/kisspeptin receptor system in the ovary\" ...\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"wikipathway\""},{"path":"get-gene-sets-1.html","id":"geneset-reactome","chapter":"7 Get gene sets","heading":"7.7 Get Reactome geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"reactome-intruduction","chapter":"7 Get gene sets","heading":"7.7.1 Reactome intruduction","text":"Reactome free online database biological pathways.","code":""},{"path":"get-gene-sets-1.html","id":"usage-5","chapter":"7 Get gene sets","heading":"7.7.2 Usage","text":"need input organism name.","code":"\ngs <- getReactome(org = \"human\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    125362 obs. of  2 variables:\n##   ..$ id  : chr [1:125362] \"R-HSA-1059683\" \"R-HSA-1059683\" \"R-HSA-1059683\" \"R-HSA-1059683\" ...\n##   ..$ gene: chr [1:125362] \"3569\" \"3570\" \"3572\" \"3716\" ...\n##  $ geneset_name:'data.frame':    2566 obs. of  2 variables:\n##   ..$ id  : chr [1:2566] \"R-HSA-1059683\" \"R-HSA-109581\" \"R-HSA-109582\" \"R-HSA-109606\" ...\n##   ..$ name: chr [1:2566] \"Interleukin-6 signaling\" \"Apoptosis\" \"Hemostasis\" \"Intrinsic Pathway for Apoptosis\" ...\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"reactome\""},{"path":"get-gene-sets-1.html","id":"geneset-enrichr","chapter":"7 Get gene sets","heading":"7.8 Get Enrichr geneset","text":"","code":""},{"path":"get-gene-sets-1.html","id":"enrichr-intruduction","chapter":"7 Get gene sets","heading":"7.8.1 Enrichr intruduction","text":"Enrichr comprehensive resource curated gene sets search engine accumulates biological knowledge biological discoveries.","code":""},{"path":"get-gene-sets-1.html","id":"usage-6","chapter":"7 Get gene sets","heading":"7.8.2 Usage","text":"arguments include:\n- org: organism name (e.g. “human”)\n- library: choose one library name geneset::enrichr_metadata (e.g. “COVID-19_Related_Gene_Sets”)","code":"\ngs <- getEnrichrdb(org = \"human\", library = \"COVID-19_Related_Gene_Sets\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    60289 obs. of  2 variables:\n##   ..$ id  : Factor w/ 205 levels \"COVID19-E protein host PPI from Krogan\",..: 1 1 1 1 1 1 2 2 2 2 ...\n##   ..$ gene: chr [1:60289] \"BRD4\" \"BRD2\" \"SLC44A2\" \"ZC3H18\" ...\n##  $ geneset_name: logi NA\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"enrichrdb\""},{"path":"get-gene-sets-1.html","id":"geneset-hg-disease","chapter":"7 Get gene sets","heading":"7.9 Get Human disease-related geneset","text":"now, suport human disease annotation data : Disease Ontology (), DisGeNET, Network Cancer Gene (NCG) version 6 v7 COVID-19Only need input source name “”, “ncg_v7”, ncg_v6, “disgenet” “covid19”.: Disease Ontology developed standardized ontology human disease purpose providing biomedical community consistent, reusable sustainable descriptions human disease terms.: Disease Ontology developed standardized ontology human disease purpose providing biomedical community consistent, reusable sustainable descriptions human disease terms.ncg_v7 & ncg_v6: Human Network Cancer Gene (NCG) manually curated collection cancer genes, healthy drivers properties.ncg_v7 & ncg_v6: Human Network Cancer Gene (NCG) manually curated collection cancer genes, healthy drivers properties.disgenet: DisGeNET discovery platform containing one largest publicly available collections genes variants associated human diseases.\nDisGeNET integrates data expert curated repositories, GWAS catalogues, animal models scientific literature. DisGeNET data homogeneously annotated controlled vocabularies community-driven ontologies. Additionally, several original metrics provided assist prioritization genotype–phenotype relationships.disgenet: DisGeNET discovery platform containing one largest publicly available collections genes variants associated human diseases.\nDisGeNET integrates data expert curated repositories, GWAS catalogues, animal models scientific literature. DisGeNET data homogeneously annotated controlled vocabularies community-driven ontologies. Additionally, several original metrics provided assist prioritization genotype–phenotype relationships.covid19: COVID-19 Drug Gene Set Library. collection drug gene sets related COVID-19 research contributed community.covid19: COVID-19 Drug Gene Set Library. collection drug gene sets related COVID-19 research contributed community.","code":"\ngs <- getHgDisease(source = \"do\")\nstr(gs)## List of 4\n##  $ geneset     :'data.frame':    387300 obs. of  2 variables:\n##   ..$ id  : chr [1:387300] \"DOID:0001816\" \"DOID:0001816\" \"DOID:0001816\" \"DOID:0001816\" ...\n##   ..$ gene: chr [1:387300] \"238\" \"672\" \"675\" \"387119\" ...\n##  $ geneset_name:'data.frame':    11878 obs. of  2 variables:\n##   ..$ id  : chr [1:11878] \"DOID:0001816\" \"DOID:0002116\" \"DOID:0014667\" \"DOID:0040001\" ...\n##   ..$ name: chr [1:11878] \"Angiosarcoma\" \"Pterygium\" \"Disease of metabolism\" \"Shrimp allergy\" ...\n##  $ organism    : chr \"hsapiens\"\n##  $ type        : chr \"do\""},{"path":"ora-analysis-1.html","id":"ora-analysis-1","chapter":"8 ORA analysis","heading":"8 ORA analysis","text":"paper “Urgent need consistent standards functional enrichment analysis” mentioned, popular functional enrichment tools can classified two main categories: (1) -representation analysis (ORA) (2) functional class scoring (FCS) .Knidly Note: matter method choose, first thing always preparation gene sets.","code":""},{"path":"ora-analysis-1.html","id":"ora-introduction","chapter":"8 ORA analysis","heading":"8.1 ORA method introduction","text":"According paper “-representation correlation analysis (ORCA): method identifying associations variable sets”:-representation analysis (ORA) simple method objectively deciding whether set variables known suspected biological relevance, gene set pathway, prevalent set variables interest expect chance.ORA usually procedures:Identify features, mRNA, proteins microarray probes, considered “differentially expressed” two conditionsDetermine number differentially expressed features pathwayFor pathway, using hypergeometric distribution calculate probability value ( P -value) obtaining number differentially expressed features background list features","code":""},{"path":"ora-analysis-1.html","id":"ora-basic-usage","chapter":"8 ORA analysis","heading":"8.2 Basic usage","text":"simplest arguments :id: gene id Entrez (numeric id also supported), Ensembl, Symbol (alias also accepted) Uniprotgeneset: gene set two-column data frame term id gene id. (’s recommended use geneset)p_cutoff: numeric cutoff pvalue adjusted pvalue, default 0.05.q_cutoff: numeric cutoff qvalue, default 0.15.","code":""},{"path":"ora-analysis-1.html","id":"st-step-prepare-input-ids","chapter":"8 ORA analysis","heading":"8.2.1 1st step: prepare input IDs","text":"show various input ID types, choose Entrez ID, Symbol human Uniprot rat protein example data.","code":"\ndata(geneList, package = \"genekitr\")\nentrez_id <- names(geneList)[abs(geneList) > 2]\nhead(entrez_id, 5)## [1] \"948\"    \"1638\"   \"158471\" \"10610\"  \"6947\"\nsymbol_id <-  c(\"TP53\",\"BRCA1\",\"TET2\") # all official symbols\nmix_symbol_id <-  c(\"BCC7\",\"BRCA1\",\"TET2\") # mixture of official symbol and alias\n\nunip_id <- rat_prodata$Acc[1:100]\nhead(unip_id, 5)## [1] \"P27364\" \"P17475\" \"P14046\" \"P00507\" \"P15650\""},{"path":"ora-analysis-1.html","id":"nd-step-prepare-gene-set","chapter":"8 ORA analysis","heading":"8.2.2 2nd step: prepare gene set","text":"details, please refer chapter7Here prepare GO MF gene set:","code":"\nhg_gs <- geneset::getGO(org = \"human\",ont = \"mf\")\nrat_gs <- geneset::getGO(org = \"rat\",ont = \"mf\")"},{"path":"ora-analysis-1.html","id":"rd-step-ora-analysis","chapter":"8 ORA analysis","heading":"8.2.3 3rd step: ORA analysis","text":"non-symbol genes (e.g. Entrez IDs):symbol genes without alias:symbol genes alias:Uniprot proteins:","code":"\ngo_ent <- genORA(entrez_id, geneset = hg_gs)\nhead(go_ent)##              Hs_MF_ID                                        Description\n## GO:0000217 GO:0000217                    DNA secondary structure binding\n## GO:0005041 GO:0005041 low-density lipoprotein particle receptor activity\n## GO:0030228 GO:0030228             lipoprotein particle receptor activity\n##            GeneRatio  BgRatio       pvalue   p.adjust     qvalue\n## GO:0000217     0.032 36/18543 9.808774e-05 0.02180140 0.01984400\n## GO:0005041     0.024 15/18543 1.282436e-04 0.02180140 0.01984400\n## GO:0030228     0.024 18/18543 2.266171e-04 0.02568327 0.02337734\n##                         geneID         geneID_symbol Count FoldEnrich\n## GO:0000217 4208/641/7516/63967 MEF2C/BLM/XRCC2/CLSPN     4   16.48267\n## GO:0005041      948/53353/3949       CD36/LRP1B/LDLR     3   29.66880\n## GO:0030228      948/53353/3949       CD36/LRP1B/LDLR     3   24.72400\n##            RichFactor\n## GO:0000217  0.1111111\n## GO:0005041  0.2000000\n## GO:0030228  0.1666667\ngo_sym <- genORA(symbol_id, geneset = hg_gs)\nhead(go_sym)##              Hs_MF_ID                                      Description\n## GO:0031625 GO:0031625                 ubiquitin protein ligase binding\n## GO:0044389 GO:0044389            ubiquitin-like protein ligase binding\n## GO:0001094 GO:0001094 TFIID-class transcription factor complex binding\n## GO:0097371 GO:0097371                 MDM2/MDM4 family protein binding\n## GO:0140666 GO:0140666                               annealing activity\n## GO:0035035 GO:0035035                histone acetyltransferase binding\n##            GeneRatio   BgRatio       pvalue   p.adjust      qvalue     geneID\n## GO:0031625 0.6666667 301/18543 0.0007794317 0.01891673 0.004424966 TP53/BRCA1\n## GO:0044389 0.6666667 320/18543 0.0008805032 0.01891673 0.004424966 TP53/BRCA1\n## GO:0001094 0.3333333  10/18543 0.0016170760 0.01891673 0.004424966       TP53\n## GO:0097371 0.3333333  11/18543 0.0017786877 0.01891673 0.004424966       TP53\n## GO:0140666 0.3333333  13/18543 0.0021018587 0.01891673 0.004424966       TP53\n## GO:0035035 0.3333333  23/18543 0.0037166674 0.02362933 0.005527329       TP53\n##            Count FoldEnrich  RichFactor\n## GO:0031625     2   41.06977 0.006644518\n## GO:0044389     2   38.63125 0.006250000\n## GO:0001094     1  618.10000 0.100000000\n## GO:0097371     1  561.90909 0.090909091\n## GO:0140666     1  475.46154 0.076923077\n## GO:0035035     1  268.73913 0.043478261\ngo_sym_mix <- genORA(mix_symbol_id, geneset = hg_gs)\nhead(go_sym_mix)##              Hs_MF_ID                                      Description\n## GO:0031625 GO:0031625                 ubiquitin protein ligase binding\n## GO:0044389 GO:0044389            ubiquitin-like protein ligase binding\n## GO:0001094 GO:0001094 TFIID-class transcription factor complex binding\n## GO:0097371 GO:0097371                 MDM2/MDM4 family protein binding\n## GO:0140666 GO:0140666                               annealing activity\n## GO:0035035 GO:0035035                histone acetyltransferase binding\n##            GeneRatio   BgRatio       pvalue   p.adjust      qvalue     geneID\n## GO:0031625 0.6666667 301/18543 0.0007794317 0.01891673 0.004424966 BCC7/BRCA1\n## GO:0044389 0.6666667 320/18543 0.0008805032 0.01891673 0.004424966 BCC7/BRCA1\n## GO:0001094 0.3333333  10/18543 0.0016170760 0.01891673 0.004424966       BCC7\n## GO:0097371 0.3333333  11/18543 0.0017786877 0.01891673 0.004424966       BCC7\n## GO:0140666 0.3333333  13/18543 0.0021018587 0.01891673 0.004424966       BCC7\n## GO:0035035 0.3333333  23/18543 0.0037166674 0.02362933 0.005527329       BCC7\n##            geneID_symbol Count FoldEnrich  RichFactor\n## GO:0031625    TP53/BRCA1     2   41.06977 0.006644518\n## GO:0044389    TP53/BRCA1     2   38.63125 0.006250000\n## GO:0001094          TP53     1  618.10000 0.100000000\n## GO:0097371          TP53     1  561.90909 0.090909091\n## GO:0140666          TP53     1  475.46154 0.076923077\n## GO:0035035          TP53     1  268.73913 0.043478261\ngo_unip <- genORA(unip_id, geneset = rat_gs)\nhead(go_unip)##              Rn_MF_ID                  Description  GeneRatio   BgRatio\n## GO:0004497 GO:0004497       monooxygenase activity 0.20000000 165/17190\n## GO:0008395 GO:0008395 steroid hydroxylase activity 0.14736842  64/17190\n## GO:0020037 GO:0020037                 heme binding 0.18947368 179/17190\n## GO:0046906 GO:0046906         tetrapyrrole binding 0.18947368 188/17190\n## GO:0005506 GO:0005506             iron ion binding 0.16842105 208/17190\n## GO:0070330 GO:0070330           aromatase activity 0.09473684  41/17190\n##                  pvalue     p.adjust       qvalue\n## GO:0004497 3.836117e-20 1.112474e-17 7.954895e-18\n## GO:0008395 3.494524e-19 5.067060e-17 3.623270e-17\n## GO:0020037 4.824632e-18 4.663811e-16 3.334921e-16\n## GO:0046906 1.172685e-17 8.501966e-16 6.079446e-16\n## GO:0005506 2.813821e-14 1.632016e-12 1.166995e-12\n## GO:0070330 9.884697e-13 4.777603e-11 3.416290e-11\n##                                                                                                                                          geneID\n## GO:0004497 P24483/P17178/P04800/P20816/P18125/P15149/P00176/P13107/P05178/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P11715/P23457\n## GO:0008395                                    P24483/P17178/P04800/P18125/P15149/P00176/P13107/P05179/P08683/P11510/P20814/P10633/P10634/P11715\n## GO:0020037        P04762/P17178/P20816/P18125/P15149/P00176/P13107/P05178/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P11715/P01946\n## GO:0046906        P04762/P17178/P20816/P18125/P15149/P00176/P13107/P05178/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P11715/P01946\n## GO:0005506                      P24483/P17178/P20816/P18125/P15149/P00176/P13107/P05179/P08683/P11510/P20814/P10633/P10634/P11715/P18418/P21816\n## GO:0070330                                                                       P15149/P00176/P13107/P05179/P08683/P11510/P20814/P10633/P10634\n##                                                                                                                                        geneID_symbol\n## GO:0004497 Fdx1/Cyp27a1/Cyp3a1/Cyp4a2/Cyp7a1/Cyp2a2/Cyp2b1/Cyp2b3/Cyp2c6/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Cyp17a1/Akr1c9\n## GO:0008395                                      Fdx1/Cyp27a1/Cyp3a1/Cyp7a1/Cyp2a2/Cyp2b1/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2d1/Cyp2d2/Cyp17a1\n## GO:0020037           Cat/Cyp27a1/Cyp4a2/Cyp7a1/Cyp2a2/Cyp2b1/Cyp2b3/Cyp2c6/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Cyp17a1/Hba1\n## GO:0046906           Cat/Cyp27a1/Cyp4a2/Cyp7a1/Cyp2a2/Cyp2b1/Cyp2b3/Cyp2c6/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Cyp17a1/Hba1\n## GO:0005506                            Fdx1/Cyp27a1/Cyp4a2/Cyp7a1/Cyp2a2/Cyp2b1/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2d1/Cyp2d2/Cyp17a1/Calr/Cdo1\n## GO:0070330                                                                         Cyp2a2/Cyp2b1/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2d1/Cyp2d2\n##            Count FoldEnrich RichFactor\n## GO:0004497    19   20.83636 0.11515152\n## GO:0008395    14   39.58224 0.21875000\n## GO:0020037    18   18.19582 0.10055866\n## GO:0046906    18   17.32475 0.09574468\n## GO:0005506    16   13.91903 0.07692308\n## GO:0070330     9   39.72015 0.21951220"},{"path":"ora-analysis-1.html","id":"some-features","chapter":"8 ORA analysis","heading":"8.2.4 Some features","text":"get conclude features examples :need sepcify input ID type organism. genekitr automatically detect organism name convert ID suitable one.Return data.frame object easy filter exportNon-symbol IDs automatically converted latest gene symbol easily understandIf input symbols mixed aliases, new column “geneID_symbol” added; symbols official, “geneID” column returngenORA() includes five gene-level measurement: “Count”, “BgRatio”,“GeneRatio”, “FoldEnrichment” “RichFactor”.\nBgRatio: Number genes specific term / Number universal genes (specified, genes gene set)\nGeneRatio: Number genes enriched specific term / Number input genes\nFoldEnrichment: GeneRatio / BgRatio\nRichFactor: Number genes enriched specific term / Number genes specific term\nBgRatio: Number genes specific term / Number universal genes (specified, genes gene set)GeneRatio: Number genes enriched specific term / Number input genesFoldEnrichment: GeneRatio / BgRatioRichFactor: Number genes enriched specific term / Number genes specific term","code":""},{"path":"ora-analysis-1.html","id":"ora-advanced-usage","chapter":"8 ORA analysis","heading":"8.3 Advanced usage","text":"","code":""},{"path":"ora-analysis-1.html","id":"ora-additional-arguments","chapter":"8 ORA analysis","heading":"8.3.1 Additional arguments","text":"pAdjustMethod: choose “holm”, “hochberg”, “hommel”, “bonferroni”, “BH”, “”, “fdr”, “none”min_gset_size: Minimal size gene set analysis. Default 10. Pathway less ten genes omitted (e.g. GO:0062196 child term 8-gene bottom directed acyclic graph).max_gset_size: Maximal size. Default 500. pathway 500 genes omitted (e.g. GO:0007049 1796 genes parent nodes top directed acyclic graph).universe: uses background genes, set universe. missing, genes geneset used background universe.","code":""},{"path":"ora-analysis-1.html","id":"ora-group-enrichment","chapter":"8 ORA analysis","heading":"8.3.2 Group enrichment","text":"multi-group comparison (e.g. multiple experimental conditions multiple time points), user specify gene groups group_list argument:example, 100 genes:50/100 genes -regulated 50/100 -regulated40/100 genes detected time point 1 60/100 detected time point 2","code":"\nid_100 <- c(head(names(geneList), 50), tail(names(geneList), 50))\ntwo_groups <- list(\n  exp_group = c(rep(\"up\", 50), rep(\"down\", 50)),\n  time_group = c(rep(\"time1\", 40), rep(\"time2\", 60))\n)\n\ngora <- genORA(id_100, geneset = gs, group_list = two_groups)\nhead(gora)##             ID    Cluster                               Description GeneRatio\n## 1 DOID:0050774 down.time2                       Rapadilino syndrome 0.1020408\n## 2 DOID:0050427 down.time2                     Xeroderma pigmentosum 0.1836735\n## 3 DOID:0060535 down.time2                  Warsaw breakage syndrome 0.1020408\n## 4    DOID:5683 down.time2 Hereditary breast ovarian cancer syndrome 0.1632653\n## 5    DOID:2717 down.time2                            Bloom syndrome 0.1224490\n## 6    DOID:7400 down.time2                Nijmegen breakage syndrome 0.1020408\n##     BgRatio       pvalue     p.adjust       qvalue\n## 1  24/19143 3.649969e-09 2.522129e-06 1.917194e-06\n## 2 281/19143 3.421889e-08 1.182263e-05 8.986961e-06\n## 3  54/19143 2.563977e-07 5.905694e-05 4.489209e-05\n## 4 274/19143 4.315571e-07 7.455149e-05 5.667026e-05\n## 5 137/19143 1.307128e-06 1.806450e-04 1.373172e-04\n## 6 107/19143 7.786564e-06 8.967526e-04 6.816659e-04\n##                                        geneID\n## 1                    641/5888/8318/9156/55388\n## 2 641/5888/595/7516/8318/993/9156/63967/51514\n## 3               113130/157570/5888/8318/63967\n## 4       29128/641/5888/595/7516/9156/374/3690\n## 5              54821/641/5888/7516/9156/63967\n## 6                   157570/641/5888/7516/9156\n##                                       geneID_symbol Count FoldEnrich RichFactor\n## 1                        BLM/RAD51/CDC45/EXO1/MCM10     5   81.39031 0.20833333\n## 2 BLM/RAD51/CCND1/XRCC2/CDC45/CDC25A/EXO1/CLSPN/DTL     9   12.51267 0.03202847\n## 3                     CDCA5/ESCO2/RAD51/CDC45/CLSPN     5   36.17347 0.09259259\n## 4       UHRF1/BLM/RAD51/CCND1/XRCC2/EXO1/AREG/ITGB3     8   11.40652 0.02919708\n## 5                 ERCC6L/BLM/RAD51/XRCC2/EXO1/CLSPN     6   17.10979 0.04379562\n## 6                        ESCO2/BLM/RAD51/XRCC2/EXO1     5   18.25577 0.04672897\ntable(gora$Cluster)## \n## down.time2 \n##         60"},{"path":"ora-analysis-1.html","id":"ora-background","chapter":"8 ORA analysis","heading":"8.3.3 Add background genes","text":"help transId(), background genes different type input IDs.example, input genes symbols background genes Entrez.","code":"\nhead(names(geneList))## [1] \"948\"       \"1638\"      \"158471\"    \"10610\"     \"6947\"      \"100133941\"\ngo_bkg <- genORA(symbol_id, geneset = hg_gs, universe = names(geneList))"},{"path":"ora-analysis-1.html","id":"ora-go-simplify","chapter":"8 ORA analysis","heading":"8.3.4 [GO specific] Simplify GO ORA result","text":"improve GO term simplifying performance, genekitr extracts species-specific GO term information Bioconductor organism-level annotation packages fifteen species, including human, mouse, rat, fly, thale cress, yeast, zebrafish, worm, bovine, pig, chicken, mosquito, dog, frog, chimpanzee.genekitr obtains ancestors GO terms relations GO.dbTo calculate semantic similarity GO BP, CC MF, genekitr utilizes five algorithms (‘Resnik’, ‘Lin’, ‘Jiang’, ‘Rel’ ‘Wang’) GOSemSimLet’s look terms considered redundant:\nFigure 8.1: Term GO:0044389\nfirst record GO:0044389 child term GO:0031625, remain child.","code":"\nsim_go <- simGO(go_sym,sim_method = 'Resnik')\ndim(go_sym);dim(sim_go)## [1] 34 11## [1] 22 11\nhead(go_sym$Hs_MF_ID[!go_sym$Hs_MF_ID%in%sim_go$Hs_MF_ID])## [1] \"GO:0044389\" \"GO:0140666\" \"GO:0001091\" \"GO:0140296\" \"GO:0005507\"\n## [6] \"GO:0001099\""},{"path":"ora-analysis-1.html","id":"ora-tools-comparsion","chapter":"8 ORA analysis","heading":"8.4 Comparison with other tools","text":"","code":""},{"path":"ora-analysis-1.html","id":"genekitrgenora-vs-clusterprofilerenrichgoenrichkeggenrichdo...","chapter":"8 ORA analysis","heading":"8.4.1 genekitr::genORA vs clusterProfiler::enrichGO/enrichKEGG/enrichDO...","text":"function genORA require load orgdb ahead need specify input ID type.Next, take GO analysis example:input IDs mixture official symbols aliases. Also five genes popular biomedical research.check result:clustp_res contains two genes: TET2 BRCA1genekitr_res includes five genes gives mapping aliasesIf look deeper, may find eight terms unique clustp_res, GO:0016571:Question1: terms omited genGO result?get adjusted p value, critical parameter number statistical testing.simple explanation, adj.p = f * p (f>1) f related testing methods number tests. genORA recognizes five genes need testings (example, five testings) enrichGO includes two genes testing number less. directly reduces adj.p enrichGO result remained threshold 0.01., set cutoff higher(e.g. 0.05), genekitr also get terms:Question2: enrichGO recognize two genes?know possible essential genes (“BCC7”, “PD1” “PDL1”) without enriched terms.core reason three genes actually aliases enrichGO sets argument keyType = \"SYMBOL\", cause enrichGO accepts official symbols. function based organism annotation package (e.g. org.Hs.eg.db) accept different types data org.Hs.eg.db:specifying keyType = 'ALIAS', program recognize gene alias, however still distinguish mixture symbol alias.","code":"\ncheck_gene <- c(\"BCC7\", \"PDL1\", \"PD1\", \"TET2\", \"BRCA1\")\n\n# Genekitr\nstart = Sys.time()\ngs <- geneset::getGO(org = \"human\",ont = \"bp\")\ngenekitr_res <- genekitr::genORA(check_gene, gs, p_cutoff = 0.01, q_cutoff = 0.01)\nend = Sys.time()\n(end-start)## Time difference of 7.568743 secs\n# clusterProfiler\nstart = Sys.time()\nrequire(org.Hs.eg.db)\nclustp_res <- clusterProfiler::enrichGO(check_gene,\n                                        OrgDb = \"org.Hs.eg.db\",\n                                        keyType = \"SYMBOL\",\n                                        pvalueCutoff = 0.01,\n                                        qvalueCutoff = 0.01,\n                                        ont = \"BP\")\nend = Sys.time()\n(end-start)## Time difference of 43.37098 secs\nclass(genekitr_res)## [1] \"data.frame\"\nclass(clustp_res)## [1] \"enrichResult\"\n## attr(,\"package\")\n## [1] \"DOSE\"\nisS4(clustp_res)## [1] TRUE\n# we need to convert the S4 to dataframe to view\nclustp_res2 <- as.data.frame(clustp_res)\n\ndim(genekitr_res)## [1] 24 12\ndim(clustp_res2)## [1] 11  9\nhead(genekitr_res,5)##              Hs_BP_ID                                         Description\n## GO:0070234 GO:0070234     positive regulation of T cell apoptotic process\n## GO:0070230 GO:0070230 positive regulation of lymphocyte apoptotic process\n## GO:2000108 GO:2000108  positive regulation of leukocyte apoptotic process\n## GO:0070232 GO:0070232              regulation of T cell apoptotic process\n## GO:0070231 GO:0070231                            T cell apoptotic process\n##            GeneRatio  BgRatio       pvalue     p.adjust       qvalue\n## GO:0070234       0.6 13/18957 2.517291e-09 1.522961e-06 4.107159e-07\n## GO:0070230       0.6 17/18957 5.983272e-09 1.809940e-06 4.881090e-07\n## GO:2000108       0.6 27/18957 2.571649e-08 5.186160e-06 1.398616e-06\n## GO:0070232       0.6 34/18957 5.258194e-08 7.953019e-06 2.144790e-06\n## GO:0070231       0.6 50/18957 1.720087e-07 2.081305e-05 5.612915e-06\n##                   geneID    geneID_symbol Count FoldEnrich RichFactor\n## GO:0070234 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   874.9385 0.23076923\n## GO:0070230 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   669.0706 0.17647059\n## GO:2000108 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   421.2667 0.11111111\n## GO:0070232 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   334.5353 0.08823529\n## GO:0070231 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   227.4840 0.06000000\nhead(clustp_res,5)##                    ID                      Description GeneRatio   BgRatio\n## GO:0051568 GO:0051568        histone H3-K4 methylation       2/2  57/18866\n## GO:0044728 GO:0044728 DNA methylation or demethylation       2/2  98/18866\n## GO:0034968 GO:0034968       histone lysine methylation       2/2 116/18866\n## GO:0006304 GO:0006304                 DNA modification       2/2 120/18866\n## GO:0018022 GO:0018022      peptidyl-lysine methylation       2/2 132/18866\n##                  pvalue    p.adjust       qvalue     geneID Count\n## GO:0051568 8.968633e-06 0.001892382 9.440666e-06 TET2/BRCA1     2\n## GO:0044728 2.670922e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\n## GO:0034968 3.748169e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\n## GO:0006304 4.012283e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\n## GO:0018022 4.858571e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\nclustp_res$ID[!clustp_res$ID%in%genekitr_res$Hs_BP_ID ]## [1] \"GO:0034968\" \"GO:0018022\" \"GO:0016571\" \"GO:0006479\" \"GO:0008213\"\n## [6] \"GO:0043414\" \"GO:0032259\" \"GO:0018205\"\ngenekitr_res2 <- genekitr::genORA(check_gene, gs, p_cutoff = 0.05, q_cutoff = 0.05)\n\ntable(clustp_res$ID%in%genekitr_res2$Hs_BP_ID)## \n## TRUE \n##   11\nlibrary(org.Hs.eg.db)\nAnnotationDbi::columns(org.Hs.eg.db)##  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n##  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n## [11] \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"          \"OMIM\"        \n## [16] \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"         \"PMID\"        \n## [21] \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"       \"UNIGENE\"     \n## [26] \"UNIPROT\""},{"path":"ora-analysis-1.html","id":"gengo-vs-panther-web","chapter":"8 ORA analysis","heading":"8.4.2 genGO vs Panther web","text":"Still using five check genes.Panther recognize “PDL1” “PD1”, well “BCC7” omited.\nFigure 8.2: Panther result\n","code":""},{"path":"functional-class-scoring-1.html","id":"functional-class-scoring-1","chapter":"9 FCS-GSEA analysis","heading":"9 FCS-GSEA analysis","text":"","code":""},{"path":"functional-class-scoring-1.html","id":"fcs-introduction","chapter":"9 FCS-GSEA analysis","heading":"9.1 FCS method introduction","text":"ORA method easy conduct, lose information genes’ differences slight. example, gene essential pathway low-expressed, filtered fold change cutoff.Unlike ORA, FCS tools set threshold differentially expressed genes. Instead, gives detected gene differential expression score evaluates whether scores positive negative expected chance gene set.According article “Ten Years Pathway Analysis: Current Approaches Outstanding Challenges”:FCS approaches include GSEA, GlobalTest, sigPathway, SAFE, GSA, PADOG, PCOT2, FunCluster, SAM-GS, Category etc.Next, go popular Gene Set Enrichment Analysis (GSEA) tool, uses FCS permutation approaches determine whether gene set significantly associated higher lower scores.","code":""},{"path":"functional-class-scoring-1.html","id":"gsea-introduction","chapter":"9 FCS-GSEA analysis","heading":"9.2 GSEA intruduction","text":"GSEA, user must ordered gene rank list (e.g., genes decreasing logFC order).Three steps GSEA:Calculate enrichment score (ES): represents amount genes set -represented either top bottom list. GSEA starts top ranked gene list calculate enrichment score. gene member candidate gene set, adds running sum. Otherwise, subtracts.Calculate enrichment score (ES): represents amount genes set -represented either top bottom list. GSEA starts top ranked gene list calculate enrichment score. gene member candidate gene set, adds running sum. Otherwise, subtracts.Estimate statistical significance ES: calculation done phenotypic-based permutation test order produce null distribution ES.Estimate statistical significance ES: calculation done phenotypic-based permutation test order produce null distribution ES.Adjust multiple hypothesis testing large number gene sets analyzed one time: enrichment scores set normalized, false discovery rate calculated.Adjust multiple hypothesis testing large number gene sets analyzed one time: enrichment scores set normalized, false discovery rate calculated.\nFigure 9.1: GSEA overview\ninterested GSEA detailed procedure, please visit: https://www.pathwaycommons.org/guide/primers/data_analysis/gsea https://github.com/crazyhottommy/RNA-seq-analysis/blob/master/GSEA_explained.md","code":""},{"path":"functional-class-scoring-1.html","id":"gsea-basic-usage","chapter":"9 FCS-GSEA analysis","heading":"9.3 Basic usage","text":"simplest arguments :id: pre-ranked genelist decreasing order (e.g. logFC order/correlation order). Entrez, Ensembl Symbol acceptedgeneset: gene set two-column data frame term id gene id. (’s recommended use geneset)p_cutoff: numeric cutoff pvalue adjusted pvalue, default 0.05.q_cutoff: numeric cutoff qvalue, default 0.15.","code":""},{"path":"functional-class-scoring-1.html","id":"st-step-prepare-pre-ranked-gene-list","chapter":"9 FCS-GSEA analysis","heading":"9.3.1 1st step: prepare pre-ranked gene list","text":"","code":"\ndata(geneList, package = \"genekitr\")\nhead(geneList)##       948      1638    158471     10610      6947 100133941 \n##  5.780170  5.633027  4.683610  3.875120  3.357670  3.322533"},{"path":"functional-class-scoring-1.html","id":"nd-step-prepare-gene-set-1","chapter":"9 FCS-GSEA analysis","heading":"9.3.2 2nd step: prepare gene set","text":"","code":"\ngs <- geneset::getGO(org = \"human\",ont = \"mf\")"},{"path":"functional-class-scoring-1.html","id":"rd-step-gsea-analysis","chapter":"9 FCS-GSEA analysis","heading":"9.3.3 3rd step: GSEA analysis","text":"Now, let’s look result:list mainly including analysis result (gsea_df), input genelist (genelist) input geneset (geneset).gsea_df resultDescription: Gene set nameDescription: Gene set namesetSize: number genes gene-level statistic values. specific, input pathway gene set 58 genes (e.g. HALLMARK_MYC_TARGETS_V2 ), gene list 54 , result show setSize = 54setSize: number genes gene-level statistic values. specific, input pathway gene set 58 genes (e.g. HALLMARK_MYC_TARGETS_V2 ), gene list 54 , result show setSize = 54enrichmentScore: also called ES, Broad GSEA implementation. reflects degree gene set overrepresented top bottom ranked list genes.enrichmentScore: also called ES, Broad GSEA implementation. reflects degree gene set overrepresented top bottom ranked list genes.NES: normalized enrichment score primary statistic examining gene set enrichment results. normalizing enrichment score, GSEA accounts differences gene set size correlations gene sets expression dataset. Therefore, NES can used compare analysis results across gene sets. positive normalized enrichment scores (NES) indicate genes set S mostly represented top list (logFC > 0 -regulated genes).NES: normalized enrichment score primary statistic examining gene set enrichment results. normalizing enrichment score, GSEA accounts differences gene set size correlations gene sets expression dataset. Therefore, NES can used compare analysis results across gene sets. positive normalized enrichment scores (NES) indicate genes set S mostly represented top list (logFC > 0 -regulated genes).rank: position ranked list maximum enrichment score occurred. gene sets achieve maximum enrichment score near top bottom ranked list, rank max either small large.rank: position ranked list maximum enrichment score occurred. gene sets achieve maximum enrichment score near top bottom ranked list, rank max either small large.leading_edge: includes three statistics\ntags: percentage gene hits (positive ES) (negative ES) peak running enrichment score, indicates percentage genes contributing enrichment score.\nlist: percentage genes ranked gene list (positive ES) (negative ES) peak running enrichment score. gives indication list enrichment score attained.\nsignal: gene set entirely within first N positions list, signal strength maximal 100%. gene set spread throughout list, signal strength decreases towards 0%.\ntags: percentage gene hits (positive ES) (negative ES) peak running enrichment score, indicates percentage genes contributing enrichment score.list: percentage genes ranked gene list (positive ES) (negative ES) peak running enrichment score. gives indication list enrichment score attained.signal: gene set entirely within first N positions list, signal strength maximal 100%. gene set spread throughout list, signal strength decreases towards 0%.geneID & geneID_symbol: input symbols mixed aliases, new column “geneID_symbol” added; symbols official, “geneID” column returngeneID & geneID_symbol: input symbols mixed aliases, new column “geneID_symbol” added; symbols official, “geneID” column return","code":"\ngse <- genGSEA(genelist = geneList, geneset = gs)\nclass(gse)## [1] \"list\"\nnames(gse)## [1] \"gsea_df\"  \"genelist\" \"geneset\"  \"exponent\" \"org\"\nhead(gse$genelist)##           ID    logfc\n## 1       CD36 5.780170\n## 2        DCT 5.633027\n## 3     PRUNE2 4.683610\n## 4 ST6GALNAC2 3.875120\n## 5       TCN1 3.357670\n## 6       CD24 3.322533\nhead(gse$geneset)##           mf  gene\n## 1 GO:0000009  PIGV\n## 2 GO:0000009 ALG12\n## 3 GO:0000010 PDSS1\n## 4 GO:0000010 PDSS2\n## 5 GO:0000014 ENDOG\n## 6 GO:0000014 ERCC1\nhead(gse$gsea_df, 5)##              Hs_MF_ID                           Description setSize\n## GO:0140097 GO:0140097     catalytic activity, acting on DNA     207\n## GO:0140098 GO:0140098     catalytic activity, acting on RNA     350\n## GO:0008094 GO:0008094 ATP-dependent activity, acting on DNA      97\n## GO:0016887 GO:0016887               ATP hydrolysis activity     422\n## GO:0004386 GO:0004386                     helicase activity     147\n##            enrichmentScore       NES       pvalue     p.adjust       qvalue\n## GO:0140097      -0.5894504 -2.428361 7.555161e-17 8.884870e-14 7.380200e-14\n## GO:0140098      -0.4747857 -2.065130 4.912469e-14 2.888532e-11 2.399353e-11\n## GO:0008094      -0.6697833 -2.480446 7.069515e-13 2.771250e-10 2.301933e-10\n## GO:0016887      -0.4341955 -1.929356 7.323023e-12 2.152969e-09 1.788359e-09\n## GO:0004386      -0.5805801 -2.284009 1.724354e-11 3.583755e-09 2.976839e-09\n##            rank                   leading_edge\n## GO:0140097 1298  tags=30%, list=7%, signal=28%\n## GO:0140098 2872 tags=38%, list=15%, signal=33%\n## GO:0008094 1172  tags=37%, list=6%, signal=35%\n## GO:0016887 2528 tags=29%, list=14%, signal=26%\n## GO:0004386 1295  tags=31%, list=7%, signal=29%\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         geneID\n## GO:0140097                                                                                                                                                                                                                                                                                                                                                                                                                                                                          3980/348654/1786/1105/10856/1660/7150/63922/5889/10728/57697/7156/27301/7517/10146/5932/56652/3978/54984/5810/5424/54107/8607/5422/2956/7374/11144/7153/5985/4436/8458/2237/5426/64858/5982/1763/5984/10714/1736/5111/55345/4172/84515/8091/83990/4171/4176/5983/10721/79075/55247/4174/4173/79915/4175/8438/54821/5427/641/5888/7516/9156\n## GO:0140098 138428/122665/5435/60625/5976/57472/55278/10623/3396/167227/7015/91801/8731/8846/80745/80119/10557/55695/10556/79828/60528/91893/29883/55661/339175/23517/22907/80746/22894/171568/51163/11128/1653/6832/57505/55308/55794/5437/5511/79066/221078/11102/115708/85463/51010/114049/112479/5438/54512/201626/9836/25885/23016/124454/57062/55798/221830/96764/9533/117246/10799/29063/10940/79039/79731/27292/55280/661/54913/51651/9879/55687/55621/57696/56339/29960/55157/10849/56931/246243/54931/64794/57647/1660/9775/23210/54606/2193/54148/57697/81875/9704/5433/27161/56919/1662/24140/79691/10146/54888/10621/10212/114034/28960/92935/64216/10171/4839/64425/4234/56915/10436/90459/25819/80324/10785/10622/8886/1665/51728/10535/11218/10056/84172/87178/10248/23404/2237/5393/9188/51106/5557/83990/9156\n## GO:0008094                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1105/10856/1660/63922/5889/57697/7517/10146/56652/8607/2956/11144/7153/5985/4436/8458/5982/1763/5984/4172/84515/83990/4171/4176/5983/10721/79075/4174/4173/79915/4175/8438/54821/641/5888/7516\n## GO:0016887                                                                                                                        22880/3327/80119/10131/730211/23347/55661/23517/3313/22907/3308/55636/3799/64222/1653/6832/5704/9126/55308/55794/391634/23400/154664/3312/81570/5700/338322/5706/4643/57062/4292/5981/6782/3320/10694/23195/79039/547/8243/3329/5702/3324/55210/9879/6891/6950/57696/10575/1105/10856/3309/7203/64794/57647/1660/908/9775/22824/63922/54606/57697/9704/56919/1662/3800/23046/2181/10146/10576/10212/2182/10051/56652/1836/10112/10592/3323/51182/490/8607/8886/1665/11218/22948/5985/81930/3835/4436/10808/80179/9188/166378/3832/11004/9928/5982/1763/9585/5984/3833/63979/146909/4172/9493/84515/83990/56992/4171/4176/5983/4174/4173/79915/4175/9319/91607/8438/29028/4998/54821/641/5888\n## GO:0004386                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  9879/57696/1105/10856/64794/57647/1660/9775/63922/54606/57697/9704/56919/1662/10146/10212/56652/8607/8886/1665/11218/5985/8458/9188/5982/1763/5984/55345/4172/84515/83990/4171/4176/5983/10721/79075/4174/4173/4175/3070/91607/8438/54821/641/5888\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      geneID_symbol\n## GO:0140097                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              LIG3/GEN1/DNMT1/CHD1/RUVBL2/DHX9/TOP1/CHTF18/RAD51C/PTGES3/FANCM/TOP3A/APEX2/XRCC3/G3BP1/RBBP8/TWNK/LIG1/PINX1/RAD1/POLD1/POLE3/RUVBL1/POLA1/MSH6/UNG/DMC1/TOP2A/RFC5/MSH2/TTF2/FEN1/POLE/DCLRE1B/RFC2/DNA2/RFC4/POLD3/DKC1/PCNA/ZGRF1/MCM3/MCM8/HMGA2/BRIP1/MCM2/MCM7/RFC3/POLQ/DSCC1/NEIL3/MCM5/MCM4/ATAD5/MCM6/RAD54L/ERCC6L/POLE2/BLM/RAD51/XRCC2/EXO1\n## GO:0140098 PTRH1/RNASE8/POLR2F/DHX35/UPF1/CNOT6/QRSL1/POLR3C/MRPL58/DCP2/TERT/ALKBH8/RNMT/ALKBH1/THUMPD2/PIF1/RPP38/NSUN5/RPP30/METTL8/ELAC2/FDXACB1/CNOT7/DDX27/METTL2A/MTREX/DHX30/TSEN2/DIS3/POLR3H/DBR1/POLR3A/DDX1/SUPV3L1/AARS2/DDX19A/DDX28/POLR2H/PPP1R8/METTL16/NSUN6/RPP14/TRMT61A/ZC3H12C/EXOSC3/BUD23/ERI2/POLR2I/EXOSC4/PDE12/LCMT2/POLR1A/EXOSC7/EARS2/DDX24/METTL2B/POLR1F/TGS1/POLR1C/FTSJ3/RPP40/ZCCHC4/POP1/DDX54/NARS2/DIMT1/CWF19L1/POLR3D/RPP25/PTRH2/DDX46/TRMU/TRMT1/DDX55/METTL3/MRM2/DARS2/POLR1G/DUS3L/RNASEH1/TRMT10C/DDX31/DHX37/DHX9/EIF4A3/JMJD6/DDX56/FARSA/MRPL39/FANCM/ISG20L2/DHX34/POLR2D/AGO2/DHX33/DDX10/FTSJ1/QTRT2/G3BP1/NSUN2/POLR3F/DDX39A/TOE1/DCPS/MARS2/TFB2M/RCL1/NOP2/POLR1E/METTL1/EXOSC5/EMG1/ERI1/NOCT/PUS1/WDR4/POLR3G/DDX18/DHX15/POLR3K/RNASEH2A/DDX20/FARSB/POLR1B/PNPT1/POP7/EXOSC2/FEN1/EXOSC9/DDX21/TFB1M/PRIM1/BRIP1/EXO1\n## GO:0008094                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 CHD1/RUVBL2/DHX9/CHTF18/RAD51C/FANCM/XRCC3/G3BP1/TWNK/RUVBL1/MSH6/DMC1/TOP2A/RFC5/MSH2/TTF2/RFC2/DNA2/RFC4/MCM3/MCM8/BRIP1/MCM2/MCM7/RFC3/POLQ/DSCC1/MCM5/MCM4/ATAD5/MCM6/RAD54L/ERCC6L/BLM/RAD51/XRCC2\n## GO:0016887                                                                                           MORC2/HSP90AB3P/PIF1/TRAP1/HSP90AA5P/SMCHD1/DDX27/MTREX/HSPA9/DHX30/HSPA4/CHD7/KIF5B/TOR3A/DDX1/SUPV3L1/PSMC4/SMC3/DDX19A/DDX28/HSP90AB2P/ATP13A2/ABCA13/HSPA8/CLPB/PSMC1/NLRP10/PSMC6/MYO1E/DDX24/MLH1/RFC1/HSPA13/HSP90AA1/CCT8/MDN1/DDX54/KIF1A/SMC1A/HSPD1/PSMC3/HSP90AA2P/ATAD3A/DDX46/TAP2/TCP1/DDX55/CCT4/CHD1/RUVBL2/HSPA5/CCT3/DDX31/DHX37/DHX9/CCT6A/EIF4A3/HSPA4L/CHTF18/DDX56/FANCM/DHX34/DHX33/DDX10/KIF5C/KIF21B/ACSL3/G3BP1/CCT2/DDX39A/ACSL4/SMC4/TWNK/SLC26A2/KIF20A/SMC2/HSP90AA4P/HSPA14/ATP2B1/RUVBL1/DDX18/DHX15/DDX20/CCT5/RFC5/KIF18A/KIF22/MSH2/HSPH1/MYO19/DDX21/SPATA5/KIF11/KIF2C/KIF14/RFC2/DNA2/KIF20B/RFC4/KIFC1/FIGNL1/KIF18B/MCM3/KIF23/MCM8/BRIP1/KIF15/MCM2/MCM7/RFC3/MCM5/MCM4/ATAD5/MCM6/TRIP13/SLFN11/RAD54L/ATAD2/ORC1/ERCC6L/BLM/RAD51\n## GO:0004386                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      DDX46/DDX55/CHD1/RUVBL2/DDX31/DHX37/DHX9/EIF4A3/CHTF18/DDX56/FANCM/DHX34/DHX33/DDX10/G3BP1/DDX39A/TWNK/RUVBL1/DDX18/DHX15/DDX20/RFC5/TTF2/DDX21/RFC2/DNA2/RFC4/ZGRF1/MCM3/MCM8/BRIP1/MCM2/MCM7/RFC3/POLQ/DSCC1/MCM5/MCM4/MCM6/HELLS/SLFN11/RAD54L/ERCC6L/BLM/RAD51\n##            Count\n## GO:0140097    62\n## GO:0140098   134\n## GO:0008094    36\n## GO:0016887   122\n## GO:0004386    45"},{"path":"functional-class-scoring-1.html","id":"advanced-usage","chapter":"9 FCS-GSEA analysis","heading":"9.4 Advanced usage","text":"","code":""},{"path":"functional-class-scoring-1.html","id":"additional-arguments","chapter":"9 FCS-GSEA analysis","heading":"9.4.1 Additional arguments","text":"Please refer ORA part","code":""},{"path":"functional-class-scoring-1.html","id":"simplify-go-gsea-result","chapter":"9 FCS-GSEA analysis","heading":"9.4.2 Simplify GO GSEA result","text":"Please refer ORA part","code":""},{"path":"functional-class-scoring-1.html","id":"export-gsea-result","chapter":"9 FCS-GSEA analysis","heading":"9.5 Export GSEA result","text":"Genekitr provides easy way export analysis result editing sharing.Multiple data saved different sheets one excel file. Besides, column names automatically formatted bold style.\nFigure 9.2: Export result\n","code":"\ngenekitr::expoSheet(data_list = gse,\n                    data_name = names(gse),\n                    filename = \"gsea_result.xlsx\",\n                    dir = \"./\")"},{"path":"import-external-data-1.html","id":"import-external-data-1","chapter":"10 Import external data","heading":"10 Import external data","text":"","code":""},{"path":"import-external-data-1.html","id":"import-panther","chapter":"10 Import external data","heading":"10.1 Import GO panther","text":"genekitr::importPanther() support importing panther result GeneOntology formatting genORA result.\nFigure 10.1: Import panther result.\nexample, save panther result “analysis.txt” pass importPanther. tidy data calculate fold enrichment rich factor., select interested terms utilize plot functions Chapter 11.example:\nFigure 10.2: Bar plot Panther result.\n","code":"\npanther_res <- importPanther(\"data/analysis.txt\")\nhead(panther_res, 5)##           ID\n## 1 GO:1901295\n## 2 GO:0036520\n## 3 GO:0036304\n## 4 GO:1905066\n## 5 GO:0060844\n##                                                                                      Description\n## 1 regulation of canonical Wnt signaling pathway involved in cardiac muscle cell fate commitment \n## 2                                                       astrocyte-dopaminergic neuron signaling \n## 3                                                                  umbilical cord morphogenesis \n## 4                   regulation of canonical Wnt signaling pathway involved in heart development \n## 5                                                     arterial endothelial cell fate commitment \n##    GeneRatio      BgRatio upload_1 (42) upload_1 (expected)\n## 1 0.04761905 9.713925e-05             2                0.00\n## 2 0.07142857 1.457089e-04             3                0.01\n## 3 0.04761905 9.713925e-05             2                0.00\n## 4 0.04761905 9.713925e-05             2                0.00\n## 5 0.04761905 9.713925e-05             2                0.00\n##   upload_1 (over/under) FoldEnrich   pvalue   qvalue Count   RichFactor\n## 1                     +   490.2143 2.42e-05 9.30e-04     2 9.713925e-05\n## 2                     +   490.2143 1.56e-07 1.06e-05     3 1.457089e-04\n## 3                     +   490.2143 2.42e-05 9.28e-04     2 9.713925e-05\n## 4                     +   490.2143 2.42e-05 9.26e-04     2 9.713925e-05\n## 5                     +   490.2143 2.42e-05 9.23e-04     2 9.713925e-05\nplotEnrich(panther_res[c(50,100,350,580,700),], \n           plot_type = \"bar\",\n           stats_metric = \"qvalue\", \n           term_metric = \"GeneRatio\",\n           main_text_size = 13,\n           legend_text_size = 10\n           )"},{"path":"import-external-data-1.html","id":"import-clusterProfiler","chapter":"10 Import external data","heading":"10.2 Import clusterProfiler object","text":"clusterProfiler popular R package enrichment analysis. However, requires user programming skills operate S4 object, may cause inconvenience data cleaning visualization., genekitr::importCP() easily import S4 object additional attributes (e.g. FoldEnrich, RichFactor) help users communicate data fluently.","code":""},{"path":"import-external-data-1.html","id":"clusterprofiler-ora-go-result","chapter":"10 Import external data","heading":"10.2.1 clusterProfiler ORA-GO result","text":"select interested terms utilize plot functions Chapter 11.example:\nFigure 10.3: Chord plot clusterProfiler result.\n","code":"\n## example data\nlibrary(clusterProfiler)\nlibrary(org.Hs.eg.db)\ndata(geneList, package=\"DOSE\")\ngene <- names(geneList)[abs(geneList) > 2]\n\n## GO result from clusterProfiler\ngo <- enrichGO(gene          = gene,\n                OrgDb         = org.Hs.eg.db,\n                ont           = \"BP\",\n                pAdjustMethod = \"BH\",\n                pvalueCutoff  = 0.01,\n                qvalueCutoff  = 0.05)\n\nisS4(go) # return a S4 object## [1] TRUE\n## import \ngo_easy <- importCP(go, type = \"go\")\nis.data.frame(go_easy)## [1] TRUE\n# keep the same as the original result\nidentical(as.data.frame(go)[,1], go_easy[,1])## [1] TRUE\nhead(go_easy)##              hs_BP_ID                          Description GeneRatio   BgRatio\n## GO:0140014 GO:0140014             mitotic nuclear division 0.1752577 286/18866\n## GO:0000280 GO:0000280                     nuclear division 0.1855670 428/18866\n## GO:0048285 GO:0048285                    organelle fission 0.1907216 476/18866\n## GO:0000070 GO:0000070 mitotic sister chromatid segregation 0.1237113 161/18866\n## GO:0000819 GO:0000819         sister chromatid segregation 0.1288660 196/18866\n## GO:0007059 GO:0007059               chromosome segregation 0.1494845 334/18866\n##                  pvalue     p.adjust       qvalue\n## GO:0140014 2.171838e-26 6.700119e-23 5.710790e-23\n## GO:0000280 1.099719e-22 1.696316e-19 1.445841e-19\n## GO:0048285 4.058841e-22 4.173841e-19 3.557538e-19\n## GO:0000070 3.322345e-21 2.562358e-18 2.184005e-18\n## GO:0000819 2.422383e-20 1.494610e-17 1.273918e-17\n## GO:0007059 9.308954e-19 4.786354e-16 4.079608e-16\n##                                                                                                                                                                                                         geneID\n## GO:0140014                  55143/991/9493/1062/4605/9133/10403/23397/9787/11065/51203/22974/10460/4751/27338/983/4085/81930/81620/332/3832/7272/64151/9212/1111/9319/9055/3833/146909/6790/891/24137/9232/652\n## GO:0000280      55143/991/9493/1062/4605/9133/10403/7153/23397/259266/9787/11065/51203/22974/10460/4751/27338/983/4085/81930/81620/332/3832/7272/64151/9212/1111/9319/9055/3833/146909/6790/891/24137/9232/652\n## GO:0048285 55143/991/9493/1062/4605/9133/10403/7153/23397/259266/9787/11065/51203/22974/10460/4751/27338/983/4085/81930/81620/332/3832/7272/64151/9212/1111/9319/9055/3833/146909/6790/891/24137/9232/652/4137\n## GO:0000070                                                                   55143/991/9493/1062/10403/23397/9787/11065/51203/10460/4751/4085/81930/81620/7272/64151/9212/9319/9055/3833/146909/891/24137/9232\n## GO:0000819                                                              55143/991/9493/1062/10403/7153/23397/9787/11065/51203/10460/4751/4085/81930/81620/7272/64151/9212/9319/9055/3833/146909/891/24137/9232\n## GO:0007059                                       55143/991/9493/1062/10403/7153/23397/9787/11065/55355/220134/51203/10460/4751/55839/4085/81930/81620/332/7272/64151/9212/9319/9055/3833/146909/891/24137/9232\n##                                                                                                                                                                                                                        geneID_symbol\n## GO:0140014                 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/NCAPH/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4\n## GO:0000280      CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/ASPM/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4\n## GO:0048285 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/ASPM/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4/MAPT\n## GO:0000070                                                                          CDCA8/CDC20/KIF23/CENPE/NDC80/NCAPH/DLGAP5/UBE2C/NUSAP1/TACC3/NEK2/MAD2L1/KIF18A/CDT1/TTK/NCAPG/AURKB/TRIP13/PRC1/KIFC1/KIF18B/CCNB1/KIF4A/PTTG1\n## GO:0000819                                                                    CDCA8/CDC20/KIF23/CENPE/NDC80/TOP2A/NCAPH/DLGAP5/UBE2C/NUSAP1/TACC3/NEK2/MAD2L1/KIF18A/CDT1/TTK/NCAPG/AURKB/TRIP13/PRC1/KIFC1/KIF18B/CCNB1/KIF4A/PTTG1\n## GO:0007059                                             CDCA8/CDC20/KIF23/CENPE/NDC80/TOP2A/NCAPH/DLGAP5/UBE2C/HJURP/SKA1/NUSAP1/TACC3/NEK2/CENPN/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/TRIP13/PRC1/KIFC1/KIF18B/CCNB1/KIF4A/PTTG1\n##            Count FoldEnrich RichFactor\n## GO:0140014    34  11.560882 0.11888112\n## GO:0000280    36   8.179690 0.08411215\n## GO:0048285    37   7.559148 0.07773109\n## GO:0000070    24  14.496510 0.14906832\n## GO:0000819    25  12.404008 0.12755102\n## GO:0007059    29   8.443638 0.08682635\nplotEnrich(tail(go_easy,20), \n           plot_type = \"genechord\", \n           show_gene = c(\"UBE2C\", \"CDC20\", \"NDC80\"),\n           main_text_size = 10,\n           legend_text_size = 10\n           )"},{"path":"import-external-data-1.html","id":"clusterprofiler-gsea-result","chapter":"10 Import external data","heading":"10.2.2 clusterProfiler GSEA result","text":"select interested terms utilize plot functions Chapter 12.example:\nFigure 10.4: Two-side bar plot clusterProfiler result.\nIDs plot actually ID column kk_easy result. want add content, just modify ID column:\nFigure 10.5: Two-side bar plot modifying labels.\n","code":"\ndata(geneList, package=\"DOSE\")\n## GSEA result from clusterProfiler\nkk <- gseKEGG(geneList     = geneList,\n               organism     = 'hsa',\n               minGSSize    = 120,\n               pvalueCutoff = 0.05,\n               verbose      = FALSE)\n\n## import\nkk_easy <- importCP(kk,type = 'gsea')\nidentical(kk@result[,1], kk_easy$gsea_df[,1])## [1] TRUE\nplotGSEA(kk_easy, plot_type = \"bar\",\n         main_text_size = 15)\nkk_easy$gsea_df$ID <- paste(kk_easy$gsea_df$ID, kk_easy$gsea_df$Description,sep = \": \")\nplotGSEA(kk_easy, plot_type = \"bar\",\n         main_text_size = 15)"},{"path":"import-external-data-1.html","id":"clusterprofiler-keggdosewikipathways-result","chapter":"10 Import external data","heading":"10.2.3 clusterProfiler KEGG/DOSE/WikiPathways… result","text":"clusterProfiler supports many gene sets, including Disease Ontology (), WikiPathways, ReactomePATake example:select interested terms utilize plot functions Chapter 11.example:\nFigure 10.6: Heatmap clusterProfiler result.\n","code":"\nlibrary(DOSE)\ndata(geneList)\ngene <- names(geneList)[abs(geneList) > 1.5]\n\n## ORA-DO result from clusterProfiler\ndo <- enrichDO(gene          = gene,\n              ont           = \"DO\",\n              pvalueCutoff  = 0.05,\n              pAdjustMethod = \"BH\",\n              universe      = names(geneList),\n              minGSSize     = 5,\n              maxGSSize     = 500,\n              qvalueCutoff  = 0.05)\n\n# import\ndo_easy <- importCP(do,type = 'other')\nidentical(as.data.frame(do)[,1], do_easy[,1])## [1] TRUE\nplotEnrich(do_easy, \n           plot_type = \"geneheat\",\n           fold_change = geneList,\n           show_gene = c('S100A9','AGTR1','BIRC5','MMP1','CXCL10'))"},{"path":"plot-ora-1.html","id":"plot-ora-1","chapter":"11 Plot ORA","heading":"11 Plot ORA","text":"selecting interested terms pathways genORA genGSEA result, user pass data frame plotEnrich, includes many ready-made plot types, including barplot, dotplot, heatmap, wego-like plot, chord plot, network, wordcloud etc.worth mentioning almost plots based ggplot2 plot_theme function easily change border, legend, label etc., helps user make plot.","code":""},{"path":"plot-ora-1.html","id":"get-ora-result","chapter":"11 Plot ORA","heading":"11.1 Get ORA result","text":"details, please refer chapter8","code":"\n# 1st step: prepare input IDs\ndata(geneList, package = \"genekitr\")\nentrez_id <- names(geneList)[abs(geneList) > 2]\nhead(entrez_id, 5)## [1] \"948\"    \"1638\"   \"158471\" \"10610\"  \"6947\"\n# 2nd step: prepare gene set\nhg_gs <- geneset::getGO(org = \"human\",ont = \"bp\")\n\n# 3rd step: ORA analysis\nego <- genORA(entrez_id, geneset = hg_gs, p_cutoff = 0.01, q_cutoff = 0.01)\n# next we only show ten sample terms \nego <- ego[1:10, ]\nhead(ego)##              Hs_BP_ID\n## GO:0050673 GO:0050673\n## GO:0071900 GO:0071900\n## GO:0050678 GO:0050678\n## GO:0010165 GO:0010165\n## GO:0043405 GO:0043405\n## GO:1901992 GO:1901992\n##                                                           Description GeneRatio\n## GO:0050673                              epithelial cell proliferation     0.128\n## GO:0071900     regulation of protein serine/threonine kinase activity     0.112\n## GO:0050678                regulation of epithelial cell proliferation     0.104\n## GO:0010165                                          response to X-ray     0.040\n## GO:0043405                          regulation of MAP kinase activity     0.072\n## GO:1901992 positive regulation of mitotic cell cycle phase transition     0.056\n##              BgRatio       pvalue     p.adjust       qvalue\n## GO:0050673 443/18957 3.656558e-08 0.0001006285 7.736508e-05\n## GO:0071900 372/18957 1.680273e-07 0.0002312055 1.777552e-04\n## GO:0050678 382/18957 1.471777e-06 0.0013501101 1.037990e-03\n## GO:0010165  32/18957 2.008272e-06 0.0013816909 1.062270e-03\n## GO:0043405 183/18957 3.495297e-06 0.0019238117 1.479063e-03\n## GO:1901992 100/18957 4.408629e-06 0.0020220911 1.554622e-03\n##                                                                                        geneID\n## GO:0050673 5176/26471/3488/6591/8549/3725/6657/4208/407007/6422/29128/595/7039/374/3690/10468\n## GO:0071900        100133941/8654/5027/10125/6422/641/595/7039/7099/993/9134/57214/81848/10253\n## GO:0050678                 5176/26471/6591/3725/6657/4208/407007/6422/29128/595/7039/374/3690\n## GO:0010165                                                             6422/641/5888/595/7516\n## GO:0043405                               100133941/8654/5027/10125/6422/7039/7099/81848/10253\n## GO:1901992                                            407007/113130/6241/595/407006/993/51514\n##                                                                                           geneID_symbol\n## GO:0050673 SERPINF1/NUPR1/IGFBP5/SNAI2/LGR5/JUN/SOX2/MEF2C/MIR222/SFRP1/UHRF1/CCND1/TGFA/AREG/ITGB3/FST\n## GO:0071900            CD24/PDE5A/P2RX7/RASGRP1/SFRP1/BLM/CCND1/TGFA/TLR4/CDC25A/CCNE2/CEMIP/SPRY4/SPRY2\n## GO:0050678                 SERPINF1/NUPR1/SNAI2/JUN/SOX2/MEF2C/MIR222/SFRP1/UHRF1/CCND1/TGFA/AREG/ITGB3\n## GO:0010165                                                                  SFRP1/BLM/RAD51/CCND1/XRCC2\n## GO:0043405                                         CD24/PDE5A/P2RX7/RASGRP1/SFRP1/TGFA/TLR4/SPRY4/SPRY2\n## GO:1901992                                                    MIR222/CDCA5/RRM2/CCND1/MIR221/CDC25A/DTL\n##            Count FoldEnrich RichFactor\n## GO:0050673    16   5.477418 0.03611738\n## GO:0071900    14   5.707484 0.03763441\n## GO:0050678    13   5.161068 0.03403141\n## GO:0010165     5  23.696250 0.15625000\n## GO:0043405     9   7.458492 0.04918033\n## GO:1901992     7  10.615920 0.07000000"},{"path":"plot-ora-1.html","id":"bar-plot","chapter":"11 Plot ORA","heading":"11.2 Bar Plot","text":"Bar plot simplest way show enriched terms. x-axis enrichment metric (e.g. Gene ratio; Fold enrichment); y-axis selected terms. bar color represents statistical value.’s difference pvalue p.adjust?\np.adjust seven adjustment methods: https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust.\nadjusted p-value always p-value, multiplied factor: adj.p = f * p actual size factor f depends strategy used correct multiple testing.\nway, “q-value” stands “false discovery rate (FDR)” method.basic arguments :term_metric: x-axis “Count”, “GeneRatio”, “FoldEnrich” “RichFactor”stats_metric: Statistic value “p.adjust”, “pvalue” “qvalue”up_color: Color stronger statistic value (e.g. pvalue 0.01)down_color: Color weaker statistic value (e.g. pvalue 1)wrap_length: Wrap term text longer number\nFigure 11.1: Bar plot enrichment analysis. default (), modify metrics (B), modify color (C) modify term length (D).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"bar\")\np2 <- plotEnrich(ego, plot_type = \"bar\", term_metric = \"GeneRatio\", stats_metric = \"pvalue\")\np3 <- plotEnrich(ego, plot_type = \"bar\", up_color = \"#E69056\", down_color = \"#325CAC\")\np4 <- plotEnrich(ego, plot_type = \"bar\", wrap_length = 25)\np1 + p2 + p3 + p4 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"bubble-plot","chapter":"11 Plot ORA","heading":"11.3 Bubble Plot","text":"Enriched gene sets shown bubbles different sizes.x-axis statistic value y-axis “Fold Enrichment”.basic arguments :stats_metric: Statistic value “p.adjust”, “pvalue” “qvalue”scale_ratio: Change bubble size. Default 1.\nFigure 11.2: Bubble plot enrichment analysis. default (), modify bubble size (B).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"bubble\")\np2 <- plotEnrich(ego, plot_type = \"bubble\", \n                 scale_ratio = 0.5, stats_metric = \"qvalue\")\np1 / p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"dot-plot","chapter":"11 Plot ORA","heading":"11.4 Dot Plot","text":"Similar bar plot, dot plot also widely used enrichment analysis plotting. Like bubble plot, dot size represents gene number enriched term.\nFigure 11.3: Dot plot enrichment analysis. default (), modify bubble size (B).\nanalyzing group enrichment analysis ORA, use dotplot show result:\nFigure 11.4: Dot plot group enrichment analysis. number round brackets shows total gene number selected pathways\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"dot\")\np2 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  scale_ratio = 1.5,\n  stats_metric = \"pvalue\",\n  term_metric = \"RichFactor\"\n)\np1 + p2 + plot_annotation(tag_levels = \"A\")\nplotEnrich(gego2,\n           plot_type = 'dot',\n           scale_ratio = 2, # dot size\n           main_text_size = 10,\n           legend_text_size =8,\n           n_term = 6) # show terms"},{"path":"plot-ora-1.html","id":"lollipop-plot","chapter":"11 Plot ORA","heading":"11.5 Lollipop Plot","text":"Lollipop like combination barplot dotplot\nFigure 11.5: Lollipop plot enrichment analysis. defult (), selected genes (B)\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"lollipop\")\np2 <- plotEnrich(ego,\n  plot_type = \"lollipop\",\n  scale_ratio = 1.2,\n  stats_metric = \"pvalue\",\n  term_metric = \"RichFactor\",\n  up_color = \"#a32a31\",\n  down_color = \"#f7dcca\"\n)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"heatmap-plot","chapter":"11 Plot ORA","heading":"11.6 Heatmap Plot","text":"Heatmap plot shows interactions enriched terms genes.\nfold change given, heatmap add color -regulated genes.\nFigure 11.6: Heatmap plot enrichment analysis. genes (, default), selected genes (B), selected genes logFC value (C).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"geneheat\")\nshow_gene = c('JUN','SOX2','CD24','TLR4')\np2 <- plotEnrich(ego, plot_type = \"geneheat\", show_gene = show_gene)\np3 <- plotEnrich(ego, plot_type = \"geneheat\", show_gene = show_gene, fold_change = logfc)\np1 / p2 / p3 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"chord-plot","chapter":"11 Plot ORA","heading":"11.7 Chord Plot","text":"Inspired GOplot, chord plot reproduced using ggplot2 shows similar content heatmap plot.gene_space: space gene labels chord.\nFigure 11.7: Heatmap plot enrichment analysis. selected genes (), selected genes logFC value (B).\n","code":"\nlibrary(patchwork)\nshow_gene = c('JUN','SOX2','CD24','TLR4')\np1 <- plotEnrich(ego, plot_type = \"genechord\", \n                 show_gene = show_gene) +\n  ggplot2::theme(legend.position = \"none\")\np2 <- plotEnrich(ego, plot_type = \"genechord\", \n                 show_gene = show_gene, \n                 fold_change = logfc,\n                 gene_space = 0.5)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"wordcloud-plot","chapter":"11 Plot ORA","heading":"11.8 Wordcloud Plot","text":"Wordcloud plot shows term emphasis based text frequency.\nFigure 11.8: Wordcloud plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"wordcloud\")"},{"path":"plot-ora-1.html","id":"upset-plot","chapter":"11 Plot ORA","heading":"11.9 Upset Plot","text":"Inspired ComplexUpset, upset plot shows association genes enriched terms. Unlike common Venn diagram, emphasize complex relationship among many gene sets.\nFigure 11.9: Upset plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"upset\",main_text_size = 15,legend_text_size = 8)"},{"path":"plot-ora-1.html","id":"network-plot","chapter":"11 Plot ORA","heading":"11.10 Network Plot","text":"Inspired enrichplot::emapplot, genekitr reproduced plot enhance modification.\nEnriched terms nodes network, overlapping gene sets edges. Terms overlapped genes tend cluster together edge thicker.GO analysis result use five methods calculate similarity nodes: “Resnik”, “Lin”, “Rel”, “Jiang”, “Wang” “JC”(Jaccard’s similarity index) methods.KEGG supports “JC” method.User define layout argument derived ggraph, including “nicely” (default), “circle”, “dh”, “drl”, “fr”, “graphopt”, “grid”,“lgl”, “kk”, “mds”, “randomly”, “star” etc.information layout, refer : “Introduction ggraph: Layouts”\nFigure 11.10: Network plot enrichment analysis. JC method nicely layout(, default), circle layout (B), grid layout Want method (C).\n","code":"\nlibrary(patchwork)\nlibrary(igraph)\nlibrary(ggraph)\np1 <- plotEnrich(ego, plot_type = \"network\", scale_ratio = 0.5)\np2 <- plotEnrich(ego, plot_type = \"network\", \n                 layout = \"circle\", scale_ratio = 0.5)\np3 <- plotEnrich(ego, plot_type = \"network\", \n                 layout = \"grid\", sim_method = \"Wang\",\n                 up_color = \"#a32a31\", down_color = \"#f7dcca\")\n(p1 + p2) / p3 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"go-specific-wego-plot","chapter":"11 Plot ORA","heading":"11.11 GO-specific: WEGO Plot","text":"visulize one ontology GO one plot, user utilize wego plotInspired WEGO, genekitr utilized ggplot2 reproduce plot.generate two ontologies (MF CC) result.NOTICE: plotEnrich parameter n_term WEGO plot, specify number terms. want plot terms, just set n_term higher.\nFigure 11.11: WEGO plot enrichment analysis.\n","code":"\n# 1st step: prepare input IDs\ndata(geneList, package = \"genekitr\")\nid <- names(geneList)[abs(geneList) > 2]\n\n# 2nd step: prepare CC and MF gene sets\ngo_cc <- geneset::getGO(org = \"human\",ont = \"cc\")\ngo_mf <- geneset::getGO(org = \"human\",ont = \"mf\")\n\n# 3rd step: analysis\nego_cc <- genORA(id, geneset = go_cc)\nego_mf <- genORA(id, geneset = go_mf)\n\n# 4th step: merge two data frames\n# Note: each data frame should add new column \"Ontology\"\nego_cc <- ego_cc %>% dplyr::mutate(Ontology = \"cc\") %>% dplyr::rename(ID = 1)\nego_mf <- ego_mf %>% dplyr::mutate(Ontology = \"mf\") %>% dplyr::rename(ID = 1)\nall_ego <- rbind(ego_cc,ego_mf)\nplotEnrich(all_ego, plot_type = \"wego\", n_term = 5)"},{"path":"plot-ora-1.html","id":"go-specific-map-plot","chapter":"11 Plot ORA","heading":"11.12 GO-specific: Map Plot","text":"GO terms built directed acyclic graph parent-child relationship.\nmap plot utilized GOSemSim extract parent child terms, also utilized ggraph igraph draw default layout “sugiyama”.avoid much unrelated terms messed , genekitr shows closest parent child selected terms. Besides, top three parent term edges plotted.\nFigure 11.12: Map plot enrichment analysis.\n","code":"\nlibrary(igraph)\nlibrary(ggraph)\nplotEnrich(ego, plot_type = \"gomap\", wrap_length = 25,\n           up_color = '#a32a31',down_color = '#3665a6')"},{"path":"plot-ora-1.html","id":"go-specific-terms-heatmap-plot","chapter":"11 Plot ORA","heading":"11.13 GO-specific: Terms Heatmap Plot","text":"Inspired rrvgo, genekitr scratches main codes cluster GO terms. Also use five methods calculate similarity terms.\nFigure 11.13: GO heatmap plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"goheat\", sim_method = \"Rel\")"},{"path":"plot-ora-1.html","id":"go-specific-terms-tangram-plot","chapter":"11 Plot ORA","heading":"11.14 GO-specific: Terms Tangram Plot","text":"According rrvgo vignettes, tangram plot space-filling visualization hierarchical structures. terms grouped colored based parent, space used term proportional score.\nFigure 11.14: GO tangram plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"gotangram\", sim_method = \"Rel\")"},{"path":"plot-ora-1.html","id":"plot-theme","chapter":"11 Plot ORA","heading":"11.15 Plot Theme","text":"Genekitr provides function plot_theme() modify plots theme including text size, border, legend, color, etc.\nFigure 11.15: Plot theme. default theme (), modify text size (B), modify grid line border size (C) remove text legend (D).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"dot\")\np2 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  main_text_size = 10,\n  legend_text_size = 10\n)\n\np3 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  border_thick = 3,\n  remove_grid = F\n)\n\np4 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  remove_main_text = T,\n  remove_legend_text = T,\n  remove_legend = T\n)\np1 + p2 + p3 + p4 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-ora-1.html","id":"advanced-plot","chapter":"11 Plot ORA","heading":"11.16 Advanced Plot","text":"","code":""},{"path":"plot-ora-1.html","id":"two-group-barplot-for-updown-regulated-pathways","chapter":"11 Plot ORA","heading":"11.16.1 Two-group barplot for up/down regulated pathways","text":"regulated genes pass genORA separately visualize together two-group barplot.take GO result example:two visulization types:plot_type = \"one\": -regulated pathways plotted togetherplot_type = \"two\": -regulated pathways plotted separately. Recommended number groups similar.\nFigure 11.16: Visualize two groups together plot_type = \"one\".\n\nFigure 11.17: Visualize two groups seperately plot_type = \"two\".\n","code":"\n# 1st step: prepare input IDs\n# Since the geneList is logFC decreasing ordered, we could take first 100 as up-regulated genes and vice versa.\ndata(geneList, package = \"genekitr\")\nup_genes <- head(names(geneList), 100)\ndown_genes <- tail(names(geneList), 100)\n\n# 2nd step: prepare gene set\nhg_gs <- geneset::getGO(org = \"human\",ont = \"bp\")\n\n# 3rd step: ORA analysis separately\nup_go <- genORA(up_genes, geneset = hg_gs)\ndown_go <- genORA(down_genes, geneset = hg_gs)\n\ndim(up_go)## [1] 50 12\ndim(down_go)## [1] 253  12\n# here we only take 10 terms of each\nup_go <- head(up_go, 10)\ndown_go <- head(down_go, 10)\nplotEnrichAdv(up_go, down_go,\n              plot_type = \"one\",\n              term_metric = \"FoldEnrich\",\n              stats_metric = \"p.adjust\",\n              xlim_left = 25, xlim_right = 15) +\n  theme(legend.position = c(0.15, 0.9))\nplotEnrichAdv(up_go, down_go,\n              plot_type = \"two\",\n              term_metric = \"FoldEnrich\",\n              stats_metric = \"qvalue\"\n)"},{"path":"plot-gsea-1.html","id":"plot-gsea-1","chapter":"12 Plot FCS-GSEA","heading":"12 Plot FCS-GSEA","text":"GSEA analysis returns list result, two ways visulization:Directly pass list plotGSEA enables 5 types (classic pathway plot, volcano plot, multi-pathway plot, ridge plot two-side bar plot).Directly pass list plotGSEA enables 5 types (classic pathway plot, volcano plot, multi-pathway plot, ridge plot two-side bar plot).Extract analysis result (e.g. gse_list$gsea_df) pass plotEnrich, enables 8 types (geneheat, genechord, wordcloud, upset, network, gomap, goheat, gotangram).Extract analysis result (e.g. gse_list$gsea_df) pass plotEnrich, enables 8 types (geneheat, genechord, wordcloud, upset, network, gomap, goheat, gotangram).","code":""},{"path":"plot-gsea-1.html","id":"get-gsea-result","chapter":"12 Plot FCS-GSEA","heading":"12.1 Get GSEA result","text":"details, please refer chapter9","code":"\n# 1st step: prepare pre-ranked gene list\ndata(geneList, package = \"genekitr\")\nhead(geneList)##       948      1638    158471     10610      6947 100133941 \n##  5.780170  5.633027  4.683610  3.875120  3.357670  3.322533\n# 2nd step: prepare gene set\ngs <- geneset::getMsigdb(org = \"human\",category = 'H')\n\n# 3rd step: GSEA analysis\ngse <- genGSEA(genelist = geneList, geneset = gs)"},{"path":"plot-gsea-1.html","id":"classic-pathway-plot","chapter":"12 Plot FCS-GSEA","heading":"12.2 Classic Pathway Plot","text":"Running enrichment score gene set drawn classic pathway plot lines. function walks ranked gene list. vertical lines middle show location gene set members.user wants show specific pathways genes, just pass according parameters:\n- show_pathway: IDs GSEA result\n- show_gene: IDs GSEA result\nFigure 12.1: Classic pathway plot GSEA.\n","code":"\npathways <- c(\"HALLMARK_P53_PATHWAY\", \"HALLMARK_GLYCOLYSIS\", \"HALLMARK_DNA_REPAIR\")\ngenes <- c(\"MET\", \"TP53\", \"PMM2\")\nplotGSEA(gse, plot_type = \"classic\", show_pathway = pathways, show_gene = genes)"},{"path":"plot-gsea-1.html","id":"volcano-pathway-plot","chapter":"12 Plot FCS-GSEA","heading":"12.3 Volcano Pathway Plot","text":"plot, degree enrichment indicated normalized enrichment score NES.Slightly different DEG volcano plot, x-axis represented NES, corrects enrichment score differences among gene-sets.significant positive NES value indicates members gene set tend appear top ranked data (e.g. fold change DEG) significant negative NES indicates opposite.Default shows top(N) pathways. user wants show specific pathway, also pass argument show_pathway.\nFigure 12.2: Volcano pathway plot GSEA. default (), select pathways (B).\n","code":"\nlibrary(patchwork)\npathways <- c(\"HALLMARK_P53_PATHWAY\", \"HALLMARK_GLYCOLYSIS\", \"HALLMARK_DNA_REPAIR\")\np1 <- plotGSEA(gse, plot_type = \"volcano\", show_pathway = 3)\np2 <- plotGSEA(gse, plot_type = \"volcano\", show_pathway = pathways)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-gsea-1.html","id":"multi-pathway-plot","chapter":"12 Plot FCS-GSEA","heading":"12.4 Multi-pathway Plot","text":"user wants show bunch selected pathways, plotGSEA scratched codes fgsea.Default shows top(N) pathways. user wants show specific pathway, also pass argument show_pathway.\nFigure 12.3: Multi-pathway plot GSEA. default (), select pathways (B).\n","code":"\nlibrary(patchwork)\npathways <- c(\"HALLMARK_P53_PATHWAY\", \"HALLMARK_GLYCOLYSIS\", \"HALLMARK_DNA_REPAIR\")\np1 <- plotGSEA(gse, plot_type = \"fgsea\", show_pathway = 5)\np2 <- plotGSEA(gse, plot_type = \"fgsea\", show_pathway = pathways)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-gsea-1.html","id":"ridge-plot","chapter":"12 Plot FCS-GSEA","heading":"12.5 Ridge Plot","text":"Ridge plot visualize enriched pathways /regulated genes. x-axis fold change y-axis pathways. Color represents statistical value (e.g. pvalue/p.adjust/qvalue)\nFigure 12.4: Ridge plot GSEA.\n","code":"\nplotGSEA(gse,\n  plot_type = \"ridge\",\n  show_pathway = 10, stats_metric = \"p.adjust\"\n)"},{"path":"plot-gsea-1.html","id":"two-side-barplot","chapter":"12 Plot FCS-GSEA","heading":"12.6 Two-side Barplot","text":"barplot separate positive negative NES two sides. User specify color two sides. Meanwhile, non-significant pathways (e.g. Pvalue > 0.05) colored “grey”.\nFigure 12.5: Two-side bar plot GSEA.\n","code":"\nplotGSEA(gse, plot_type = \"bar\", colour = c(\"navyblue\", \"orange\"))"},{"path":"plot-gsea-1.html","id":"borrow-from-plotenrich","chapter":"12 Plot FCS-GSEA","heading":"12.7 Borrow from plotEnrich","text":"plotting details chapter 11Take geneheat plot example:","code":"\nplotEnrich(gse$gsea_df, \n           plot_type = \"geneheat\", \n           show_gene = c(\"BRCA2\", \"CDK1\", \"MCM8\", \"TIPIN\",\"FBL\",\"ABCC2\"), \n           fold_change = geneList)"},{"path":"plot-gsea-1.html","id":"tricks","chapter":"12 Plot FCS-GSEA","heading":"12.8 Tricks","text":"","code":""},{"path":"plot-gsea-1.html","id":"change-figure-labels","chapter":"12 Plot FCS-GSEA","heading":"12.8.1 Change figure labels","text":"want DIY labels (e.g. make lower case plot), need figure column labels .geneheat plot, labels Description column need change column.","code":"\ngse2 <- gse\ngse2$gsea_df$Description <- tolower(gse2$gsea_df$Description)\n# plotEnrich will uppercase the first letter automatically.\nplotEnrich(gse2$gsea_df, \n           plot_type = \"geneheat\", \n           show_gene = c(\"BRCA2\", \"CDK1\", \"MCM8\", \"TIPIN\",\"FBL\",\"ABCC2\"), \n           fold_change = geneList)"},{"path":"plot-others-1.html","id":"plot-others-1","chapter":"13 Plot others","heading":"13 Plot others","text":"part, introduce plotVenn plotVolcano.","code":""},{"path":"plot-others-1.html","id":"venn-plot","chapter":"13 Plot others","heading":"13.1 Venn Plot","text":"Venn plot needs list gene sets, example:plotVenn supports two types: Venn (default) UpSet. Besides, also supports modification text size, alpha degree, colors parameters plot_theme.\nFigure 13.1: Venn plot\nUpSet plot better four groups genes:\nFigure 13.2: UpSet plot\n","code":"\nset1 <- paste0(rep(\"gene\", 50), sample(1:1000, 50))\nset2 <- paste0(rep(\"gene\", 60), sample(1:1000, 60))\nset3 <- paste0(rep(\"gene\", 70), sample(1:1000, 70))\nset4 <- paste0(rep(\"gene\", 80), sample(1:1000, 80))\nset5 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\n\n# three groups\nsm_gene_list <- list(gset1 = set1, gset2 = set2, gset3 = set3)\n\n# five groups\nla_gene_list <- list(\n  gset1 = set1, gset2 = set2, gset3 = set3,\n  gset4 = set4, gset5 = set5\n)\nplotVenn(sm_gene_list,\n         use_venn = TRUE,\n         color = ggsci::pal_lancet()(3),\n         alpha_degree = 1,\n         main_text_size = 1.5,\n         border_thick = 0\n)\nplotVenn(la_gene_list,\n         use_venn = FALSE,\n         main_text_size = 15,\n         legend_text_size = 8,\n         legend_position = 'left'\n)"},{"path":"plot-others-1.html","id":"volcano-plot","chapter":"13 Plot others","heading":"13.2 Volcano Plot","text":"finishing differential expression analysis, get differentially expressed genes (DEG).\nVolcano plot widely used /regulated genes visualization.example data micro array differential expression analysis:plotVolcano mainly uses DEG result include gene id, fold change statistic value.also parameters:stat_metric: choose “pvalue” “p.adjust”stat_cutoff: cutoff significant statistic value, default 0.05logFC_cutoff: cutoff log2 (fold change), default 1 actually two fold changesup_color: color -regulated genesdown_color: color -regulated genesshow_gene: show gene names, default none. Suggest renaming column genes “gene”.dot_size: volcano dot size\nFigure 13.3: Volcano plot\nwant show genes:\nFigure 13.4: Volcano plot genes.\nTrick increasing text size:User hide x/y-axis labels raise main_text_size enlarge gene text, export figure PPT add labels.","code":"\ndata(deg, package = \"genekitr\")\nhead(deg,5)##   probe_id      logFC   AveExpr         t      P.Value   adj.P.Val          B\n## 1  8144866  0.5672300  5.761898  6.591099 2.496346e-04 0.002269049  0.3372158\n## 2  8066431  0.6526467  9.809843  7.768724 8.554137e-05 0.001045237  1.5161421\n## 3  8022674  0.2768667 11.926333  3.958127 4.974269e-03 0.021521339 -2.9321234\n## 4  7925531 -0.1321333 11.217700 -1.914468 9.517321e-02 0.198247263 -5.9932047\n## 5  8081358  0.3972133  8.994403  4.457386 2.618820e-03 0.013189962 -2.2375610\n##   change  entrezid     symbol\n## 1 stable        10       NAT2\n## 2 stable       100        ADA\n## 3 stable      1000       CDH2\n## 4 stable     10000       AKT3\n## 5 stable 100009676 ZBTB11-AS1\nplotVolcano(deg, \"p.adjust\", remove_legend = T, dot_size = 3)\nplotVolcano(deg, \n            stat_metric = \"p.adjust\",\n            remove_legend = T,\n            show_gene = c(\"CD36\", \"DUSP6\", \"IER3\", \"CDH7\")\n)\nplotVolcano(deg, \n            \"p.adjust\",\n            remove_legend = T,\n            remove_main_text = T,\n            show_gene = c(\"CD36\", \"DUSP6\", \"IER3\", \"CDH7\"),\n            main_text_size = 15, \n            dot_size = 2.5\n)"}]
