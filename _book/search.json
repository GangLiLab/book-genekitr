[{"path":"index.html","id":"welcome-to-genekitr","chapter":"🧬 Welcome to genekitr!","heading":"🧬 Welcome to genekitr!","text":"book tutorial gene information query, gene identifier conversion, gene enrichment analysis, publication-level plotting. new R, worry, set enough example codes guide book. reading book, plot figures based analysis result.","code":""},{"path":"index.html","id":"content","chapter":"🧬 Welcome to genekitr!","heading":"🍱 Content","text":"Part 1 (Search Information) introduces search gene metadata PubMed papers.Part 2 (ID Conversion) describes ID conversion among symbol & alias, NCBI Entrez, Ensembl, Uniprot microarray probe.Part 3 (Enrichment Analysis) describes two widely used functional enrichment methods -representation analysis (ORA) functional class scoring (FCS).Part 4 (Plotting) includes 14 GO plots, 7 KEGG plots, 5 GSEA plots, 2 Venn plots, 1 Volcano plot.","code":""},{"path":"index.html","id":"welcome-to-contribute","chapter":"🧬 Welcome to genekitr!","heading":"💝 Welcome to contribute","text":"Book source code https://github.com/GangLiLab/book_genekitr.get ideas issues, please feel free post feedback.","code":""},{"path":"quick-start.html","id":"quick-start","chapter":"1 Quick start","heading":"1 Quick start","text":"","code":""},{"path":"quick-start.html","id":"search-gene-metadata","chapter":"1 Quick start","heading":"1.1 Search gene metadata","text":"","code":"\nid <- c(\"MCM10\", \"CDC20\", \"S100A9\", \"MMP1\", \"BCC7\",\"FAKEID\",\"HBD\", \"NUDT10\")\ninfo <- genInfo(id, org = \"hs\")\n# keep unique records\ninfo2 <- genInfo(id, org = \"hs\", unique = TRUE)"},{"path":"quick-start.html","id":"search-pubmed-records","chapter":"1 Quick start","heading":"1.2 Search PubMed records","text":"","code":"\n## check package version\npackageVersion(\"genekitr\")\n\n## for version < 0.8.6\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nkeys <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, keys)\n\n## for version > 0.8.6\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nadd_term <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, add_term, num = 30)\n\n# set \"num\" larger to get all records\nall <- getPubmed(term, add_term, num = 666666)"},{"path":"quick-start.html","id":"gene-id-conversion","chapter":"1 Quick start","heading":"1.3 Gene ID conversion","text":"","code":"\nid <-  c(\"Cyp2c23\", \"Fhit\", \"Gal3st2b\", \"Trp53\", \"Tp53\")\nsym2ens <- transId(id ,transTo = \"ensembl\", org = \"mouse\")\n# keep unique records\nsym2ensent <- transId(id ,transTo = c(\"ensembl\",\"entrez\"), org = \"mouse\", unique = TRUE)"},{"path":"quick-start.html","id":"protein-id-conversion","chapter":"1 Quick start","heading":"1.4 Protein ID conversion","text":"","code":"\nid <-  c(\"P27364\", \"P14046\", \"P15650\", \"P16638\", \"P24483\")\nprotein2sym <- transId(id ,transTo = \"sym\", org = \"rat\")"},{"path":"quick-start.html","id":"probe-id-conversion","chapter":"1 Quick start","heading":"1.5 Probe ID conversion","text":"","code":"\nid <-  c('205647_at','204857_at','201394_s_at','210377_at')\nprobe2sym <- transProbe(id, transTo = 'sym',org = 'hs')"},{"path":"quick-start.html","id":"ora-go-analysis","chapter":"1 Quick start","heading":"1.6 ORA GO analysis","text":"ORA stands “-representation analysis”.","code":"\nid <- c(\"TP53\",\"BRCA1\", \"PD1\", \"PDL1\")\nego <- genGO(id,\n  org = \"human\",\n  ont = \"bp\",\n  pvalueCutoff = 0.01,\n  qvalueCutoff = 0.01\n)"},{"path":"quick-start.html","id":"ora-kegg-analysis","chapter":"1 Quick start","heading":"1.7 ORA KEGG analysis","text":"","code":"\nid <- c(\"TP53\",\"BRCA1\", \"PD1\", \"PDL1\",\"BRCA2\",\"TET2\")\nkeg <- genKEGG(id,\n  org = \"human\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)"},{"path":"quick-start.html","id":"fcs-gsea-analysis","chapter":"1 Quick start","heading":"1.8 FCS GSEA analysis","text":"FCS stands “functional-class-scoring”.geneList order ranked gene list decreasing order. Gene inside can Entrez, Ensembl symbol.","code":"\ndata(geneList, package = \"genekitr\")\ngse <- genGSEA(\n  genelist = geneList,\n  org = \"human\",\n  category = \"H\"\n)"},{"path":"quick-start.html","id":"plot-go-and-kegg","chapter":"1 Quick start","heading":"1.9 Plot GO and KEGG","text":"Supported types include: bar, wego, bubble, dot, lollipop, geneheat, genechord,\nnetwork, gomap, goheat, gotangram, wordcloud, upset two-group barplot","code":"\nplotEnrich(ego, plot_type = \"dot\")\nplotEnrich(keg, plot_type = \"bar\")\nplotEnrich(ego, plot_type = \"geneheat\")\nplotEnrich(ego, plot_type = \"network\", scale_ratio = 0.5)"},{"path":"quick-start.html","id":"plot-gsea","chapter":"1 Quick start","heading":"1.10 Plot GSEA","text":"Supported types include: volcano, classic, fgsea, ridge bar","code":"\nplotGSEA(gse, plot_type = \"volcano\", show_pathway = 3)\n\ngenes <- c(\"MET\", \"TP53\", \"PMM2\")\nplotGSEA(gse, plot_type = \"classic\", show_pathway = pathways, show_gene = genes)\n\nplotGSEA(gse, plot_type = \"fgsea\", show_pathway = 3)"},{"path":"quick-start.html","id":"plot-venn","chapter":"1 Quick start","heading":"1.11 Plot Venn","text":"","code":"\nset1 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset2 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset3 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\n\n# classic venn plot\nplotVenn(list(gset1 = set1, gset2 = set2, gset3 = set3), use_venn = TRUE)\n# UpSet plot\nplotVenn(list(gset1 = set1, gset2 = set2, gset3 = set3), use_venn = FALSE)"},{"path":"quick-start.html","id":"plot-deg-volcano","chapter":"1 Quick start","heading":"1.12 Plot DEG Volcano","text":"","code":"\ndata(deg, package = \"genekitr\")\nplotVolcano(deg, \"p.adjust\",\n  remove_legend = T,\n  show_gene = c(\"CD36\", \"DUSP6\", \"IER3\", \"CDH7\")\n)"},{"path":"search-gene-metadata-1.html","id":"search-gene-metadata-1","chapter":"2 Search gene metadata","heading":"2 Search gene metadata","text":"genInfo() function helps user quickly search batch gene metadata names, location, GC content, etc.","code":""},{"path":"search-gene-metadata-1.html","id":"geninfo-supported-species","chapter":"2 Search gene metadata","heading":"2.1 Supported organisms","text":"supports 195 vertebrate species, 120 plant species, two bacteria species. data --date.user select organism name latin_short_name column.common name also acceptable popular research species (e.g., human, mouse, rat, fly, zebrafish, worm, chicken). Take human example, official latin short name “hsapiens”, \" hg“,”hsa“,”hs“, ”human\" also acceptable.","code":"\n# install.packages('DT')\nlibrary(genekitr)\nDT::datatable(ensOrg_name, options = list(pageLength = 10))"},{"path":"search-gene-metadata-1.html","id":"geninfo-basic-usage","chapter":"2 Search gene metadata","heading":"2.2 Basic usage","text":"genInfo three arguments:id: gene id (symbol, Entrez Ensembl) protein idid: gene id (symbol, Entrez Ensembl) protein idorg: organism name, default humanorg: organism name, default humanunique: TRUE FALSE. Commonly, one gene many types matched records. example, human HBD gene three matched Entrez IDs: 3045, 85349, 100187828. TRUE, return one--one match result smallest entrezid maximal information (minimal NAs). See example genekitr feature2.unique: TRUE FALSE. Commonly, one gene many types matched records. example, human HBD gene three matched Entrez IDs: 3045, 85349, 100187828. TRUE, return one--one match result smallest entrezid maximal information (minimal NAs). See example genekitr feature2.","code":"\nid <- c(\"TP53\", \"BRCA1\", \"TET2\")\ninfo <- genInfo(id)\ncolnames(info)##  [1] \"input_id\"         \"symbol\"           \"entrezid\"         \"ensembl\"         \n##  [5] \"uniprot\"          \"chr\"              \"start\"            \"end\"             \n##  [9] \"width\"            \"strand\"           \"gene_name\"        \"ncbi_alias\"      \n## [13] \"ensembl_alias\"    \"gc_content\"       \"gene_biotype\"     \"transcript_count\"\n## [17] \"hgnc_id\"          \"omim\"             \"ccds\"             \"reactome\"        \n## [21] \"ucsc\"             \"mirbase_id\"       \"cell_marker\"\nhead(info, 3)##   input_id symbol entrezid         ensembl\n## 1     TP53   TP53     7157 ENSG00000141510\n## 2    BRCA1  BRCA1      672 ENSG00000012048\n## 3     TET2   TET2    54790 ENSG00000168769\n##                                                              uniprot chr\n## 1 K7PPA8; P04637; Q53GA5; H2EHT1; A0A087X1Q1; A0A087WXZ1; A0A087WT22  17\n## 2                                                 P38398; A0A024R1V0  17\n## 3                                     A0A158SIU0; Q6N021; A0A024RDF7   4\n##       start       end  width strand                        gene_name\n## 1   7661779   7687538  25760     -1                tumor protein p53\n## 2  43044295  43170245 125951     -1      BRCA1 DNA repair associated\n## 3 105145875 105279816 133942      1 tet methylcytosine dioxygenase 2\n##                                                        ncbi_alias\n## 1                                   BCC7; BMFS5; LFS1; P53; TRP53\n## 2 BRCAI; BRCC1; BROVCA1; FANCS; IRIS; PNCA4; PPP1R53; PSCP; RNF53\n## 3                                            IMD75; KIAA1546; MDS\n##                  ensembl_alias gc_content   gene_biotype transcript_count\n## 1                    LFS1; p53      48.85 protein_coding               27\n## 2 BRCC1; FANCS; PPP1R53; RNF53      44.09 protein_coding               34\n## 3           FLJ20032; KIAA1546      36.29 protein_coding                9\n##      hgnc_id   omim\n## 1 HGNC:11998 191170\n## 2  HGNC:1100 113705\n## 3 HGNC:25941 612839\n##                                                                                                                                 ccds\n## 1 CCDS73967; CCDS73966; CCDS73968; CCDS73964; CCDS73965; CCDS73963; CCDS73969; CCDS45606; CCDS45605; CCDS73970; CCDS73971; CCDS11118\n## 2                                                                              CCDS11453; CCDS11456; CCDS11455; CCDS11459; CCDS11454\n## 3                                                                                                              CCDS3666; ; CCDS47120\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                reactome\n## 1 R-HSA-1643685; R-HSA-392499; R-HSA-597592; R-HSA-109582; R-HSA-168256; R-HSA-212436; R-HSA-2262752; R-HSA-73857; R-HSA-74160; R-HSA-8953897; R-HSA-162582; R-HSA-5688426; R-HSA-5689880; R-HSA-2990846; R-HSA-3108232; R-HSA-5693532; R-HSA-73894; R-HSA-109581; R-HSA-109606; R-HSA-114452; R-HSA-1257604; R-HSA-5357801; R-HSA-9006925; R-HSA-1640170; R-HSA-69278; R-HSA-69620; R-HSA-3700989; R-HSA-5633008; R-HSA-6803207; R-HSA-5218859; R-HSA-157118; R-HSA-6807070; R-HSA-8943724; R-HSA-983231; R-HSA-2559583; R-HSA-8853884; R-HSA-6796648; R-HSA-453274; R-HSA-69275; R-HSA-1912408; R-HSA-1912422; R-HSA-6803204; R-HSA-8878159; R-HSA-390466; R-HSA-390471; R-HSA-391251; R-HSA-1280215; R-HSA-449147; R-HSA-69481; R-HSA-6785807; R-HSA-2559580; R-HSA-2559585; R-HSA-349425; R-HSA-69541; R-HSA-69563; R-HSA-69580; R-HSA-69615; R-HSA-8852276; R-HSA-3232118; R-HSA-5693565; R-HSA-5693606; R-HSA-5633007; R-HSA-6804756; R-HSA-69473; R-HSA-9645723; R-HSA-5689896; R-HSA-8941855; R-HSA-2559586; R-HSA-5628897; R-HSA-6804757; R-HSA-6804759; R-HSA-6806003; R-HSA-6803211; R-HSA-5620971; R-HSA-6804754; R-HSA-6804758; R-HSA-139915; R-HSA-6803205; R-HSA-6791312; R-HSA-6804115; R-HSA-6804114; R-HSA-6804116; R-HSA-69560; R-HSA-69895; R-HSA-2559584; R-HSA-6804760; R-HSA-6811555; R-HSA-111448; R-HSA-9723905; R-HSA-9723907\n## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      R-HSA-1643685; R-HSA-392499; R-HSA-597592; R-HSA-212436; R-HSA-73857; R-HSA-74160; R-HSA-5688426; R-HSA-2990846; R-HSA-3108214; R-HSA-3108232; R-HSA-5685938; R-HSA-5693532; R-HSA-5693538; R-HSA-5693567; R-HSA-73894; R-HSA-1640170; R-HSA-69620; R-HSA-3700989; R-HSA-6796648; R-HSA-69481; R-HSA-5693565; R-HSA-5693606; R-HSA-1474165; R-HSA-1221632; R-HSA-1500620; R-HSA-5633007; R-HSA-5685942; R-HSA-5689901; R-HSA-5693537; R-HSA-5693554; R-HSA-5693568; R-HSA-5693571; R-HSA-5693579; R-HSA-5693607; R-HSA-5693616; R-HSA-6804756; R-HSA-69473; R-HSA-8953750; R-HSA-912446; R-HSA-9663199; R-HSA-9675135; R-HSA-9675136; R-HSA-9699150; R-HSA-9701193; R-HSA-9704331; R-HSA-9704646\n## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              R-HSA-74160; R-HSA-212165; R-HSA-5221030\n##                                                                                                                                                                                                                                                                                                                                                                                                                     ucsc\n## 1                                                                                     uc002gig.2; uc284ohw.1; uc002gih.5; uc060auo.1; uc060aup.1; uc060auq.1; uc010cnf.2; uc010cng.2; uc002gii.2; uc031qyq.2; uc002gij.4; uc060aus.1; uc060aut.1; uc010cnh.4; uc060auu.1; uc060auv.1; uc060aur.2; uc002gim.5; uc060auw.1; uc060auy.1; uc060auz.1; uc010cnj.2; uc060ava.1; uc060avb.1; uc060avc.1; uc060avd.1; uc032esw.2\n## 2 uc060fri.1; uc002icq.6; uc002ict.5; uc002icu.4; uc285oaj.1; uc010whm.3; uc010whn.3; uc060frj.1; uc010cyx.4; uc060frk.1; uc060frl.1; uc060frm.1; uc060frn.1; uc060fro.1; uc060frp.1; uc060frq.1; uc060frr.1; uc060frs.1; uc002idd.5; uc284oig.1; uc060frt.1; uc060fru.1; uc287jed.1; uc060frv.1; uc060frw.1; uc060frx.1; uc060fry.1; uc060frz.1; uc285oak.1; uc060fsa.1; uc060fsb.1; uc060fsc.1; uc285oal.1; uc060fsd.1\n## 3                                                                                                                                                                                                                                                                                                             uc021xqk.1; uc011cez.3; uc062ysb.1; uc003hxj.3; uc003hxk.5; uc062ysc.1; uc010ilp.3; uc062yse.1; uc062ysf.1\n##   mirbase_id\n## 1       <NA>\n## 2       <NA>\n## 3       <NA>\n##                                                                                                                                                                                                                                                                          cell_marker\n## 1                               Fetal gonad|T|Mitotic fetal germ cell; Fetal gonad|T|Gonadal endothelial cell; Fetal kidney|T|Natural killer T (NKT) cell; Fetal gonad|N|Mitotic fetal germ cell; Fetal gonad|N|Gonadal endothelial cell; Fetal kidney|N|Natural killer T (NKT) cell\n## 2                                                                                                                                                                                             Fetal kidney|T|Natural killer T (NKT) cell; Fetal kidney|N|Natural killer T (NKT) cell\n## 3 Embryo|T|Trophectoderm cell; Liver|T|Exhausted CD8+ T cell; Liver|T|Regulatory T (Treg) cell; Fetal kidney|T|Natural killer T (NKT) cell; Embryo|N|Trophectoderm cell; Liver|T|Exhausted CD8+ T cell; Liver|T|Regulatory T (Treg) cell; Fetal kidney|N|Natural killer T (NKT) cell"},{"path":"search-gene-metadata-1.html","id":"geninfo-features","chapter":"2 Search gene metadata","heading":"2.3 Features","text":"","code":""},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-1","chapter":"2 Search gene metadata","heading":"2.3.1 f1: keep input order","text":"genInfo result strictly keep input order.gene id unrecognized (e.g., misspelled belong organism), return data NA.","code":"\nid <- c(\n  \"MCM10\", \"CDC20\", \"S100A9\",\n  \"FAKEID\", \"TP53\", \"HBD\", \"NUDT10\"\n)\n# for human id, no need to input the org argument\ninfo <- genInfo(id, unique = TRUE)\nidentical(id, info$input_id)## [1] TRUE\nhead(info, 3)##   input_id symbol entrezid         ensembl uniprot chr     start       end\n## 1    MCM10  MCM10    55388 ENSG00000065328  Q7L590  10  13161558  13211110\n## 2    CDC20  CDC20      991 ENSG00000117399  Q12834   1  43358981  43363203\n## 3   S100A9 S100A9     6280 ENSG00000163220  P06702   1 153357854 153361023\n##   width strand                                                   gene_name\n## 1 49553      1 minichromosome maintenance 10 replication initiation factor\n## 2  4223      1                                      cell division cycle 20\n## 3  3170      1                             S100 calcium binding protein A9\n##                                                                    ncbi_alias\n## 1                                                CNA43; DNA43; IMD80; PRO2249\n## 2                                                  CDC20A; bA276H19.3; p55CDC\n## 3 60B8AG; CAGB; CFAG; CGLB; L1AG; LIAG; MAC387; MIF; MRP14; NIF; P14; S100-A9\n##                                                                   ensembl_alias\n## 1                                                         CNA43; DNA43; PRO2249\n## 2                                                                CDC20A; p55CDC\n## 3 60B8AG; CAGB; CFAG; CGLB; LIAG; MAC387; MIF; MRP-14; MRP14; NIF; P14; S100-A9\n##   gc_content   gene_biotype transcript_count    hgnc_id   omim\n## 1      43.59 protein_coding                7 HGNC:18043 609357\n## 2      52.17 protein_coding                4  HGNC:1723 603618\n## 3      52.56 protein_coding                1 HGNC:10499 123886\n##                   ccds\n## 1 CCDS7095; ; CCDS7096\n## 2              CCDS484\n## 3             CCDS1036\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         reactome\n## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                           R-HSA-1640170; R-HSA-69278; R-HSA-69620; R-HSA-69306; R-HSA-176187; R-HSA-453279; R-HSA-68962; R-HSA-69002; R-HSA-69206; R-HSA-69481\n## 2 R-HSA-392499; R-HSA-597592; R-HSA-168256; R-HSA-162582; R-HSA-194315; R-HSA-195258; R-HSA-5688426; R-HSA-5689880; R-HSA-9716542; R-HSA-1280218; R-HSA-141424; R-HSA-141444; R-HSA-1640170; R-HSA-2467813; R-HSA-2500257; R-HSA-2555396; R-HSA-5663220; R-HSA-68877; R-HSA-68882; R-HSA-68886; R-HSA-69278; R-HSA-69618; R-HSA-69620; R-HSA-9648025; R-HSA-983168; R-HSA-983169; R-HSA-141405; R-HSA-141430; R-HSA-174048; R-HSA-174143; R-HSA-174154; R-HSA-174178; R-HSA-174184; R-HSA-176407; R-HSA-176408; R-HSA-176409; R-HSA-176814; R-HSA-179409; R-HSA-179419; R-HSA-453276; R-HSA-174113; R-HSA-176417\n## 3                                                                                                                                                                                                                       R-HSA-1643685; R-HSA-168249; R-HSA-168256; R-HSA-6798695; R-HSA-162582; R-HSA-194315; R-HSA-195258; R-HSA-9716542; R-HSA-1280218; R-HSA-983169; R-HSA-166016; R-HSA-168898; R-HSA-5668599; R-HSA-1236974; R-HSA-1236975; R-HSA-6803157; R-HSA-166058; R-HSA-168179; R-HSA-168188; R-HSA-181438; R-HSA-5260271; R-HSA-5602358; R-HSA-5602498; R-HSA-5603041; R-HSA-6799990; R-HSA-5686938\n##                                                                                 ucsc\n## 1 uc001imb.4; uc057rtn.1; uc001ima.4; uc057rto.1; uc057rtp.1; uc057rtq.1; uc057rtr.1\n## 2                                     uc001cix.5; uc001ciy.4; uc057fmt.1; uc057fmu.1\n## 3                                                                         uc001fbq.4\n##   mirbase_id\n## 1       <NA>\n## 2       <NA>\n## 3       <NA>\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               cell_marker\n## 1                                                                                                                                                                                                                                                                                            Fetal gonad|T|Migration phase fetal germ cell; Umbilical cord blood|T|Granulocyte-monocyte progenitor; Fetal gonad|N|Migration phase fetal germ cell; Umbilical cord blood|N|Granulocyte-monocyte progenitor\n## 2                                                                                                                                                                                                                                                                    Embryonic prefrontal cortex|T|Neural progenitor cell; Muscle|T|Myoblast; Large intestine|T|MKI67+ progenitor cell; Embryonic prefrontal cortex|N|Neural progenitor cell; Muscle|N|Myoblast; Large intestine|N|MKI67+ progenitor cell\n## 3 Small intestine|T|Enterocyte progenitor cell; Fetal gonad|T|Granulosa cell; Blood|T|CD1C+_B dendritic cell; Fetal kidney|T|Monocyte; Kidney|T|Neutrophil; Kidney|T|Plasma cell; Kidney|T|Neutrophil; Undefined|N|Eosinophil; Undefined|N|Neutrophil; Bone marrow|N|Monocyte derived dendritic cell; Small intestine|N|Enterocyte progenitor cell; Fetal gonad|N|Granulosa cell; Blood|N|CD1C+_B dendritic cell; Fetal kidney|N|Monocyte; Kidney|N|Neutrophil; Kidney|T|Plasma cell; Kidney|T|Neutrophil"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-2","chapter":"2 Search gene metadata","heading":"2.3.2 f2: keep unique or not","text":"unique = TRUE, one record maximal information returned.","code":"\nid <- \"HBD\"\nuniq_info <- genInfo(id, org = \"hs\", unique = TRUE)\nuniq_info[, 1:4]##   input_id symbol entrezid         ensembl\n## 2      HBD    HBD     3045 ENSG00000223609\nall_info <- genInfo(id, org = \"hs\", unique = FALSE)\nall_info[, 1:4]##   input_id symbol  entrezid         ensembl\n## 1      HBD    HBD 100187828 ENSG00000223609\n## 2      HBD    HBD      3045 ENSG00000223609\n## 3      HBD KRT87P     85349 ENSG00000135477"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-3","chapter":"2 Search gene metadata","heading":"2.3.3 f3: disambiguation feature","text":"","code":""},{"path":"search-gene-metadata-1.html","id":"distinguish-from-gene-symbol-and-alias","chapter":"2 Search gene metadata","heading":"2.3.3.1 distinguish from gene symbol and alias","text":"Many common gene names gene alias, many tools accept gene symbols cause gene information lost. example, “BCC7” alias “TP53” “PD1” three aliases: “PDCD1”, “SNCA” “SPATA2” enrichment analyses tools recognize “BCC7”.","code":"\nid <- c(\"BCC7\", \"PD1\")\ngenInfo(id)[1:4]##   input_id symbol entrezid         ensembl\n## 1     BCC7   TP53     7157 ENSG00000141510\n## 2      PD1  PDCD1     5133 ENSG00000276977\n## 3      PD1  PDCD1     5133 ENSG00000188389\n## 4      PD1   SNCA     6622 ENSG00000145335\n## 5      PD1 SPATA2     9825 ENSG00000158480"},{"path":"search-gene-metadata-1.html","id":"distinguish-gene-symbol-with-special-characters","chapter":"2 Search gene metadata","heading":"2.3.3.2 distinguish gene symbol with special characters","text":"","code":"\nid <- c(\"TNF-α\", \"κB-Ras2\")\ngenInfo(id)[1:4]##      input_id  symbol entrezid         ensembl\n## 1   TNF-alpha     TNF     7124 ENSG00000228978\n## 2   TNF-alpha     TNF     7124 ENSG00000228321\n## 3   TNF-alpha     TNF     7124 ENSG00000232810\n## 4   TNF-alpha     TNF     7124 ENSG00000204490\n## 5   TNF-alpha     TNF     7124 ENSG00000230108\n## 6   TNF-alpha     TNF     7124 ENSG00000223952\n## 7   TNF-alpha     TNF     7124 ENSG00000206439\n## 8   TNF-alpha     TNF     7124 ENSG00000228849\n## 9 kappaB-Ras2 NKIRAS2    28511 ENSG00000168256"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-4","chapter":"2 Search gene metadata","heading":"2.3.4 f4: count organism gene types","text":"","code":"\nuniq_symbol <- genInfo(org = \"hs\") %>%\n  dplyr::filter(!is.na(gene_biotype)) %>%\n  dplyr::distinct(symbol, .keep_all = T)\n\nuniq_symbol %>%\n  {\n    table(.$gene_biotype)\n  }## \n##                          IG_C_gene                    IG_C_pseudogene \n##                                 14                                  9 \n##                          IG_D_gene                          IG_J_gene \n##                                 37                                 18 \n##                    IG_J_pseudogene                          IG_V_gene \n##                                  3                                144 \n##                    IG_V_pseudogene                            Mt_rRNA \n##                                184                                  2 \n##                            Mt_tRNA                                TEC \n##                                 23                                 27 \n##                          TR_C_gene                          TR_D_gene \n##                                  7                                  4 \n##                          TR_J_gene                    TR_J_pseudogene \n##                                 79                                  4 \n##                          TR_V_gene                    TR_V_pseudogene \n##                                107                                 33 \n##                             lncRNA                              miRNA \n##                               6095                               1852 \n##                           misc_RNA             polymorphic_pseudogene \n##                               1034                                 49 \n##               processed_pseudogene                     protein_coding \n##                               7199                              19572 \n##                               rRNA                    rRNA_pseudogene \n##                                 46                                496 \n##                           ribozyme                               sRNA \n##                                  4                                  1 \n##                              scRNA                             scaRNA \n##                                  1                                 18 \n##                              snRNA                             snoRNA \n##                               1833                                437 \n##   transcribed_processed_pseudogene     transcribed_unitary_pseudogene \n##                                355                                132 \n## transcribed_unprocessed_pseudogene    translated_processed_pseudogene \n##                                770                                  2 \n##  translated_unprocessed_pseudogene                 unitary_pseudogene \n##                                  2                                 78 \n##             unprocessed_pseudogene \n##                               1706"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-5","chapter":"2 Search gene metadata","heading":"2.3.5 f5: extract specific biotype genes","text":"Get human protein-coding genes:Compare HGNC data:Check missing gene names result:Let’s look first one “ABTB3”:seems gene “ABTB3” recently modified, GeneCards: ABTB3 also shows result.look EntrezID 121551, also known “BTBD11” matched Ensembl data: ENSG00000151136So reason mismatch --sync large database Ensembl NCBI. However, mismatch number small effect serious.","code":"\nhg_pro_gene <- uniq_symbol %>%\n  dplyr::filter(gene_biotype == \"protein_coding\") %>%\n  dplyr::pull(symbol)\n\nlength(hg_pro_gene)## [1] 19572\nhgnc_data <- vroom::vroom(\"http://ftp.ebi.ac.uk/pub/databases/genenames/hgnc/tsv/locus_types/gene_with_protein_product.txt\")\nhgnc_symbol <- hgnc_data$symbol\nplotVenn(list(\n  genekitr_symbol = hg_pro_gene,\n  hgnc_symbol = hgnc_symbol\n))\ncheck_genes <- head(hgnc_symbol[!hgnc_symbol %in% hg_pro_gene], 3)\nhgnc_data %>%\n  dplyr::filter(symbol %in% check_genes) %>%\n  dplyr::select(\n    symbol, date_approved_reserved, date_symbol_changed,\n    entrez_id\n  )##   symbol date_approved_reserved date_symbol_changed entrez_id\n## 1  ABTB3             2003-12-15          2022-05-13    121551\n## 2 ADGRF2             2002-11-26          2015-03-03    222611\n## 3  AKR7L             2008-12-09                <NA>    246181\ngenInfo(\"121551\")[1:3]##   input_id         ensembl symbol\n## 1   121551 ENSG00000151136 BTBD11"},{"path":"search-gene-metadata-1.html","id":"geninfo-feature-6","chapter":"2 Search gene metadata","heading":"2.3.6 f6: extract all metadata","text":"user wants get information, just give org argument alone.","code":"\nall_human_data <- genInfo(org = \"human\")\ndim(all_human_data)## [1] 92441    22"},{"path":"search-gene-metadata-1.html","id":"geneinfo-feature-7","chapter":"2 Search gene metadata","heading":"2.3.7 f7: extract human cell markers","text":"CellMarker database manually curated 100,000 published papers, 4,124 entries including cell marker information, tissue type, cell type, cancer information source., geneInfo integrated human cell markers cell_marker column.naming rules : tissue_type | cancer_type: Tumor(T) Normal(N) | cell_type, one gene matches many cell types, seperated ;.","code":"\nhg_marker_all <- genInfo(org = \"human\") %>%\n  dplyr::select(symbol, cell_marker) %>%\n  dplyr::filter(!is.na(cell_marker)) %>%\n  tidyr::separate_rows(cell_marker, sep = \"; \") %>%\n  dplyr::mutate(cell_marker = gsub(\"^.*\\\\|\", \"\", cell_marker)) %>%\n  dplyr::distinct()\nhead(hg_marker_all)## # A tibble: 6 × 2\n##   symbol cell_marker                                       \n##   <chr>  <chr>                                             \n## 1 A1BG   Retinoid acid signaling-responsive fetal germ cell\n## 2 ADA    Brush cell (Tuft cell)                            \n## 3 ADA    Neuroendocrine cell                               \n## 4 ADA    Retinoid acid signaling-responsive fetal germ cell\n## 5 ADA    Oogenesis phase fetal germ cell                   \n## 6 ADA    Mitotic arrest phase fetal germ cell\n# select stromal cell markers\nhg_marker_all %>%\n  dplyr::filter(cell_marker == \"Stromal cell\") %>%\n  dplyr::pull(symbol) %>%\n  sort()##  [1] \"ALCAM\"   \"ANPEP\"   \"BST1\"    \"CD34\"    \"CD44\"    \"COL5A1\"  \"ENG\"    \n##  [8] \"GREM1\"   \"ICAM1\"   \"ICAM2\"   \"ICAM3\"   \"ITGA1\"   \"ITGA4\"   \"ITGAV\"  \n## [15] \"ITGB1\"   \"ITGB3\"   \"KIT\"     \"KLF6\"    \"LTBR\"    \"LUM\"     \"MADCAM1\"\n## [22] \"MCAM\"    \"MME\"     \"MMP1\"    \"MMP2\"    \"MMP9\"    \"NGFR\"    \"NT5E\"   \n## [29] \"PDGFRA\"  \"PDGFRB\"  \"PDPN\"    \"PECAM1\"  \"PROM1\"   \"PTPRC\"   \"THY1\"   \n## [36] \"TIMP1\"   \"TIMP2\"   \"TLR1\"    \"TLR2\"    \"TLR3\"    \"TLR4\"    \"VCAM1\"  \n## [43] \"VIM\""},{"path":"search-pubmed-1.html","id":"search-pubmed-1","chapter":"3 Search PubMed records","heading":"3 Search PubMed records","text":"getPubmed function utilizes europepmc easily get PubMed records searching paper abstract.Users need input term argument; supplement information, keys parameter available.example, user wants check papers genes “Tp53”, “Brca1,” “Tet2” research mouse stem cells:NOTICE:\nminor update made version 0.8.6 . Argument keys replaced add_term easy understanding, num parameter added specify number returned records.","code":"\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nkeys <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, keys)\nnames(l)## [1] \"Tp53\"  \"Brca1\" \"Tet2\"\nhead(l$Tp53, 5)## # A tibble: 5 × 28\n##   id        source pmid     pmcid    doi   title authorString journalTitle issue\n##   <chr>     <chr>  <chr>    <chr>    <chr> <chr> <chr>        <chr>        <chr>\n## 1 35409174  MED    35409174 PMC8998… 10.3… \"Enh… Gringmuth M… Int J Mol S… 7    \n## 2 PPR467733 PPR    <NA>     <NA>     10.1… \"Bia… Ohno T, Aka… <NA>         <NA> \n## 3 35435331  MED    35435331 PMC9189… 10.1… \"Ide… Thirouard L… Adv Sci (We… 17   \n## 4 35536873  MED    35536873 <NA>     10.1… \"Com… Liu T, Zhao… Cancer Res   <NA> \n## 5 PPR483807 PPR    <NA>     <NA>     10.2… \"Nic… Yu Z, Tong … <NA>         <NA> \n## # … with 19 more variables: journalVolume <chr>, pubYear <chr>,\n## #   journalIssn <chr>, pageInfo <chr>, pubType <chr>, isOpenAccess <chr>,\n## #   inEPMC <chr>, inPMC <chr>, hasPDF <chr>, hasBook <chr>, hasSuppl <chr>,\n## #   citedByCount <int>, hasReferences <chr>, hasTextMinedTerms <chr>,\n## #   hasDbCrossReferences <chr>, hasLabsLinks <chr>,\n## #   hasTMAccessionNumbers <chr>, firstIndexDate <chr>,\n## #   firstPublicationDate <chr>\nterm <- c(\"Tp53\", \"Brca1\", \"Tet2\")\nadd_term <- c(\"stem cell\", \"mouse\")\nl <- getPubmed(term, add_term, num = 30)\n# set \"num\" larger to get all records\nall <- getPubmed(term, add_term, num = 666666)"},{"path":"gene-id-conversion-1.html","id":"gene-id-conversion-1","chapter":"4 Gene ID conversion","heading":"4 Gene ID conversion","text":"handled genomics analysis, may spend much time converting gene identifiers types.example, gene set enrichment analysis common omics downstream process mainly based MsigDb. According release note, since MSigDB 7.0, identifiers genes mapped HGNC approved Gene Symbol NCBI Gene ID annotations extracted Ensembl’s BioMart data service, updated MSigDB release latest available version Ensembl. Currently, MSigDB 7.5 updated human gene annotations Ensembl v105.Hence, id conversion help keeping update latest annotations.common gene id types symbol (e.g. TP53),NCBI Entrez (e.g. 7157) Ensembl (e.g. ENSG00000141510). ID conversion among different types common two main concerns: performance flexibility.","code":""},{"path":"gene-id-conversion-1.html","id":"convertion-current-tools","chapter":"4 Gene ID conversion","heading":"4.1 Current tools","text":"Currently various tools available, however different methods drawbacks:biomaRt: R package frequently used access --date Ensembl database. access online database time built-parameters many.clusterProfiler: R package depends Bioconductor annotation packages extract NCBI gene. NCBI database updates every day Bioconductor package updates nearly every six months. Besides, supports 20 organisms user download load annotation data mapping.gProfiler: web server supports 40 types IDs 60 species. supports one--one conversion, example, user want convert gene symbol Entrez Ensembl, happen. Besides, output result convenient process.DAVID: web server interface user-friendly.UniProt: large protein database may support almost species user needs specify input id type converts protein id.GIDcon: web server covers human, mouse rat. User must seperates gene ids comma batch query. Five symbols take 8 secs convert.Considered problems, genekitr combines Ensembl NCBI database provide comprehensive result optimizes running speed.Also supports 195 vertebrate species, 120 plant species 2 bacteria species (see also session 1.1).","code":""},{"path":"gene-id-conversion-1.html","id":"transid-basic-usage","chapter":"4 Gene ID conversion","heading":"4.2 Basic usage","text":"transId provides five arguments:id: gene id (symbol, Entrez Ensembl), protein id (see also session 4.2) microarray id (see also session 5.1)id: gene id (symbol, Entrez Ensembl), protein id (see also session 4.2) microarray id (see also session 5.1)transTo: conversion target type. User select one “symbol”, “entrez”, “ensembl” “uniprot”. Besides, abbreviation acceptable (e.g. “ens” fine “ensembl” “en” raise error separate “entrez”)transTo: conversion target type. User select one “symbol”, “entrez”, “ensembl” “uniprot”. Besides, abbreviation acceptable (e.g. “ens” fine “ensembl” “en” raise error separate “entrez”)org: organism name, default humanorg: organism name, default humanunique: TRUE FALSE (default). TRUE, returns one matched id.unique: TRUE FALSE (default). TRUE, returns one matched id.keepNA: TRUE FALSE (default). id matched one, keep .keepNA: TRUE FALSE (default). id matched one, keep .See human example , due NA removed, result order slightly different input id.want get order, can set keepNA = TRUE:want get one--one mapping, can set unique = TRUE result comprehensive information return:","code":"\n# human genes\nid <- c(\"AKT3\", \"SSX6P\", \"FAKE_ID\", \"BCC7\")\ntransId(id, transTo = \"ens\")##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2     AKT3 ENSG00000117020\n## 3    SSX6P ENSG00000171483\n## 4     BCC7 ENSG00000141510\n# fruit fly genes\ntransId(\n  id = c(\"10178780\", \"10178777\", \"10178786\", \"10178792\"),\n  transTo = \"sym\", org = \"fly\"\n)##   input_id          symbol\n## 1 10178780         CR33929\n## 2 10178777         CG42835\n## 3 10178786 Su(Ste):CR40820\n## 4 10178792         CG42694\ntransId(id, transTo = \"ens\", keepNA = TRUE)##   input_id         ensembl\n## 1     AKT3 ENSG00000275199\n## 2     AKT3 ENSG00000117020\n## 3    SSX6P ENSG00000171483\n## 4  FAKE_ID            <NA>\n## 5     BCC7 ENSG00000141510\ntransId(id, transTo = \"ens\", keepNA = TRUE, unique = TRUE)##    input_id         ensembl\n## 21     AKT3 ENSG00000117020\n## 1     SSX6P ENSG00000171483\n## 2   FAKE_ID            <NA>\n## 3      BCC7 ENSG00000141510"},{"path":"gene-id-conversion-1.html","id":"transid-features","chapter":"4 Gene ID conversion","heading":"4.3 Features","text":"","code":""},{"path":"gene-id-conversion-1.html","id":"transid-feature-1","chapter":"4 Gene ID conversion","heading":"4.3.1 f1: convert to several types","text":"transTo accepts one type:","code":"\ntransId(id, transTo = c(\"ens\", \"ent\"))##   input_id         ensembl entrezid\n## 1     AKT3 ENSG00000275199    10000\n## 2     AKT3 ENSG00000117020    10000\n## 3    SSX6P ENSG00000171483   280657\n## 4     BCC7 ENSG00000141510     7157"},{"path":"gene-id-conversion-1.html","id":"transid-feature-2","chapter":"4 Gene ID conversion","heading":"4.3.2 f2: distinguish from symbol and alias","text":"One big common problem current tools confusion gene symbol gene alias.Gene alias alternative name official gene symbol, like “BCC7” actually alias “TP53”. Sometimes gene alias widely used official symbol. example, “PDL1” alias “CD274” fact.Due combination NCBI Ensembl metadata, transId easily recognize gene symbol alias setting transTo = 'symbol'.","code":"\ntransId(c(\"BCC7\", \"TP53\", \"PD1\", \"PDL1\", \"TET2\"), \"sym\")##   input_id symbol\n## 1     BCC7   TP53\n## 2     TP53   TP53\n## 3      PD1  PDCD1\n## 4      PD1   SNCA\n## 5      PD1 SPATA2\n## 6     PDL1  CD274\n## 7     TET2   TET2"},{"path":"gene-id-conversion-1.html","id":"transid-feature-3","chapter":"4 Gene ID conversion","heading":"4.3.3 f3: no worry for Ensembl version","text":"Ensembl stable ID consists five parts: ENS(species)(object type)(identifier). (version)\nexample, ENSG00000141510.11 TP53 version .11 may confuse many tools.\nHowever using transId, user worry issue .","code":"\ntransId(\"ENSG00000141510.11\", \"symbol\")##          input_id symbol\n## 1 ENSG00000141510   TP53"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-data","chapter":"4 Gene ID conversion","heading":"4.4 Excercise 1: DEG result","text":"built-example data differentially expressed genes : GSE42872","code":"\ndata(deg, package = \"genekitr\")\ntable(deg$change)## \n##   down stable     up \n##    451  17009    579\nid <- deg$entrezid\nlength(id)## [1] 18039"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-bitr","chapter":"4 Gene ID conversion","heading":"4.4.1 clusterProfiler::bitr","text":"User needs specify input id type converted type columns(org.Hs.eg.db).","code":"\n# User must firstly install the org.Hs.eg.db\n# BiocManager::install('org.Hs.eg.db')\nlibrary(org.Hs.eg.db)\nlibrary(clusterProfiler)\nAnnotationDbi::columns(org.Hs.eg.db)##  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n##  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n## [11] \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"          \"OMIM\"        \n## [16] \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"         \"PMID\"        \n## [21] \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"       \"UNIGENE\"     \n## [26] \"UNIPROT\"\nbitr_res <- bitr(id, fromType = \"ENTREZID\", toType = \"SYMBOL\", OrgDb = \"org.Hs.eg.db\")\nbitr_sym <- unique(bitr_res$SYMBOL)\nlength(bitr_sym)## [1] 18036"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-biomart","chapter":"4 Gene ID conversion","heading":"4.4.2 biomaRt::getBM","text":"initializing process depends mainly Ensembl’s web access speed. Usually, may take tens seconds.","code":"\n# initializing...\nensembl <- biomaRt::useEnsembl(\n  biomart = \"genes\",\n  dataset = \"hsapiens_gene_ensembl\"\n)\n# conversion\nbiomart_res <- biomaRt::getBM(\n  attributes = c(\"entrezgene_id\", \"external_gene_name\"),\n  filters = c(\"entrezgene_id\"),\n  mart = ensembl,\n  values = id\n)\nbiomart_sym <- unique(biomart_res$external_gene_name) %>%\n  stringi::stri_remove_empty()\nlength(biomart_sym)## [1] 16085"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-transid","chapter":"4 Gene ID conversion","heading":"4.4.3 genekitr::transId","text":"","code":"\ntransid_res <- genekitr::transId(id, transTo = \"sym\", unique = T)\ntransid_sym <- unique(transid_res$symbol)\nlength(transid_sym)## [1] 18039"},{"path":"gene-id-conversion-1.html","id":"transid-ex1-compare","chapter":"4 Gene ID conversion","heading":"4.4.4 compare three results","text":"","code":"\nplotVenn(list(\n  bitr = bitr_sym,\n  transid = transid_sym,\n  biomart = biomart_sym\n))"},{"path":"gene-id-conversion-1.html","id":"bitr-vs-transid","chapter":"4 Gene ID conversion","heading":"4.4.4.1 bitr vs transId","text":"117 genes bitr result:Let’s take look first one LINC00337, converted gene 148645When search NCBI see official symbol “ICMT-DT” now “LINC00337” alias. look back transId result, keeps update NCBI web.Besides, 118 unique symbols transId result:gene ICMT-DT listed.","code":"\nbitr_sym[!bitr_sym %in% transid_sym] %>% head(5)## [1] \"C19orf71\"     \"LINC00476\"    \"LOC100129484\" \"PP2672\"       \"LOC100130449\"\nbitr_res %>%\n  filter(SYMBOL %in% \"LINC00337\") %>%\n  pull(ENTREZID)## [1] \"148645\"\ntransid_res %>%\n  filter(input_id %in% \"148645\") %>%\n  pull(symbol)## [1] \"ICMT-DT\"\ntransid_sym[!transid_sym %in% bitr_sym] %>% head(5)## [1] \"TEKTIP1\"     \"ERCC6L2-AS1\" \"LINC02983\"   \"LINC02961\"   \"GPC1-AS1\""},{"path":"gene-id-conversion-1.html","id":"biomart-vs-transid","chapter":"4 Gene ID conversion","heading":"4.4.4.2 biomart vs transId","text":"13 genes biomart result:search NCBI 100528032 see official symbol “KLRC4-KLRK1”. look back transId bitr result, NCBI web.","code":"\nbiomart_sym[!biomart_sym %in% transid_sym] %>% head()## [1] \"KLRK1\"     \"FLJ37453\"  \"C11orf49\"  \"C19orf71\"  \"ZNF761\"    \"LINC01588\"\nbiomart_res %>%\n  filter(external_gene_name %in% \"KLRK1\") %>%\n  pull(entrezgene_id)## [1] 100528032\nbitr_res %>%\n  filter(ENTREZID == \"100528032\") %>%\n  pull(SYMBOL)## [1] \"KLRC4-KLRK1\"\ntransid_res %>%\n  filter(input_id %in% \"100528032\") %>%\n  pull(symbol)## [1] \"KLRC4-KLRK1\""},{"path":"gene-id-conversion-1.html","id":"transid-ex2-data","chapter":"4 Gene ID conversion","heading":"4.5 Excercise 2: mixture of gene symbol and alias","text":"Compared Entrez Ensembl, gene symbol alias hard distinguish. real science life, impact misunderstanding names huge.Takehara et al. (2018) retract published paper authors just misused “TAZ” actual research target “WWTR1” “TAZ” alias “WWTR1”.similar issues published paper: risks using unapproved gene symbols. course, happens human research. must raise alert gene alias.","code":""},{"path":"gene-id-conversion-1.html","id":"hgnchelper-vs-transid","chapter":"4 Gene ID conversion","heading":"4.5.1 HGNChelper vs transId","text":"HGNChelper mainly built human research, give simple human gene list example.first three genes omitted HGNChelper.","code":"\nid <- c(\"TBET\", \"B220\", \"BCC7\", \"PD1\", \"PDL1\")\n\ntransid_res <- genekitr::transId(id, transTo = \"sym\", unique = FALSE)\ntransid_res##   input_id symbol\n## 1     TBET  TBX21\n## 2     B220  PTPRC\n## 3     BCC7   TP53\n## 4      PD1  PDCD1\n## 5      PD1   SNCA\n## 6      PD1 SPATA2\n## 7     PDL1  CD274\nhgnc_res <- HGNChelper::checkGeneSymbols(id)\nhgnc_res##      x Approved          Suggested.Symbol\n## 1 TBET    FALSE                      <NA>\n## 2 B220    FALSE                      <NA>\n## 3 BCC7    FALSE                      <NA>\n## 4  PD1    FALSE PDCD1 /// SNCA /// SPATA2\n## 5 PDL1    FALSE                     CD274"},{"path":"gene-id-conversion-1.html","id":"genesymbolthesarus-vs-transid","chapter":"4 Gene ID conversion","heading":"4.5.2 GeneSymbolThesarus vs transId","text":"GeneSymbolThesarus function Seurat finds current gene symbols HUGO Gene Nomenclature Committee (HGNC). search online speed fast.Seurat returns one records.","code":"\nlibrary(Seurat)\nstart <- Sys.time()\nseurat_res <- Seurat::GeneSymbolThesarus(symbols = id)\nend <- Sys.time()\n(end - start)## Time difference of 8.72366 secs\nseurat_res## NULL"},{"path":"gene-id-conversion-1.html","id":"alias2symbol-vs-transid","chapter":"4 Gene ID conversion","heading":"4.5.3 alias2Symbol vs transId","text":"alias2Symbol function limma depends organism annotation package Bioconductor.seems alias2Symbol result remains disorder input id, may cause misunderstanding users, transId keeps original order (user want get one--one match, just pass unique = TRUE function).","code":"\nlimma_res <- limma::alias2Symbol(id, species = \"Hs\")\n# compare with transId result\nid## [1] \"TBET\" \"B220\" \"BCC7\" \"PD1\"  \"PDL1\"\nlimma_res## [1] \"CD274\"  \"TBX21\"  \"PDCD1\"  \"PTPRC\"  \"SNCA\"   \"TP53\"   \"SPATA2\"\ntransid_res$symbol## [1] \"TBX21\"  \"PTPRC\"  \"TP53\"   \"PDCD1\"  \"SNCA\"   \"SPATA2\" \"CD274\""},{"path":"protein-id-conversion-1.html","id":"protein-id-conversion-1","chapter":"5 Protein ID conversion","heading":"5 Protein ID conversion","text":"handled proteomics metabolomics data (e.g. mass spectrometry), may need convert protein gene id downstream analysis.","code":""},{"path":"protein-id-conversion-1.html","id":"protein-example-data","chapter":"5 Protein ID conversion","heading":"5.1 Example data","text":"example, data article Dataset proteomic analysis rat, mouse, human liver microsomes S9 fractions , get rat proteomic analysis dataFirstly, take look data:second column rat protein id, third one gene name.","code":"\ncolnames(rat_prodata)## [1] \"GI\"       \"Acc\"      \"Gene\"     \"Name\"     \"GRAVY\"    \"Length\"   \"Sequence\"\nhead(rat_prodata, 5)##       GI    Acc      Gene\n## 1 112774 P27364 3BHS5_RAT\n## 2 112889 P17475  A1AT_RAT\n## 3 112893 P14046  A1I3_RAT\n## 4 112987 P00507  AATM_RAT\n## 5 113016 P15650 ACADL_RAT\n##                                                        Name      GRAVY Length\n## 1                3 beta-hydroxysteroid dehydrogenase type 5 -0.2168901    373\n## 2                                    Alpha-1-antiproteinase -0.1576642    411\n## 3                                       Alpha-1-inhibitor 3 -0.2164523   1477\n## 4                 Aspartate aminotransferase, mitochondrial -0.2295349    430\n## 5 Long-chain specific acyl-CoA dehydrogenase, mitochondrial -0.2227907    430\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Sequence\n## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 MPGWSCLVTGAGGFLGQRIVQMLVQEKELQEVRVLYRTFSPKHKEELSKLQTKAKVTVLRGDIVDAQFLRRACQGMSVIIHTAAALDIAGFLPRQTILDVNVKGTQLLLDACVEASVPAFIYSSSTGVAGPNSYKETILNDREEEHRESTWSNPYPYSKRMAEKAVLAANGSILKNGGTFHTCALRLPFIYGEESQIISTMVNRALKNNSIIKRHATFSIANPVYVGNAAWAHILAARGLRDPEKSQSIQGQFYYISDDTPHQSYDDLNYTLSKEWGFCLDSSWSLPLPLLYWLAFLLETVSFLLRPFYNYRPPFNRFMVTILNSVFTISYKKAQRDLGYEPLVSWEEAKQKTSEWIGTLVEQHRETLDTKSQ\n## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           MAPSISRGLLLLAALCCLAPSFLAEDAQETDTSQQDQSPTYRKISSNLADFAFSLYRELVHQSNTSNIFFSPMSITTAFAMLSLGSKGDTRKQILEGLEFNLTQIPEADIHKAFHHLLQTLNRPDSELQLNTGNGLFVNKNLKLVEKFLEEVKNNYHSEAFSVNFADSEEAKKVINDYVEKGTQGKIVDLMKQLDEDTVFALVNYIFFKGKWKRPFNPEHTRDADFHVDKSTTVKVPMMNRLGMFDMHYCSTLSSWVLMMDYLGNATAIFLLPDDGKMQHLEQTLTKDLISRFLLNRQTRSAILYFPKLSISGTYNLKTLLSSLGITRVFNNDADLSGITEDAPLKLSQAVHKAVLTLDERGTEAAGATVVEAVPMSLPPQVKFDHPFIFMIVESETQSPLFVGKVIDPTR\n## 3 MKKDREAQLCLFSALLAFLPFASLLNGNSKYMVLVPSQLYTETPEKICLHLYHLNETVTVTASLISQRGTRKLFDELVVDKDLFHCVSFTIPRLPSSEEEESLDINIEGAKHKFSERRVVLVKNKESVVFVQTDKPMYKPGQSVKFRVVSMDKNLHPLNELFPLAYIEDPKMNRIMQWQDVKTENGLKQLSFSLSAEPIQGPYKIVILKQSGVKEEHSFTVMEFVLPRFGVDVKVPNAISVYDEIINVTACATYTYGKPVPGHVKISLCHGNPTFSSETKSGCKEEDSRLDNNGCSTQEVNITEFQLKENYLKMHQAFHVNATVTEEGTGSEFSGSGRIEVERTRNKFLFLKADSHFRHGIPFFVKVRLVDIKGDPIPNEQVLIKARDAGYTNATTTDQHGLAKFSIDTNGISDYSLNIKVYHKEESSCIHSSCTAERHAEAHHTAYAVYSLSKSYIYLDTEAGVLPCNQIHTVQAHFILKGQVLGVLQQIVFHYLVMAQGSILQTGNHTHQVEPGESQVQGNFALEIPVEFSMVPVAKMLIYTILPDGEVIADSVKFQVEKCLRNKVHLSFSPSQSLPASQTHMRVTASPQSLCGLRAVDQSVLLQKPEAELSPSLIYDLPGMQDSNFIASSNDPFEDEDYCLMYQPIAREKDVYRYVRETGLMAFTNLKIKLPTYCNTDYDMVPLAVPAVALDSSTDRGMYESLPVVAVKSPLPQEPPRKDPPPKDPVIETIRNYFPETWIWDLVTVNSSGVTELEMTVPDTITEWKAGALCLSNDTGLGLSSVASFQAFQPFFVELTMPYSVIRGEAFTLKATVLNYLPTSLPMAVLLEASPDFTAVPVENNQDSYCLGANGRHTSSWLVTPKSLGNVNFSVSAEARQSPGPCGSEVATVPETGRKDTVVKVLIVEPEGIKKEHTFSSLLCASDAELSETLSLLLPPTVVKDSARAHFSVMGDILSSAIKNTQNLIQMPYGCGEQNMVLFAPNIYVLKYLNETQQLTEKIKSKALGYLRAGYQRELNYKHKDGSYSAFGDHNGQGQGNTWLTAFVLKSFAQARAFIFIDESHITDAFTWLSKQQKDSGCFRSSGSLLNNAMKGGVDDEITLSAYITMALLESSLPDTDPVVSKALSCLESSWENIEQGGNGSFVYTKALMAYAFALAGNQEKRNEILKSLDKEAIKEDNSIHWERPQKPTKSEGYLYTPQASSAEVEMSAYVVLARLTAQPAPSPEDLALSMGTIKWLTKQQNSYGGFSSTQDTVVALDALSKYGAATFSKSQKTPSVTVQSSGSFSQKFQVDKSNRLLLQQVSLPYIPGNYTVSVSGEGCVYAQTTLRYNVPLEKQQPAFALKVQTVPLTCNNPKGQNSFQISLEISYMGSRPASNMVIADVKMLSGFIPLKPTVKKLERLGHVSRTEVTTNNVLLYLDQVTNQTLSFSFIIQQDIPVKNLQPAIVKVYDYYETDEVAFAEYSSPCSSDDQNV\n## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        MALLHSGRVLSGMAAAFHPGLAAAASARASSWWTHVEMGPPDPILGVTEAFKRDTNSKKMNLGVGAYRDDNGKPYVLPSVRKAEAQIAGKNLDKEYLPIGGLADFCKASAELALGENSEVLKSGRFVTVQTISGTGALRVGASFLQRFFKFSRDVFLPKPSWGNHTPIFRDAGMQLQGYRYYDPKTCGFDFSGALEDISKIPEQSVLLLHACAHNPTGVDPRPEQWKEMAAVVKKKNLFAFFDMAYQGFASGDGDKDAWAVRHFIEQGINVCLCQSYAKNMGLYGERVGAFTVVCKDAEEAKRVESQLKILIRPLYSNPPLNGARIAATILTSPDLRKQWLQEVKGMADRIISMRTQLVSNLKKEGSSHNWQHITDQIGMFCFTGLKPEQVERLTKEFSVYMTKDGRISVAGVTSGNVGYLAHAIHQVTK\n## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        MAARLLLRSLRVLSARSATLPPPSARCSHSGAEARLETPSAKKLTDIGIRRIFSSEHDIFRESVRKFFQEEVIPYHEEWEKAGEVSRELWEKAGKQGLLGINIAEKHGGIGGDLLSTAVTWEEQAYSNCTGPGFSLHSDIVMPYIANYGTKEQIEQFIPQMTAGKCIGAIAMTEPGAGSDLQGVRTNAKRSGSDWILNGSKVFITNGWLSDLVIVVAVTNREARSPAHGISLFLVENGMKGFIKGKKLHKMGMKAQDTAELFFEDVRLPASALLGEENKGFYYLMQELPQERLLIADLAISACEFMFEETRNYVRQRKAFGKTVAHIQTVQHKLAELKTNICVTRAFVDSCLQLHETKRLDSASASMAKYWASELQNTVAYQCVQLHGGWGYMWEYPIAKAYVDARVQPIYGGTNEIMKELIARQIVSDS"},{"path":"protein-id-conversion-1.html","id":"protein-id-conversion-2","chapter":"5 Protein ID conversion","heading":"5.2 Id conversion","text":"convert protein id gene symbol compare original one.Maybe noticed gene names different original data. example, second one: A0JPQ8 called Alkmo , latest name Agmo.proteins new gene names like , may names now.see result : protein id P01835 replaced gene name NA.Venn plot shows primary protein ids changed gene names. users continue use old gene names, may lose latest gene information even enriched pathways.","code":"\nprotein_id <- rat_prodata[, \"Acc\"]\ngname <- transId(protein_id, \"symbol\", \"rat\", unique = T)\n\nnew_res <- merge(rat_prodata, gname,\n  by.x = \"Acc\", by.y = \"input_id\", all.x = T\n) %>%\n  dplyr::relocate(symbol, .after = Gene)\n\nhead(new_res, 5)##      Acc        GI      Gene       symbol\n## 1 A0FKI7 123797828 ACBD5_RAT        Acbd5\n## 2 A0JPQ8 158512263 ALKMO_RAT         Agmo\n## 3 A0JPQ9 134035401 CHID1_RAT LOC100911881\n## 4 A1L134 221222583  AUP1_RAT         Aup1\n## 5 A1L1J9 171704593  LMF2_RAT         Lmf2\n##                                           Name       GRAVY Length\n## 1 Acyl-CoA-binding domain-containing protein 5 -0.81245059    506\n## 2                  Alkylglycerol monooxygenase  0.23579418    447\n## 3        Chitinase domain-containing protein 1 -0.20229008    393\n## 4                 Ancient ubiquitous protein 1 -0.09902439    410\n## 5                   Lipase maturation factor 2  0.04757835    702\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Sequence\n## 1                                                                                                                                                                                                     MLFLSFYAGSWESWICCCCVIPVDRPWDRGRRWQLEMADTRSVYETRFEAAVKVIQSLPKNGSFQPTNEMMLRFYSFYKQATEGPCKLSRPGFWDPIGRYKWDAWSSLGDMTKEEAMIAYVEEMKKIIETMPMTEKVEELLHVIGPFYEIVEDKKNSKSSDLTSDLGNVLTSSNAKAVNGKAESSDSGAESEEEEAQEELKGAEQSGSDDKKMMTKSTDKNLEIIVTNGYKDSFAQDSDIHTDSSRSARRSEDKKPTDQSSQQTGNTVLCVHQDTNEDPGEDASGVHHLTSDSDSEVYCDSMEQFGQEEYYLGGDPAQHLEGSGFCEDAQLSPGNGSIGKMQMRAVKGKGEVKHGGEDGRSSSGTPHREKRGGESEDISGVRRGRGHRMPHLSEGTKGRQVGSGGDGERWGSDRGSRGSLNEQIALVLIRLQEDMQNVLQRLHKLETLTASQAKLSWQTSNQPSSQRPSWWPFEMSPGALAFAIIWPFIAQWLVHLYYQRRRRKLN\n## 2                                                                                                                                                                                                                                                                MRNPGAQDNVSVSQGMRAMFYMMKPSETAFQTVEEVPDYVKKATPFFIFLILLELVVSWILKGKPSGRLDDILTSMSAGVVSRLPNLFFRSLEVTSYIYIWENYRVCELPWDSPWTWYLTFLGVDFGYYWFHRMAHEINIIWAAHQAHHSSEDYNLSTALRQSVLQQYSSWVFYCPLALFVPPSVFAVHIQFNLLYQFWIHTEVIRTLGPLELVLNTPSHHRVHHGRNRYCIDKNYAGTLIIWDRIFGTFEAENEQVIYGLTHPIGTFEPFKVQFHHLLYIWTTFWATPGFCHKFSVLFKGPGWGPGKPRLGLSEEIPEVTGQEVPFTSSASQFLKIYAVLQFAVMLVFYEETFANTAVLSQVTILLRICFIILTLTSIGFLLDQRPKAAIVETLRCLLFLTLYRFGHLKPLIESLSFAFEIFFSVCIAFWGVRSITHLASGSWKKP\n## 3                                                                                                                                                                                                                                                                                                                      MWPLLHVLWLALVCGSVHTTLSKSDAKKAASKTLLEKTQFSDKPVQDRGLVVTDIKAEDVVLEHRSYCSARARERNFAGEVLGYVTPWNSHGYDVAKVFGSKFTQISPVWLQLKRRGREMFEITGLHDVDQGWMRAVKKHAKGVRIVPRLLFEDWTYDDFRSVLDSEDEIEELSKTVVQVAKNQHFDGFVVEVWSQLLSQKHVGLIHMLTHLAEALHQARLLVILVIPPAVTPGTDQLGMFTHKEFEQLAPILDGFSLMTYDYSTSQQPGPNAPLSWIRACVQVLDPKSQWRSKILLGLNFYGMDYAASKDAREPVIGARYIQTLKDHRPRVVWDSQAAEHFFEYKKNRGGRHVVFYPTLKSLQVRLELARELGVGVSIWELGQGLDYFYDLL\n## 4                                                                                                                                                                                                                                                                                                     MEPPPAPGPERLFDSHRLPSDGFLLLALLLYAPVGLCLLVLRLFLGLHVFLVSCALPDSVLRRFVVRTMCAVLGLVARQEDSGLRDHRVRVLISNHVTPFDHNIVNLLTTCSTPLLNSPPSFVCWSRGFMEMDRRVELVESLKKFCASTRLPPTPLLLFPEEEATNGREGLLRFSSWPFSIQDVVQPLTLQVQRPLVSVTVSDASWVSELLWSLFVPFTVYQVRWLHPIRRQLGEENEEFALRVQQLVAKELGQIGTRLTPADKAEHMKRQRHPRLRPQSVQSSFPSPPSPSSDVQLTILAQRVKEVLPHVPLNVIQRDLARTGCVDLTITNLLEGAVAFMPEDVTEGSQSLPTASAPKFPSSGLVTPQPTALTFAKSSWARQESLQERKQALYEYARRRFRERQAQEAE\n## 5 MASARVPQQLFLQGVAAVYLFAFASLYTQIPGLYGPEGILPARRTLRPQGKGRWQQLWETPTILWEAPRLGLDTAQGLDLLTLLGTVLALGALLLNSLRHPFIYLLLWAAYLSACQVGQVFLYFQWDSLLLETGFLAILVAPLRRPSKHKIPQGGLAGALPHEDLPFWLVRWLLFRLMFASGVVKLTSRCPAWWGLTALTYHYETQCLPTPAAWFAHHLPVWLHRLSVVATFLIEIAVPPLFFAPIRRLRLSAFYAQALLQILIIITGNYNFFNLLTLVLTTALLDDRHLSAEPELRCHKKMPTSWPKTLLTSLSLMLELTVYGLLAYGTIYYFGLEVDWQQQIVLSKTTFTFHQFSQWLKMVTLPTVWLGTASLAWELLIALWRWIQVQGWSRKFFAGIQLSVLGTATVFLFLISLVPYSYVEPGTHGRLWTGAHRLFSSVEHLQLANSYGLFRRMTGLGGRPEVVLEGSHDGHHWTEIEFMYKPGNVSRPPPFLIPHQPRLDWQMWFAALGPHTHSPWFTSLVLRLLQGKEPVIRLIQNQVANYPFREQPPTYLRAQRYKYWFSKPGDQSRWWHRQWVEEFFPSVSLGDPTLETLLQQFGLKDKSPPRARSSKNALAQTLNWVRAQLSPLEPSILLWGLLGAVVAIRVVRTLLTPRPLQSSKQTREEKRKQAPKKDSRAVSEQTAPNSNSNGSWAPRRKK\nold_name <- unique(new_res$Gene) %>%\n  stringr::str_remove_all(\"_RAT\")\nnew_name <- unique(toupper(new_res$symbol))\nnew_res[which(is.na(new_res$symbol)), ] %>%\n  dplyr::select(Acc, Gene, symbol)##        Acc      Gene symbol\n## 103 P01835  KACB_RAT   <NA>\n## 215 P0C169 H2A1C_RAT   <NA>\n## 305 P16391  HA12_RAT   <NA>\n## 485 P50169  RDH3_RAT   <NA>\n## 544 P62161  CALM_RAT   <NA>\n## 620 P81828   UP2_RAT   <NA>\n## 623 P83121   UP3_RAT   <NA>\n## 950 Q6P6G2 CF089_RAT   <NA>\nplotVenn(list(old_name = old_name, new_name = na.omit(new_name)))"},{"path":"probe-id-conversion-1.html","id":"probe-id-conversion-1","chapter":"6 Probe ID conversion","heading":"6 Probe ID conversion","text":"Probes used measure expression level many genes. getting micro array data, first important thing downstream analysis maybe probe id conversion.Ensembl database regularly maps probes sets latest set transcript models using pipeline., transProbe utilizes Ensembl --date annotation datasets join together genekitr functions fluently.Notice: now support human data","code":""},{"path":"probe-id-conversion-1.html","id":"transProbe-supported-platforms","chapter":"6 Probe ID conversion","heading":"6.1 Supported platforms","text":"36 probe platforms include Affymetrix, Agilent, Illumina, Codelink Phalanx.","code":"\nDT::datatable(hsapiens_probe_platform, options = list(pageLength = 10))"},{"path":"probe-id-conversion-1.html","id":"probe-basic-usage","chapter":"6 Probe ID conversion","heading":"6.2 Basic usage","text":"transProbe four arguments:id: probe idtransTo: conversion target type. User select one “symbol”, “entrez”, “ensembl” “uniprot”.org: human (default)platform: Probe platform. given, program detect automatically.","code":"\ndata(deg, package = \"genekitr\")\nprobes <- deg$probe_id\n\nres <- transProbe(probes, transTo = \"ensembl\", org = \"human\")\nhead(probes)## [1] \"8144866\" \"8066431\" \"8022674\" \"7925531\" \"8081358\" \"7979931\"\nhead(res)## # A tibble: 6 × 2\n## # Groups:   probe_id [6]\n##   probe_id ensembl        \n##   <chr>    <chr>          \n## 1 8144866  ENSG00000156006\n## 2 8066431  ENSG00000196839\n## 3 8022674  ENSG00000170558\n## 4 7925531  ENSG00000275199\n## 5 8081358  ENSG00000256628\n## 6 7979931  ENSG00000133997"},{"path":"probe-id-conversion-1.html","id":"convert-probe-types","chapter":"6 Probe ID conversion","heading":"6.3 Convert to more than one type","text":"User define transTo many types:Let’s take first record example:[ENSG00000228794](https://www.ensembl.org/id/ENSG00000228794) 38 transcripts.look second transcript ENST00000445118.7, probe 7896759 listed AFFY HuGene-1_0-st-v1 database.","code":"\nres2 <- transProbe(probes, transTo = c(\"ensembl\",\"symbol\"), org = \"human\")\nhead(res2)##       probe_id         ensembl     symbol\n## 9023   8144866 ENSG00000156006       NAT2\n## 15007  8066431 ENSG00000196839        ADA\n## 11595  8022674 ENSG00000170558       CDH2\n## 17512  7925531 ENSG00000275199       AKT3\n## 17126  8081358 ENSG00000256628 ZBTB11-AS1\n## 6218   7979931 ENSG00000133997       MED6"},{"path":"ora-go-analysis-1.html","id":"ora-go-analysis-1","chapter":"7 ORA GO analysis","heading":"7 ORA GO analysis","text":"paper “Urgent need consistent standards functional enrichment analysis” mentioned, popular functional enrichment tools can classified two main categories: (1) -representation analysis (ORA) (2) functional class scoring (FCS) .According paper “-representation correlation analysis (ORCA): method identifying associations variable sets”:-representation analysis (ORA) simple method objectively deciding whether set variables known suspected biological relevance, gene set pathway, prevalent set variables interest expect chance.ORA usually procedures:Identify features, mRNA, proteins microarray probes, considered “differentially expressed” two conditionsDetermine number differentially expressed features pathwayFor pathway, using hypergeometric distribution calculate probability value ( P -value) obtaining number differentially expressed features background list features","code":""},{"path":"ora-go-analysis-1.html","id":"go-introduction","chapter":"7 ORA GO analysis","heading":"7.1 GO intruduction","text":"According Wikipedia, “Ontologies consist detectable directly observable representations things relationships things.”GO short Gene Ontology. GO analysis find associations gene products GO terms， three domains:Biological Processes (BP)\nbiological process represents specific objective organism genetically programmed achieve.\nbiological process represents specific objective organism genetically programmed achieve.Molecular Functions (MF)\nmolecular process can carried action single macromolecular machine, usually via direct physical interactions molecular entities.\nmolecular process can carried action single macromolecular machine, usually via direct physical interactions molecular entities.Cellular Components (CC)\nlocation, relative cellular compartments structures, occupied macromolecular machine carries molecular function.\nlocation, relative cellular compartments structures, occupied macromolecular machine carries molecular function.GO terms built directed acyclic graph parent-child relationship.comprehensive introduction GO, may visit: https://advaitabio.com/faq-items/understanding-gene-ontology/ http://geneontology.org/docs/ontology-documentation/","code":""},{"path":"ora-go-analysis-1.html","id":"go-basic-usage","chapter":"7 ORA GO analysis","heading":"7.2 Basic usage","text":"genGO built clusterProfiler::enrichGO optimizes analysis process make better understanding.simplest arguments :id: gene id entrez, ensembl, symbol (alias also accepted) uniprotorg: organism (genekitr::biocOrg_name)ont: ontology “bp”, “mf”, “cc” “”pvalueCutoffqvalueCutoffIf user proteomics data, protein IDs directly GO analysis instead gene conversion.\nuse data : rat protein example dataExcept GO enrichment result, protein IDs also mapped gene symbols easy understanding.","code":"\ndata(geneList, package = \"genekitr\")\nid <- names(geneList)[abs(geneList) > 2]\nego <- genGO(id,\n  org = \"human\",\n  ont = \"bp\",\n  pvalueCutoff = 0.01,\n  qvalueCutoff = 0.01\n)\nhead(ego)##              Hs_BP_ID\n## GO:0050673 GO:0050673\n## GO:0006260 GO:0006260\n## GO:0050678 GO:0050678\n## GO:0010165 GO:0010165\n## GO:1901992 GO:1901992\n## GO:1901989 GO:1901989\n##                                                           Description\n## GO:0050673                              epithelial cell proliferation\n## GO:0006260                                            DNA replication\n## GO:0050678                regulation of epithelial cell proliferation\n## GO:0010165                                          response to X-ray\n## GO:1901992 positive regulation of mitotic cell cycle phase transition\n## GO:1901989         positive regulation of cell cycle phase transition\n##             GeneRatio   BgRatio       pvalue     p.adjust       qvalue\n## GO:0050673 0.13821138 453/18866 6.263837e-09 1.770787e-05 1.356945e-05\n## GO:0006260 0.10569106 273/18866 2.730876e-08 3.860093e-05 2.957970e-05\n## GO:0050678 0.11382114 395/18866 3.012571e-07 2.838847e-04 2.175394e-04\n## GO:0010165 0.04065041  32/18866 1.898488e-06 1.341756e-03 1.028181e-03\n## GO:1901992 0.05691057  94/18866 2.698729e-06 1.525861e-03 1.169260e-03\n## GO:1901989 0.05691057 110/18866 7.698650e-06 3.461411e-03 2.652461e-03\n##                                                                                             geneID\n## GO:0050673 5176/26471/3488/6591/8549/3725/6657/4208/407007/6422/29128/595/7039/7099/374/3690/10468\n## GO:0006260                  3725/5427/157570/641/5888/6241/8318/9156/9134/55388/63967/51514/374393\n## GO:0050678                 5176/26471/6591/3725/6657/4208/407007/6422/29128/595/7039/7099/374/3690\n## GO:0010165                                                                  6422/641/5888/595/7516\n## GO:1901992                                                 407007/113130/595/407006/8318/993/51514\n## GO:1901989                                                 407007/113130/595/407006/8318/993/51514\n##                                                                                                geneID_symbol\n## GO:0050673 SERPINF1/NUPR1/IGFBP5/SNAI2/LGR5/JUN/SOX2/MEF2C/MIR222/SFRP1/UHRF1/CCND1/TGFA/TLR4/AREG/ITGB3/FST\n## GO:0006260                           JUN/POLE2/ESCO2/BLM/RAD51/RRM2/CDC45/EXO1/CCNE2/MCM10/CLSPN/DTL/FAM111B\n## GO:0050678                 SERPINF1/NUPR1/SNAI2/JUN/SOX2/MEF2C/MIR222/SFRP1/UHRF1/CCND1/TGFA/TLR4/AREG/ITGB3\n## GO:0010165                                                                       SFRP1/BLM/RAD51/CCND1/XRCC2\n## GO:1901992                                                        MIR222/CDCA5/CCND1/MIR221/CDC45/CDC25A/DTL\n## GO:1901989                                                        MIR222/CDCA5/CCND1/MIR221/CDC45/CDC25A/DTL\n##            Count FoldEnrich RichFactor\n## GO:0050673    17   5.756062 0.03752759\n## GO:0006260    13   7.303910 0.04761905\n## GO:0050678    14   5.436328 0.03544304\n## GO:0010165     5  23.965955 0.15625000\n## GO:1901992     7  11.422072 0.07446809\n## GO:1901989     7   9.760680 0.06363636\npro_id <- rat_prodata$Acc\nhead(pro_id, 10)##  [1] \"P27364\" \"P17475\" \"P14046\" \"P00507\" \"P15650\" \"P08503\" \"P16638\" \"P18484\"\n##  [9] \"P06757\" \"P24483\"\nrat_ego <- genGO(pro_id[1:100], \n                 org = 'rat', \n                 ont = 'bp',\n                 pvalueCutoff = 0.01, \n                 qvalueCutoff = 0.01)\n\nhead(rat_ego)##              Rn_BP_ID                              Description GeneRatio\n## GO:0006631 GO:0006631             fatty acid metabolic process 0.3218391\n## GO:0120254 GO:0120254      olefinic compound metabolic process 0.2068966\n## GO:0033559 GO:0033559 unsaturated fatty acid metabolic process 0.1954023\n## GO:0001676 GO:0001676  long-chain fatty acid metabolic process 0.1839080\n## GO:0009410 GO:0009410          response to xenobiotic stimulus 0.1839080\n## GO:0006805 GO:0006805             xenobiotic metabolic process 0.1724138\n##              BgRatio       pvalue     p.adjust       qvalue\n## GO:0006631 463/18067 1.528743e-23 3.227175e-20 2.528057e-20\n## GO:0120254 132/18067 1.339466e-21 1.413807e-18 1.107527e-18\n## GO:0033559 138/18067 1.172308e-19 8.249144e-17 6.462093e-17\n## GO:0001676 117/18067 2.677336e-19 1.412964e-16 1.106867e-16\n## GO:0009410 131/18067 1.747526e-18 7.378055e-16 5.779712e-16\n## GO:0006805 116/18067 9.145398e-18 3.217656e-15 2.520600e-15\n##                                                                                                                                                                                                         geneID\n## GO:0006631 P15650/P08503/P16638/P01015/P07872/P01026/P20816/P18125/P15149/P13107/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P18886/P11030/P23457/P14604/P07896/P02692/P04905/P08010/P08009/P04906\n## GO:0120254                                                                       P27364/P20816/P15149/P13107/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P11715/P23457/P04905/P08010/P08009/P04906\n## GO:0033559                                                                              P07872/P20816/P15149/P13107/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P23457/P04905/P08010/P08009/P04906\n## GO:0001676                                                                                     P15650/P20816/P15149/P13107/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P04905/P08010/P08009/P04906\n## GO:0009410                                                                                     P15149/P13107/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P19468/P04903/P04905/P08010/P08009/P04906\n## GO:0006805                                                                                            P15149/P13107/P05179/P08683/P11510/P20814/P19225/P10633/P10634/P12939/P04903/P04905/P08010/P08009/P04906\n##                                                                                                                                                                                geneID_symbol\n## GO:0006631 Acadl/Acadm/Acly/Agt/Acox1/C3/Cyp4a2/Cyp7a1/Cyp2a2/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Cpt2/Dbi/Akr1c9/Echs1/Ehhadh/Fabp1/Gstm1/Gstm2/Gstm7/Gstp1\n## GO:0120254                                                   Hsd3b5/Cyp4a2/Cyp2a2/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Cyp17a1/Akr1c9/Gstm1/Gstm2/Gstm7/Gstp1\n## GO:0033559                                                            Acox1/Cyp4a2/Cyp2a2/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Akr1c9/Gstm1/Gstm2/Gstm7/Gstp1\n## GO:0001676                                                                   Acadl/Cyp4a2/Cyp2a2/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Gstm1/Gstm2/Gstm7/Gstp1\n## GO:0009410                                                                     Cyp2a2/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Gclc/Gsta2/Gstm1/Gstm2/Gstm7/Gstp1\n## GO:0006805                                                                          Cyp2a2/Cyp2b3/Cyp2c7/Cyp2c11/Cyp2c12/Cyp2c13/Cyp2c70/Cyp2d1/Cyp2d2/Cyp2d10/Gsta2/Gstm1/Gstm2/Gstm7/Gstp1\n##            Count FoldEnrich RichFactor\n## GO:0006631    28   12.55868 0.06047516\n## GO:0120254    18   28.31818 0.13636364\n## GO:0033559    17   25.58213 0.12318841\n## GO:0001676    16   28.39886 0.13675214\n## GO:0009410    16   25.36387 0.12213740\n## GO:0006805    15   26.85345 0.12931034"},{"path":"ora-go-analysis-1.html","id":"go-additional-arguments","chapter":"7 ORA GO analysis","heading":"7.2.1 Additional arguments","text":"pAdjustMethod: choose “holm”, “hochberg”, “hommel”, “bonferroni”, “BH”, “”, “fdr”, “none”minGSSize: Minimal size gene set analysis. Default 10. Pathway less ten genes omitted (e.g. GO:0062196 child term 8-gene bottom directed acyclic graph).maxGSSize: Maximal size. Default 500. pathway 500 genes omitted (e.g. GO:0007049 1796 genes parent nodes top directed acyclic graph).universe: uses background genes, set universe. Otherwise, program take genes orgDb annotation package (e.g. org.Hs.eg.db).","code":""},{"path":"ora-go-analysis-1.html","id":"go-new-features","chapter":"7 ORA GO analysis","heading":"7.2.2 New features","text":"input id symbol, genGO convert symbol easy understanding.need sepcify input id type, genGO allocate automatically.genGO sets four measurement aspects: “Count”, “GeneRatio”, “FoldEnrichment” “RichFactor”.\nBg Ratio: Total number specific pathway gene/ Universal gene numbers (e.g., human protein-coding genes)\nGene Ratio: Genes interest specific pathway/gene interest (e.g., differentially expressed genes)\nFold Enrichment: GeneRatio / BgRatio\nRich Factor: Genes interest specific pathway/ Total number specific pathway gene\nBg Ratio: Total number specific pathway gene/ Universal gene numbers (e.g., human protein-coding genes)Gene Ratio: Genes interest specific pathway/gene interest (e.g., differentially expressed genes)Fold Enrichment: GeneRatio / BgRatioRich Factor: Genes interest specific pathway/ Total number specific pathway geneReturn data frame format easy select export interested pathways","code":""},{"path":"ora-go-analysis-1.html","id":"go-group-enrichment","chapter":"7 ORA GO analysis","heading":"7.3 Group enrichment analysis","text":"multi-group comparison (e.g. -regulated genes), user needs specify gene groups set group_list argument:","code":""},{"path":"ora-go-analysis-1.html","id":"comparison-with-one-group","chapter":"7 ORA GO analysis","heading":"7.3.1 Comparison with one group:","text":"","code":"\nid2 <- c(head(names(geneList), 50), tail(names(geneList), 50))\none_group <- list(group1 = c(rep(\"up\", 50), rep(\"down\", 50)))\n\ngego1 <- genGO(id2,\n  group_list = one_group,\n  org = \"human\",\n  ont = \"bp\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)\nhead(gego1, 5)##   Cluster group1   Hs_BP_ID                       Description  GeneRatio\n## 1    down   down GO:0000217   DNA secondary structure binding 0.06250000\n## 2    down   down GO:0008094     DNA-dependent ATPase activity 0.08333333\n## 3    down   down GO:0140097 catalytic activity, acting on DNA 0.10416667\n## 4    down   down GO:0003697       single-stranded DNA binding 0.08333333\n## 5    down   down GO:0000400     four-way junction DNA binding 0.04166667\n##     BgRatio       pvalue   p.adjust      qvalue                   geneID\n## 1  34/18352 9.491897e-05 0.01079486 0.007262958           641/7516/63967\n## 2 108/18352 1.808164e-04 0.01079486 0.007262958      54821/641/5888/7516\n## 3 209/18352 2.099890e-04 0.01079486 0.007262958 54821/5427/641/5888/9156\n## 4 114/18352 2.225745e-04 0.01079486 0.007262958      641/5888/8318/55388\n## 5  17/18352 8.884883e-04 0.03447335 0.023194220                 641/7516\n##                 geneID_symbol Count FoldEnrich RichFactor\n## 1             BLM/XRCC2/CLSPN     3   33.73529 0.08823529\n## 2      ERCC6L/BLM/RAD51/XRCC2     4   14.16049 0.03703704\n## 3 ERCC6L/POLE2/BLM/RAD51/EXO1     5    9.14673 0.02392344\n## 4       BLM/RAD51/CDC45/MCM10     4   13.41520 0.03508772\n## 5                   BLM/XRCC2     2   44.98039 0.11764706"},{"path":"ora-go-analysis-1.html","id":"comparison-with-more-than-one-group","chapter":"7 ORA GO analysis","heading":"7.3.2 Comparison with more than one group","text":"two group conditions (e.g. /regulated; treatment serial time points), user needs set two-group list.","code":"\ntwo_groups <- list(\n  exp_group = c(rep(\"up\", 50), rep(\"down\", 50)),\n  time_group = c(rep(\"time1\", 40), rep(\"time2\", 60))\n)\ngego2 <- genGO(id2,\n  group_list = two_groups,\n  org = \"human\",\n  ont = \"bp\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)\nhead(gego2, 5)##      Cluster exp_group time_group   Hs_BP_ID                       Description\n## 1 down.time2      down      time2 GO:0000217   DNA secondary structure binding\n## 2 down.time2      down      time2 GO:0008094     DNA-dependent ATPase activity\n## 3 down.time2      down      time2 GO:0140097 catalytic activity, acting on DNA\n## 4 down.time2      down      time2 GO:0003697       single-stranded DNA binding\n## 5 down.time2      down      time2 GO:0000400     four-way junction DNA binding\n##    GeneRatio   BgRatio       pvalue   p.adjust      qvalue\n## 1 0.06250000  34/18352 9.491897e-05 0.01079486 0.007262958\n## 2 0.08333333 108/18352 1.808164e-04 0.01079486 0.007262958\n## 3 0.10416667 209/18352 2.099890e-04 0.01079486 0.007262958\n## 4 0.08333333 114/18352 2.225745e-04 0.01079486 0.007262958\n## 5 0.04166667  17/18352 8.884883e-04 0.03447335 0.023194220\n##                     geneID               geneID_symbol Count FoldEnrich\n## 1           641/7516/63967             BLM/XRCC2/CLSPN     3   33.73529\n## 2      54821/641/5888/7516      ERCC6L/BLM/RAD51/XRCC2     4   14.16049\n## 3 54821/5427/641/5888/9156 ERCC6L/POLE2/BLM/RAD51/EXO1     5    9.14673\n## 4      641/5888/8318/55388       BLM/RAD51/CDC45/MCM10     4   13.41520\n## 5                 641/7516                   BLM/XRCC2     2   44.98039\n##   RichFactor\n## 1 0.08823529\n## 2 0.03703704\n## 3 0.02392344\n## 4 0.03508772\n## 5 0.11764706"},{"path":"ora-go-analysis-1.html","id":"go-advanced-usage","chapter":"7 ORA GO analysis","heading":"7.4 Advanced usage","text":"","code":""},{"path":"ora-go-analysis-1.html","id":"different-types-of-input-and-backgroud-genes","chapter":"7 ORA GO analysis","heading":"7.4.1 Different types of input and backgroud genes","text":"genGO utilize transId make gene typeIn example, set input id symbols background id Entrez.result, input gene alias also recognized converted official symbol (e.g. BCC7):","code":"\nsymbol_id <- transId(id2, transTo = \"symbol\", unique = T) %>% dplyr::pull(symbol)\nsymbol_id <- c(symbol_id, \"BCC7\", \"PD1\", \"PDL1\")\nhead(symbol_id)## [1] \"CD36\"       \"DCT\"        \"PRUNE2\"     \"ST6GALNAC2\" \"TCN1\"      \n## [6] \"CD24\"\nhead(names(geneList))## [1] \"948\"       \"1638\"      \"158471\"    \"10610\"     \"6947\"      \"100133941\"\ndiy_ego <- genGO(symbol_id,\n  org = \"human\",\n  ont = \"bp\",\n  pvalueCutoff = 0.01,\n  qvalueCutoff = 0.01,\n  pAdjustMethod = \"fdr\",\n  minGSSize = 5,\n  maxGSSize = 2000,\n  universe = names(geneList)\n)\n\nhead(diy_ego, 5)##              Hs_BP_ID                              Description  GeneRatio\n## GO:0010165 GO:0010165                        response to X-ray 0.05882353\n## GO:0006260 GO:0006260                          DNA replication 0.11764706\n## GO:0050673 GO:0050673            epithelial cell proliferation 0.13725490\n## GO:0006974 GO:0006974 cellular response to DNA damage stimulus 0.18627451\n## GO:0033554 GO:0033554              cellular response to stress 0.30392157\n##               BgRatio       pvalue     p.adjust       qvalue\n## GO:0010165   29/16024 2.418982e-08 7.849597e-05 5.609492e-05\n## GO:0006260  261/16024 9.980090e-08 1.619270e-04 1.157165e-04\n## GO:0050673  413/16024 3.461281e-07 3.743953e-04 2.675510e-04\n## GO:0006974  801/16024 6.078077e-07 4.853426e-04 3.468363e-04\n## GO:0033554 1946/16024 7.478314e-07 4.853426e-04 3.468363e-04\n##                                                                                                                                                                                                 geneID\n## GO:0010165                                                                                                                                                            SFRP1/BLM/RAD51/CCND1/XRCC2/BCC7\n## GO:0006260                                                                                                                        POLE2/ESCO2/BLM/RAD51/RRM2/CDC45/EXO1/CCNE2/MCM10/CLSPN/FAM111B/BCC7\n## GO:0050673                                                                                                          SERPINF1/NUPR1/IGFBP5/SNAI2/LGR5/MIR222/SFRP1/UHRF1/CCND1/TGFA/TLR4/AREG/ITGB3/FST\n## GO:0006974                                                                              NUPR1/SNAI2/UHRF1/CDCA5/PMAIP1/POLE2/ESCO2/BLM/RAD51/CCND1/MIR221/XRCC2/CDC45/EXO1/DDIAS/IER3/MCM10/CLSPN/BCC7\n## GO:0033554 CD36/NUPR1/CYP1B1/SESN3/SNAI2/SLC38A3/FOLR1/CRYAB/TP53INP1/SLC1A1/MIR222/SFRP1/UHRF1/CDCA5/PMAIP1/POLE2/ESCO2/BLM/RAD51/CCND1/MIR221/XRCC2/TLR4/CDC45/EXO1/DDIAS/IER3/MCM10/CLSPN/ETV5/BCC7\n##                                                                                                                                                                                          geneID_symbol\n## GO:0010165                                                                                                                                                            SFRP1/BLM/RAD51/CCND1/XRCC2/TP53\n## GO:0006260                                                                                                                        POLE2/ESCO2/BLM/RAD51/RRM2/CDC45/EXO1/CCNE2/MCM10/CLSPN/FAM111B/TP53\n## GO:0050673                                                                                                          SERPINF1/NUPR1/IGFBP5/SNAI2/LGR5/MIR222/SFRP1/UHRF1/CCND1/TGFA/TLR4/AREG/ITGB3/FST\n## GO:0006974                                                                              NUPR1/SNAI2/UHRF1/CDCA5/PMAIP1/POLE2/ESCO2/BLM/RAD51/CCND1/MIR221/XRCC2/CDC45/EXO1/DDIAS/IER3/MCM10/CLSPN/TP53\n## GO:0033554 CD36/NUPR1/CYP1B1/SESN3/SNAI2/SLC38A3/FOLR1/CRYAB/TP53INP1/SLC1A1/MIR222/SFRP1/UHRF1/CDCA5/PMAIP1/POLE2/ESCO2/BLM/RAD51/CCND1/MIR221/XRCC2/TLR4/CDC45/EXO1/DDIAS/IER3/MCM10/CLSPN/ETV5/TP53\n##            Count FoldEnrich RichFactor\n## GO:0010165     6  32.503043 0.20689655\n## GO:0006260    12   7.222898 0.04597701\n## GO:0050673    14   5.325357 0.03389831\n## GO:0006974    19   3.726420 0.02372035\n## GO:0033554    31   2.502590 0.01593011\ndiy_ego$geneID[1]## [1] \"SFRP1/BLM/RAD51/CCND1/XRCC2/BCC7\"\ndiy_ego$geneID_symbol[1]## [1] \"SFRP1/BLM/RAD51/CCND1/XRCC2/TP53\""},{"path":"ora-go-analysis-1.html","id":"go-import","chapter":"7 ORA GO analysis","heading":"7.4.2 Import external data","text":"now, genekitr support importing panther result GeneOntology formatting genGO result.\nFigure 7.1: Import panther result.\nexample, save panther result “analysis.txt” pass importPanther. tidy data calculate fold enrichment rich factor.","code":"\npanther_res <- importPanther(\"data/analysis.txt\")\nhead(panther_res, 5)##           ID\n## 1 GO:1901295\n## 2 GO:0036520\n## 3 GO:0036304\n## 4 GO:1905066\n## 5 GO:0060844\n##                                                                                      Description\n## 1 regulation of canonical Wnt signaling pathway involved in cardiac muscle cell fate commitment \n## 2                                                       astrocyte-dopaminergic neuron signaling \n## 3                                                                  umbilical cord morphogenesis \n## 4                   regulation of canonical Wnt signaling pathway involved in heart development \n## 5                                                     arterial endothelial cell fate commitment \n##    GeneRatio      BgRatio upload_1 (42) upload_1 (expected)\n## 1 0.04761905 9.713925e-05             2                0.00\n## 2 0.07142857 1.457089e-04             3                0.01\n## 3 0.04761905 9.713925e-05             2                0.00\n## 4 0.04761905 9.713925e-05             2                0.00\n## 5 0.04761905 9.713925e-05             2                0.00\n##   upload_1 (over/under) FoldEnrich   pvalue   qvalue Count   RichFactor\n## 1                     +   490.2143 2.42e-05 9.30e-04     2 9.713925e-05\n## 2                     +   490.2143 1.56e-07 1.06e-05     3 1.457089e-04\n## 3                     +   490.2143 2.42e-05 9.28e-04     2 9.713925e-05\n## 4                     +   490.2143 2.42e-05 9.26e-04     2 9.713925e-05\n## 5                     +   490.2143 2.42e-05 9.23e-04     2 9.713925e-05"},{"path":"ora-go-analysis-1.html","id":"go-simplify","chapter":"7 ORA GO analysis","heading":"7.4.3 Simplify GO result","text":"simGO utilizes GOSemSim::goSim() calculate semantic similarity two GO terms, passes rrvgo::reduceSimMatrix() reduce redundant terms.Methods calculating similarity nodes: “Resnik”, “Lin”, “Rel”, “Jiang” , “Wang” “JC” (Jaccard similarity coefficient).Let’s look terms considered redundant:\nFigure 7.2: Term GO:0006974\nfirst record GO:0006974 actually child node GO:0033554, remained sim_go.","code":"\nsim_go <- simGO(diy_ego,sim_method = 'Wang')\ndim(diy_ego);dim(sim_go)## [1] 105  12## [1] 25 12\nhead(diy_ego$Hs_BP_ID[!diy_ego$Hs_BP_ID%in%sim_go$Hs_BP_ID])## [1] \"GO:0006974\" \"GO:0008283\" \"GO:0051093\" \"GO:0010212\" \"GO:0071479\"\n## [6] \"GO:0006979\""},{"path":"ora-go-analysis-1.html","id":"go-tools-comparsion","chapter":"7 ORA GO analysis","heading":"7.5 Comparison with other tools","text":"","code":""},{"path":"ora-go-analysis-1.html","id":"gengo-vs-enrichgo","chapter":"7 ORA GO analysis","heading":"7.5.1 genGO vs enrichGO","text":"input id contains gene alias, genGO invoke transId automatically convert gene alias symbol better explanation.check two results, may find clustp_res contains two genes: TET2 BRCA1, genekitr_res includes five genes.look deeper, may find six terms unique clustp_res, GO:0016571:Question1: terms omited genGO result?get adjusted p value, critical parameter number testing. simple explaination, adj.p = f * p (f>1) f related testing methods number tests.example, genGO recognizes five genes need five testings enrichGO includes two genes testing number less. directly causes adj.Pvalue “disappeared” terms becomes higher filtered cutoff 0.01.set cutoff higher(e.g. 0.05), still get terms:Question2: enrichGO recognize two genes?gene “BCC7”, “PD1” “PDL1” essential must related pathways.core reason actually gene aliases enrichGO set argument keyType = \"SYMBOL\" cause enrichGO accepts official symbols. function based organism annotation package (e.g. org.Hs.eg.db) accepts different types data:specifying keyType = 'ALIAS', program recognize gene alias, however still distinguish mixture symbol alias.","code":"\ncheck_gene <- c(\"BCC7\", \"PDL1\", \"PD1\", \"TET2\", \"BRCA1\")\n\ngenekitr_res <- genekitr::genGO(check_gene, ont = \"bp\", org = \"hs\", \n                                pvalueCutoff = 0.01, qvalueCutoff = 0.01)\n\nclustp_res <- clusterProfiler::enrichGO(check_gene,\n  OrgDb = \"org.Hs.eg.db\",\n  keyType = \"SYMBOL\",\n  pvalueCutoff = 0.01,\n  qvalueCutoff = 0.01,\n  ont = \"BP\"\n) %>% as.data.frame()\n\ndim(genekitr_res)## [1] 35 12\ndim(clustp_res)## [1] 11  9\nhead(genekitr_res,5)##              Hs_BP_ID                                         Description\n## GO:0070234 GO:0070234     positive regulation of T cell apoptotic process\n## GO:0070230 GO:0070230 positive regulation of lymphocyte apoptotic process\n## GO:2000108 GO:2000108  positive regulation of leukocyte apoptotic process\n## GO:0070232 GO:0070232              regulation of T cell apoptotic process\n## GO:0070231 GO:0070231                            T cell apoptotic process\n##            GeneRatio  BgRatio       pvalue     p.adjust       qvalue\n## GO:0070234       0.6 14/18866 3.250141e-09 2.141843e-06 5.234438e-07\n## GO:0070230       0.6 18/18866 7.283713e-09 2.399983e-06 5.865305e-07\n## GO:2000108       0.6 29/18866 3.258750e-08 7.158387e-06 1.749434e-06\n## GO:0070232       0.6 34/18866 5.334592e-08 8.788740e-06 2.147875e-06\n## GO:0070231       0.6 49/18866 1.640494e-07 2.162171e-05 5.284119e-06\n##                   geneID    geneID_symbol Count FoldEnrich RichFactor\n## GO:0070234 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   808.5429 0.21428571\n## GO:0070230 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   628.8667 0.16666667\n## GO:2000108 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   390.3310 0.10344828\n## GO:0070232 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   332.9294 0.08823529\n## GO:0070231 BCC7/PDL1/PD1 TP53/CD274/PDCD1     3   231.0122 0.06122449\nhead(clustp_res,5)##                    ID                      Description GeneRatio   BgRatio\n## GO:0051568 GO:0051568        histone H3-K4 methylation       2/2  57/18866\n## GO:0044728 GO:0044728 DNA methylation or demethylation       2/2  98/18866\n## GO:0034968 GO:0034968       histone lysine methylation       2/2 116/18866\n## GO:0006304 GO:0006304                 DNA modification       2/2 120/18866\n## GO:0018022 GO:0018022      peptidyl-lysine methylation       2/2 132/18866\n##                  pvalue    p.adjust       qvalue     geneID Count\n## GO:0051568 8.968633e-06 0.001892382 9.440666e-06 TET2/BRCA1     2\n## GO:0044728 2.670922e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\n## GO:0034968 3.748169e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\n## GO:0006304 4.012283e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\n## GO:0018022 4.858571e-05 0.002006407 1.000951e-05 TET2/BRCA1     2\nclustp_res$ID[!clustp_res$ID%in%genekitr_res$Hs_BP_ID ]## [1] \"GO:0016571\" \"GO:0006479\" \"GO:0008213\" \"GO:0043414\" \"GO:0032259\"\n## [6] \"GO:0018205\"\ngenekitr_res2 <- genekitr::genGO(check_gene, ont = \"bp\", org = \"hs\", \n                                pvalueCutoff = 0.05, qvalueCutoff = 0.05)\n\ntable(clustp_res$ID%in%genekitr_res2$Hs_BP_ID)## \n## TRUE \n##   11\nlibrary(org.Hs.eg.db)\nAnnotationDbi::columns(org.Hs.eg.db)##  [1] \"ACCNUM\"       \"ALIAS\"        \"ENSEMBL\"      \"ENSEMBLPROT\"  \"ENSEMBLTRANS\"\n##  [6] \"ENTREZID\"     \"ENZYME\"       \"EVIDENCE\"     \"EVIDENCEALL\"  \"GENENAME\"    \n## [11] \"GO\"           \"GOALL\"        \"IPI\"          \"MAP\"          \"OMIM\"        \n## [16] \"ONTOLOGY\"     \"ONTOLOGYALL\"  \"PATH\"         \"PFAM\"         \"PMID\"        \n## [21] \"PROSITE\"      \"REFSEQ\"       \"SYMBOL\"       \"UCSCKG\"       \"UNIGENE\"     \n## [26] \"UNIPROT\""},{"path":"ora-go-analysis-1.html","id":"gengo-vs-panther-web","chapter":"7 ORA GO analysis","heading":"7.5.2 genGO vs Panther web","text":"Still using five check genes.Panther recognize “PDL1” “PD1”, well “BCC7” omited.\nFigure 7.3: Panther result\n","code":""},{"path":"ora-kegg-analysis-1.html","id":"ora-kegg-analysis-1","chapter":"8 ORA KEGG analysis","heading":"8 ORA KEGG analysis","text":"","code":""},{"path":"ora-kegg-analysis-1.html","id":"kegg-introduction","chapter":"8 ORA KEGG analysis","heading":"8.1 KEGG intruduction","text":"KEGG short “Kyoto Encyclopedia Genes Genomes,” collection databases dealing genomes, biological pathways, diseases, drugs, chemical substances.pathway maps classified following sections:MetabolismGenetic information processing (transcription, translation, replication repair, etc.)Environmental information processing (membrane transport, signal transduction, etc.)Cellular processes (cell growth, cell death, cell membrane functions, etc.)Organismal systems (immune system, endocrine system, nervous system, etc.)Human diseasesDrug development\nFigure 8.1: KEGG overview. Figure taken https://paintomics.readthedocs.io/en/stable/1_kegg/.\n","code":""},{"path":"ora-kegg-analysis-1.html","id":"kegg-basic-usage","chapter":"8 ORA KEGG analysis","heading":"8.2 Basic usage","text":"genKEGG built clusterProfiler::enrichKEGG optimizes analysis process make better understanding.simplest arguments :id: gene id entrez, ensembl symbol (alias also accepted)org: organism (7254 species genekitr::keggOrg_name)pvalueCutoffqvalueCutoffInput type limited Entrez ID, gene types automatically converted Entrez ID.","code":"\ndata(geneList, package = \"genekitr\")\nid <- names(geneList)[abs(geneList) > 1]\nkeg <- genKEGG(id,\n  org = \"human\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)\nhead(keg, 5)##                ID              Description  GeneRatio  BgRatio       pvalue\n## hsa03030 hsa03030          DNA replication 0.04222222  36/8157 3.069219e-15\n## hsa04110 hsa04110               Cell cycle 0.07333333 126/8157 1.922027e-14\n## hsa03460 hsa03460   Fanconi anemia pathway 0.03111111  54/8157 8.372886e-07\n## hsa03440 hsa03440 Homologous recombination 0.02666667  41/8157 1.252525e-06\n## hsa03430 hsa03430          Mismatch repair 0.02000000  23/8157 1.785023e-06\n##              p.adjust       qvalue\n## hsa03030 9.299733e-13 8.399967e-13\n## hsa04110 2.911871e-12 2.630142e-12\n## hsa03460 8.456614e-05 7.638422e-05\n## hsa03440 9.487875e-05 8.569906e-05\n## hsa03430 1.081724e-04 9.770655e-05\n##                                                                                                                                                                 geneID\n## hsa03030                                                             57804/2237/5426/6118/5982/1763/5984/23649/10714/5557/5111/4172/4171/4176/5983/4174/4173/4175/5427\n## hsa04110 7040/7042/995/5347/891/1870/1021/7465/9700/5933/1017/699/890/4609/5111/990/4172/7272/1869/4171/4176/4174/4085/4173/983/4175/9088/23594/4998/595/8318/993/9134\n## hsa03460                                                                                      6118/7398/80010/2177/146956/2175/29089/672/55215/83990/2187/675/641/5888\n## hsa03440                                                                                                84142/57804/6118/146956/10714/672/83990/8438/675/641/5888/7516\n## hsa03430                                                                                                                57804/4436/6118/5982/5984/10714/5111/5983/9156\n##                                                                                                                                                                               geneID_symbol\n## hsa03030                                                                                POLD4/FEN1/POLE/RPA2/RFC2/DNA2/RFC4/POLA2/POLD3/PRIM1/PCNA/MCM3/MCM2/MCM7/RFC3/MCM5/MCM4/MCM6/POLE2\n## hsa04110 TGFB1/TGFB2/CDC25C/PLK1/CCNB1/E2F2/CDK6/WEE1/ESPL1/RBL1/CDK2/BUB1/CCNA2/MYC/PCNA/CDC6/MCM3/TTK/E2F1/MCM2/MCM7/MCM5/MAD2L1/MCM4/CDK1/MCM6/PKMYT1/ORC6/ORC1/CCND1/CDC45/CDC25A/CCNE2\n## hsa03460                                                                                                     RPA2/USP1/RMI1/FANCD2/EME1/FANCA/UBE2T/BRCA1/FANCI/BRIP1/FANCB/BRCA2/BLM/RAD51\n## hsa03440                                                                                                            ABRAXAS1/POLD4/RPA2/EME1/POLD3/BRCA1/BRIP1/RAD54L/BRCA2/BLM/RAD51/XRCC2\n## hsa03430                                                                                                                                     POLD4/MSH2/RPA2/RFC2/RFC4/POLD3/PCNA/RFC3/EXO1\n##          Count FoldEnrich RichFactor\n## hsa03030    19   9.566852  0.5277778\n## hsa04110    33   4.747460  0.2619048\n## hsa03460    14   4.699506  0.2592593\n## hsa03440    12   5.305366  0.2926829\n## hsa03430     9   7.093043  0.3913043\nsym <- c(\"TP53\",\"BRCA1\", \"PD1\", \"PDL1\",\"BRCA2\",\"TET2\")\nkeg2 <- genKEGG(sym,\n  org = \"human\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)\nhead(keg2, 5)##                ID              Description GeneRatio  BgRatio       pvalue\n## hsa05224 hsa05224            Breast cancer       0.6 147/8157 5.585086e-05\n## hsa03440 hsa03440 Homologous recombination       0.4  41/8157 2.441614e-04\n## hsa03460 hsa03460   Fanconi anemia pathway       0.4  54/8157 4.247311e-04\n## hsa01524 hsa01524 Platinum drug resistance       0.4  73/8157 7.763692e-04\n## hsa05212 hsa05212        Pancreatic cancer       0.4  76/8157 8.413308e-04\n##             p.adjust      qvalue           geneID    geneID_symbol Count\n## hsa05224 0.003127648 0.002057663 TP53/BRCA1/BRCA2 TP53/BRCA1/BRCA2     3\n## hsa03440 0.006836518 0.004497709      BRCA1/BRCA2      BRCA1/BRCA2     2\n## hsa03460 0.007928314 0.005215996      BRCA1/BRCA2      BRCA1/BRCA2     2\n## hsa01524 0.009422905 0.006199280       TP53/BRCA1       TP53/BRCA1     2\n## hsa05212 0.009422905 0.006199280       TP53/BRCA2       TP53/BRCA2     2\n##          FoldEnrich RichFactor\n## hsa05224   33.29388 0.02040816\n## hsa03440   79.58049 0.04878049\n## hsa03460   60.42222 0.03703704\n## hsa01524   44.69589 0.02739726\n## hsa05212   42.93158 0.02631579"},{"path":"ora-kegg-analysis-1.html","id":"kegg-group-enrichment","chapter":"8 ORA KEGG analysis","heading":"8.3 Group enrichment","text":"Like GO enrichment analysis, KEGG also supports multi-group gene enrichment analysis.additional arguments refer GO analysis.","code":"\nid2 <- c(head(names(geneList), 100), tail(names(geneList), 100))\ngroup <- list(\n  group1 = c(rep(\"up\", 100), rep(\"down\", 100)),\n  group2 = c(rep(\"A\", 130), rep(\"B\", 70))\n)\ngkeg <- genKEGG(id2,\n  group_list = group,\n  org = \"human\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)\nhead(gkeg, 5)##   Cluster group1 group2       ID                             Description\n## 1  down.A   down      A hsa04110                              Cell cycle\n## 2  down.A   down      A hsa03030                         DNA replication\n## 3  down.A   down      A hsa04914 Progesterone-mediated oocyte maturation\n## 4  down.A   down      A hsa04114                          Oocyte meiosis\n## 5  down.B   down      B hsa03440                Homologous recombination\n##   GeneRatio  BgRatio       pvalue     p.adjust       qvalue\n## 1 0.4444444 126/8157 6.442363e-06 9.019308e-05 6.781434e-05\n## 2 0.2222222  36/8157 6.686677e-04 4.680674e-03 3.519304e-03\n## 3 0.2222222 102/8157 5.264204e-03 2.456629e-02 1.847089e-02\n## 4 0.2222222 131/8157 8.558563e-03 2.995497e-02 2.252254e-02\n## 5 0.1315789  41/8157 1.108128e-06 1.396241e-04 1.271431e-04\n##                   geneID                geneID_symbol Count FoldEnrich\n## 1     4173/983/4175/9088        MCM4/CDK1/MCM6/PKMYT1     4   28.77249\n## 2              4173/4175                    MCM4/MCM6     2   50.35185\n## 3               983/9088                  CDK1/PKMYT1     2   17.77124\n## 4               983/9088                  CDK1/PKMYT1     2   13.83715\n## 5 8438/675/641/5888/7516 RAD54L/BRCA2/BLM/RAD51/XRCC2     5   26.17779\n##   RichFactor\n## 1 0.03174603\n## 2 0.05555556\n## 3 0.01960784\n## 4 0.01526718\n## 5 0.12195122"},{"path":"functional-class-scoring-1.html","id":"functional-class-scoring-1","chapter":"9 Functional Class Scoring","heading":"9 Functional Class Scoring","text":"ORA method easy conduct, lose information genes’ differences slight. example, gene essential pathway low-expressed, filtered fold change cutoff.Unlike ORA, FCS tools set threshold differentially expressed genes. Instead, gives detected gene differential expression score evaluates whether scores positive negative expected chance gene set.According article “Ten Years Pathway Analysis: Current Approaches Outstanding Challenges”:FCS approaches include GSEA, GlobalTest, sigPathway, SAFE, GSA, PADOG, PCOT2, FunCluster, SAM-GS, Category etc.Next, go popular Gene Set Enrichment Analysis (GSEA) tool, uses FCS permutation approaches determine whether gene set significantly associated higher lower scores.","code":""},{"path":"functional-class-scoring-1.html","id":"gsea-introduction","chapter":"9 Functional Class Scoring","heading":"9.1 GSEA intruduction","text":"GSEA, user must ordered gene rank list (e.g., genes decreasing logFC order).Three steps GSEA:Calculate enrichment score (ES): represents amount genes set -represented either top bottom list. GSEA starts top ranked gene list calculate enrichment score. gene member candidate gene set, adds running sum. Otherwise, subtracts.Calculate enrichment score (ES): represents amount genes set -represented either top bottom list. GSEA starts top ranked gene list calculate enrichment score. gene member candidate gene set, adds running sum. Otherwise, subtracts.Estimate statistical significance ES: calculation done phenotypic-based permutation test order produce null distribution ES.Estimate statistical significance ES: calculation done phenotypic-based permutation test order produce null distribution ES.Adjust multiple hypothesis testing large number gene sets analyzed one time: enrichment scores set normalized, false discovery rate calculated.Adjust multiple hypothesis testing large number gene sets analyzed one time: enrichment scores set normalized, false discovery rate calculated.\nFigure 9.1: GSEA overview\ninterested GSEA detailed procedure, please visit: https://www.pathwaycommons.org/guide/primers/data_analysis/gsea https://github.com/crazyhottommy/RNA-seq-analysis/blob/master/GSEA_explained.mdMsigdb categories best GSEA partner 9 major collections several sub-collections 32880 gene sets:H: hallmark gene sets (50 gene sets)C1: positional gene sets (299 gene sets)\nchromosome: chr1 => MT\nchromosome: chr1 => MTC2: curated gene sets (6366 gene sets)\nCGP (chemical genetic perturbations, 3384 gene sets)\nCP (canonical pathways, 2982 gene sets) includes BioCarta, KEGG, PID, Reactome WikiPathways\nCGP (chemical genetic perturbations, 3384 gene sets)CP (canonical pathways, 2982 gene sets) includes BioCarta, KEGG, PID, Reactome WikiPathwaysC3: regulatory target gene sets (3726 gene sets)\nMIR (microRNA targets, 2598 gene sets)\nTFT (transcription factor targets, 1128 gene sets)\nMIR (microRNA targets, 2598 gene sets)TFT (transcription factor targets, 1128 gene sets)C4: computational gene sets (858 gene sets)\nCGN (cancer gene neighborhoods, 427 gene sets)\nCM (cancer modules, 431 gene sets)\nCGN (cancer gene neighborhoods, 427 gene sets)CM (cancer modules, 431 gene sets)C5: ontology gene sets (15473 gene sets) includes BP, CC MFC6: oncogenic signature gene sets (189 gene sets)C7: immunologic signature gene sets (5219 gene sets)\nIMMUNESIGDB (ImmuneSigDB gene sets, 4872 gene sets)\nVAX (vaccine response gene sets, 347 gene sets)\nIMMUNESIGDB (ImmuneSigDB gene sets, 4872 gene sets)VAX (vaccine response gene sets, 347 gene sets)C8: cell type signature gene sets (700 gene sets)","code":""},{"path":"functional-class-scoring-1.html","id":"gsea-basic-usage","chapter":"9 Functional Class Scoring","heading":"9.2 Basic usage","text":"genKEGG built msigdbr clusterProfiler::GSEA also built fgsea. Also genKEGG optimizes analysis process make better performance.simplest arguments :genelist: Order ranked genelist decreasing order, gene can entrez, ensembl symbol.org: organism (genekitr::msig_org)category: one C1’,‘C2’,‘C3’, ‘C4’,‘C5’,‘C6’,‘C7’,‘C8’,‘H’subcategory: choose genekitr::msig_category. category subcategory, leave NULL.pvalueCutoffqvalueCutoffThe GSEA result list including input genelist, target gene set analysis result.gsea_df resultsetSize: according documentation fgsea, size pathway removing genes present names(stats). specific, input pathway gene set 58 genes (e.g. HALLMARK_MYC_TARGETS_V2 ), gene list 54 , result show setSize = 54setSize: according documentation fgsea, size pathway removing genes present names(stats). specific, input pathway gene set 58 genes (e.g. HALLMARK_MYC_TARGETS_V2 ), gene list 54 , result show setSize = 54enrichmentScore: also called ES, Broad GSEA implementation. reflects degree gene set overrepresented top bottom ranked list genes.enrichmentScore: also called ES, Broad GSEA implementation. reflects degree gene set overrepresented top bottom ranked list genes.NES: normalized enrichment score primary statistic examining gene set enrichment results. normalizing enrichment score, GSEA accounts differences gene set size correlations gene sets expression dataset. Therefore, NES can used compare analysis results across gene sets.NES: normalized enrichment score primary statistic examining gene set enrichment results. normalizing enrichment score, GSEA accounts differences gene set size correlations gene sets expression dataset. Therefore, NES can used compare analysis results across gene sets.positive normalized enrichment scores (NES) indicate genes set S mostly represented top list (logFC > 0 -regulated genes).","code":"\ndata(geneList, package = \"genekitr\")\ngse <- genGSEA(\n  genelist = geneList,\n  org = \"human\",\n  category = \"H\"\n)\nclass(gse)## [1] \"list\"\nnames(gse)## [1] \"gsea_df\"  \"genelist\" \"geneset\"  \"exponent\" \"org\"\nhead(gse$genelist)##                  ID    logfc\n## 948             948 5.780170\n## 1638           1638 5.633027\n## 158471       158471 4.683610\n## 10610         10610 3.875120\n## 6947           6947 3.357670\n## 100133941 100133941 3.322533\nhead(gse$geneset)##                 gs_name entrez_gene\n## 1 HALLMARK_ADIPOGENESIS          19\n## 2 HALLMARK_ADIPOGENESIS       11194\n## 3 HALLMARK_ADIPOGENESIS       10449\n## 4 HALLMARK_ADIPOGENESIS          33\n## 5 HALLMARK_ADIPOGENESIS          34\n## 6 HALLMARK_ADIPOGENESIS          35\nhead(gse$gsea_df, 5)##                                                  ID               Description\n## HALLMARK_E2F_TARGETS           HALLMARK_E2F_TARGETS      HALLMARK_E2F_TARGETS\n## HALLMARK_G2M_CHECKPOINT     HALLMARK_G2M_CHECKPOINT   HALLMARK_G2M_CHECKPOINT\n## HALLMARK_MTORC1_SIGNALING HALLMARK_MTORC1_SIGNALING HALLMARK_MTORC1_SIGNALING\n## HALLMARK_MYC_TARGETS_V1     HALLMARK_MYC_TARGETS_V1   HALLMARK_MYC_TARGETS_V1\n## HALLMARK_MYC_TARGETS_V2     HALLMARK_MYC_TARGETS_V2   HALLMARK_MYC_TARGETS_V2\n##                           setSize enrichmentScore       NES pvalue p.adjust\n## HALLMARK_E2F_TARGETS          194      -0.8361902 -3.428465  1e-10    1e-09\n## HALLMARK_G2M_CHECKPOINT       195      -0.8028510 -3.285737  1e-10    1e-09\n## HALLMARK_MTORC1_SIGNALING     192      -0.5186671 -2.114470  1e-10    1e-09\n## HALLMARK_MYC_TARGETS_V1       187      -0.7348931 -3.000453  1e-10    1e-09\n## HALLMARK_MYC_TARGETS_V2        54      -0.8644875 -2.884961  1e-10    1e-09\n##                                 qvalue rank                   leading_edge\n## HALLMARK_E2F_TARGETS      4.631579e-10 2116 tags=79%, list=11%, signal=71%\n## HALLMARK_G2M_CHECKPOINT   4.631579e-10 2114 tags=72%, list=11%, signal=64%\n## HALLMARK_MTORC1_SIGNALING 4.631579e-10 2353 tags=43%, list=13%, signal=38%\n## HALLMARK_MYC_TARGETS_V1   4.631579e-10 3480 tags=70%, list=19%, signal=57%\n## HALLMARK_MYC_TARGETS_V2   4.631579e-10 2138 tags=87%, list=12%, signal=77%\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              geneID\n## HALLMARK_E2F_TARGETS      9126/5885/6117/3609/5511/9183/204/23047/2935/3184/6426/4292/5981/1854/7514/11200/11051/6749/6427/6434/9125/11113/3159/8243/5036/1033/10492/7283/5411/1965/9738/1786/6628/10274/7037/3930/9238/5889/898/7913/1434/9133/3838/9972/79077/7083/10212/991/51155/10051/3978/5901/9232/4678/8914/9787/5558/84844/79019/3148/64785/7884/11340/5810/5424/24137/2146/9221/81611/7374/10606/1111/10535/580/7153/55148/5631/57122/3835/1633/1164/3161/29127/4436/5347/10248/6839/10460/1062/332/23165/10797/6790/5426/6118/7398/29893/27338/10615/7465/11004/64858/55635/9700/55143/83461/5902/81624/5982/9212/4288/23649/10714/4609/29089/1163/5111/146909/147841/4605/4001/7112/1503/84296/672/4172/54962/9833/4171/4176/5983/6941/79075/79733/4174/4085/9837/4173/983/4175/55723/9319/3070/57405/10733/253714/55646/23594/29028/675/10635/6241/993\n## HALLMARK_G2M_CHECKPOINT                                                                                     5885/4502/6421/3192/3609/996/7290/9994/3312/9252/23047/2935/3184/51776/6426/3619/10951/7514/4928/6427/6434/7027/3159/8243/1033/9184/10492/11044/10432/3980/4953/8317/10419/22823/10772/7468/7150/10274/4088/3930/81539/4691/1871/4957/9133/3838/6713/10146/3837/10212/991/51155/10051/1063/10592/387893/9232/4678/5558/51203/6541/1841/24137/2176/2146/9221/10762/1111/10024/580/7153/10926/4751/3835/6632/10403/1164/22974/3161/29127/262/5347/6839/10460/57082/1062/1870/332/6790/5426/1058/6118/10293/27338/9055/3832/11004/11065/9700/5933/899/9212/4288/9585/699/23649/890/4609/1946/1736/1163/4605/4001/7112/990/4172/9493/7272/10036/7371/55872/1869/26271/56992/4171/6491/10721/4174/4085/983/4175/10733/23594/8438/675/51659/595/8318/993/9156\n## HALLMARK_MTORC1_SIGNALING                                                                                                                                                                                                                                                                                                                                                                                           11333/5464/3313/3308/6509/4793/3157/5704/441024/6117/3939/5719/5684/79071/3145/134429/3689/5706/1075/8624/10682/23753/8894/80777/2107/7494/6513/3329/5718/2805/23760/3422/57761/7283/1595/10061/81873/10197/10213/3309/26747/908/3638/7037/8833/1717/586/2717/2181/27346/6713/6510/10212/1719/51377/10135/10963/30001/27101/3251/56902/5163/6781/10622/7374/6515/5347/9136/23165/10797/6790/10452/205/899/3099/699/4860/4171/4173/6241/993/3949\n## HALLMARK_MYC_TARGETS_V1                                                                                                                                         2091/5230/5093/23450/26121/65005/6742/8454/1933/10935/5682/1982/5713/7419/5478/2547/5887/1176/5690/10155/10574/6637/3068/6741/5707/3608/10907/10549/5425/5688/6626/26156/56910/7416/10236/4686/5704/3192/11137/3939/9868/11335/1977/6432/5709/10921/2935/3184/23016/5706/6426/3066/1854/7514/5245/7307/8894/6427/2107/6434/708/57819/7027/7411/5036/6428/4706/8669/9184/10492/3329/10291/7555/6950/790/1965/4953/10575/10213/10054/10856/7203/6634/2739/10728/26135/7965/7913/3838/1964/10146/10576/3837/5496/991/8662/5901/6732/1478/6629/3251/9221/54107/8886/1665/22948/6240/6632/9136/26354/7398/6059/9188/1017/5902/5634/5984/51491/890/4609/7298/5111/1503/4171/4176/4174/4085/4173/4175/8318\n## HALLMARK_MYC_TARGETS_V2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        6832/10244/11335/10196/79050/5245/79711/5036/3329/10199/81887/9238/2193/7965/54663/27346/79077/23481/64216/51388/10171/4839/27340/56915/80324/23160/9221/8886/92856/7374/83743/5347/6573/9136/29078/10514/26354/23082/705/6949/3099/51491/4609/51154/4174/4173/10733\n##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             geneID_symbol\n## HALLMARK_E2F_TARGETS      SMC3/RAD21/RPA1/ILF3/PPP1R8/ZW10/AK2/PDS5B/GSPT1/HNRNPD/SRSF1/MLH1/RFC1/DUT/XPO1/CHEK2/NUDT21/SSRP1/SRSF2/TRA2B/CNOT9/CIT/HMGA1/SMC1A/PA2G4/CDKN3/SYNCRIP/TUBG1/PNN/EIF2S1/CCP110/DNMT1/SNRPB/STAG1/TFRC/LBR/TBRG4/RAD51C/CCNE1/DEK/CSE1L/CCNB2/KPNA2/NUP153/DCTPP1/TK1/DDX39A/CDC20/JPT1/SMC4/LIG1/RAN/PTTG1/NASP/TIMELESS/DLGAP5/PRIM2/PHF5A/CENPM/HMGB2/GINS3/SLBP/EXOSC8/RAD1/POLD1/KIF4A/EZH2/NOLC1/ANP32E/UNG/PAICS/CHEK1/RNASEH2A/BARD1/TOP2A/UBR7/PRPS1/NUP107/KIF22/DCK/CKS2/HMMR/RACGAP1/MSH2/PLK1/POP7/SUV39H1/TACC3/CENPE/BIRC5/NUP205/MTHFD2/AURKA/POLE/RPA2/USP1/PSMC3IP/UBE2S/SPAG5/WEE1/KIF2C/DCLRE1B/DEPDC1/ESPL1/CDCA8/CDCA3/RANBP1/DIAPH3/RFC2/AURKB/MKI67/POLA2/POLD3/MYC/UBE2T/CKS1B/PCNA/KIF18B/SPC24/MYBL2/LMNB1/TMPO/CTPS1/GINS4/BRCA1/MCM3/TIPIN/MELK/MCM2/MCM7/RFC3/TCF19/DSCC1/E2F8/MCM5/MAD2L1/GINS1/MCM4/CDK1/MCM6/ASF1B/TRIP13/HELLS/SPC25/PLK4/MMS22L/LYAR/ORC6/ATAD2/BRCA2/RAD51AP1/RRM2/CDC25A\n## HALLMARK_G2M_CHECKPOINT                                                                                           RAD21/MT2A/SFPQ/HNRNPU/ILF3/CDC27/HIRA/CASP8AP2/HSPA8/RPS6KA5/PDS5B/GSPT1/HNRNPD/MAP3K20/SRSF1/INCENP/CBX1/XPO1/NUP98/SRSF2/TRA2B/TFDP1/HMGA1/SMC1A/CDKN3/BUB3/SYNCRIP/TENT4A/RBM14/LIG3/ODC1/CDC7/PRMT5/MTF2/SRSF10/NSD2/TOP1/STAG1/SMAD3/LBR/SLC38A1/NCL/E2F3/ODF2/CCNB2/KPNA2/SQLE/G3BP1/KPNB1/DDX39A/CDC20/JPT1/SMC4/CENPF/SMC2/KMT5A/PTTG1/NASP/PRIM2/NUSAP1/SLC7A1/DTYMK/KIF4A/FANCC/EZH2/NOLC1/NUP50/CHEK1/TROAP/BARD1/TOP2A/DBF4/NEK2/KIF22/SNRPD1/NDC80/CKS2/TPX2/HMMR/RACGAP1/AMD1/PLK1/SUV39H1/TACC3/KNL1/CENPE/E2F2/BIRC5/AURKA/POLE/CENPA/RPA2/TRAIP/UBE2S/PRC1/KIF11/KIF2C/UBE2C/ESPL1/RBL1/CCNF/AURKB/MKI67/KIF20B/BUB1/POLA2/CCNA2/MYC/EFNA5/DKC1/CKS1B/MYBL2/LMNB1/TMPO/CDC6/MCM3/KIF23/TTK/CHAF1A/UCK2/PBK/E2F1/FBXO5/KIF15/MCM2/STIL/POLQ/MCM5/MAD2L1/CDK1/MCM6/PLK4/ORC6/RAD54L/BRCA2/GINS2/CCND1/CDC45/CDC25A/EXO1\n## HALLMARK_MTORC1_SIGNALING                                                                                                                                                                                                                                                                                                                                                                                                                            PDAP1/PPA1/HSPA9/HSPA4/SLC1A4/NFKBIB/HMGCS1/PSMC4/MTHFD2L/RPA1/LDHA/PSMD13/PSMA3/ELOVL6/HMBS/STARD4/ITGB2/PSMC6/CTSC/PSMG1/EBP/SDF2L1/EIF2S2/CYB5B/ETF1/XBP1/SLC2A1/HSPD1/PSMD12/GOT1/PITPNB/IDI1/TRIB3/TUBG1/CYP51A1/ABCF2/ARPC5L/PSME3/PSMD14/HSPA5/NUFIP1/CCT6A/INSIG1/TFRC/GMPS/DHCR7/BCAT1/GLA/ACSL3/TMEM97/SQLE/SLC1A5/DDX39A/DHFR/UCHL5/NAMPT/STIP1/ERO1A/CACYBP/HPRT1/PNO1/PDK1/STC1/POLR3G/UNG/SLC2A3/PLK1/RRP9/NUP205/MTHFD2/AURKA/TOMM40/AK4/CCNF/HK2/BUB1/PNP/MCM2/MCM4/RRM2/CDC25A/LDLR\n## HALLMARK_MYC_TARGETS_V1                                                                                                                                              FBL/PGK1/PCBP1/SF3B3/PRPF31/MRPL9/SSBP1/CUL1/EEF1B2/PRDX3/PSMA1/EIF4G2/PSMD7/VDAC3/PPIA/XRCC6/RAD23B/AP3S1/PSMB2/TRIM28/CCT7/SNRPG/HDGF/SSB/PSMD1/ILF2/TXNL4A/PRDX4/POLD2/PSMA7/SNRPA/RSL1D1/STARD7/VDAC1/HNRNPR/NCBP1/PSMC4/HNRNPU/PWP1/LDHA/TOMM70/CBX3/EIF4E/SRSF7/PSMD3/RNPS1/GSPT1/HNRNPD/EXOSC7/PSMC6/SRSF1/HDAC2/DUT/XPO1/PHB/U2AF1/EIF2S2/SRSF2/ETF1/TRA2B/C1QBP/LSM2/TFDP1/VBP1/PA2G4/SRSF3/NDUFAB1/EIF3J/BUB3/SYNCRIP/HSPD1/SF3A1/CNBP/TCP1/CAD/EIF2S1/ODC1/CCT4/PSMD14/UBA2/RUVBL2/CCT3/SNRPD3/GLO1/PTGES3/SERBP1/AIMP2/DEK/KPNA2/EIF1AX/G3BP1/CCT2/KPNB1/PPM1G/CDC20/EIF3B/RAN/SRPK1/CSTF2/SNRPB2/HPRT1/NOLC1/POLE3/DDX18/DHX15/CCT5/RRM1/SNRPD1/RRP9/GNL3/USP1/ABCE1/DDX21/CDK2/RANBP1/PRPS2/RFC4/NOP16/CCNA2/MYC/TYMS/PCNA/CTPS1/MCM2/MCM7/MCM5/MAD2L1/MCM4/MCM6/CDC45\n## HALLMARK_MYC_TARGETS_V2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                SUPV3L1/RABEPK/CBX3/PRMT3/NOC4L/PHB/IPO4/PA2G4/HSPD1/MPHOSPH10/LAS1L/TBRG4/FARSA/AIMP2/WDR74/TMEM97/DCTPP1/PES1/TFB2M/NIP7/RCL1/NOP2/UTP20/EXOSC5/PUS1/WDR43/NOLC1/DDX18/IMP4/UNG/GRWD1/PLK1/SLC19A1/RRP9/NDUFAF4/MYBBP1A/GNL3/PPRC1/BYSL/TCOF1/HK2/NOP16/MYC/MRTO4/MCM5/MCM4/PLK4\n##                           Count\n## HALLMARK_E2F_TARGETS        153\n## HALLMARK_G2M_CHECKPOINT     140\n## HALLMARK_MTORC1_SIGNALING    82\n## HALLMARK_MYC_TARGETS_V1     130\n## HALLMARK_MYC_TARGETS_V2      47"},{"path":"functional-class-scoring-1.html","id":"export-result","chapter":"9 Functional Class Scoring","heading":"9.3 Export result","text":"Genekitr sets easy way export analysis result editing sharing. User save multiple data sets different sheets one excel file. Besides, colmun names automatically formated bold style.\nFigure 9.2: Export result\n","code":"\ngenekitr::expoSheet(data_list = gse,\n                    data_name = names(gse),\n                    filename = \"gsea_result.xlsx\",\n                    dir = \"./\")"},{"path":"plot-go-kegg-1.html","id":"plot-go-kegg-1","chapter":"10 Plot GO and KEGG","heading":"10 Plot GO and KEGG","text":"selecting interested terms pathways genGO genKEGG result, user pass data frame plotEnrich, includes many ready-made plot types GO KEGG result, including barplot, dotplot, heatmap, wego-like plot, chord plot, network, wordcloud etc.worth mentioning almost plots based ggplot2 plot_theme function easily change border, legend, label etc., helps user make plot.","code":""},{"path":"plot-go-kegg-1.html","id":"gokegg-bar-plot","chapter":"10 Plot GO and KEGG","heading":"10.1 GO/KEGG: Bar Plot","text":"Bar plot simplest way show enriched terms. x-axis enrichment metric (e.g. Gene ratio; Fold enrichment); y-axis selected terms. bar color represents statistical value.’s difference pvalue p.adjust?\np.adjust seven adjustment methods: https://www.rdocumentation.org/packages/stats/versions/3.5.0/topics/p.adjust.\nadjusted p-value always p-value, multiplied factor: adj.p = f * p actual size factor f depends strategy used correct multiple testing.\nway, “q-value” stands “false discovery rate (FDR)” method.basic arguments :term_metric: x-axis “Count”, “GeneRatio”, “FoldEnrich” “RichFactor”stats_metric: Statistic value “p.adjust”, “pvalue” “qvalue”up_color: Color stronger statistic value (e.g. pvalue 0.01)down_color: Color weaker statistic value (e.g. pvalue 1)wrap_length: Wrap term text longer number\nFigure 10.1: Bar plot enrichment analysis. default (), modify metrics (B), modify color (C) modify term length (D).\n","code":"\ndata(geneList, package = \"genekitr\")\nid <- names(geneList)[abs(geneList) > 1.5]\nlogfc <- geneList[id]\n\nego <- genGO(id,\n  org = \"human\", ont = \"bp\", pvalueCutoff = 0.01,\n  qvalueCutoff = 0.01\n)\n# Here just show top ten terms, you can choose your own interested terms!\nego <- ego[1:10, ]\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"bar\")\np2 <- plotEnrich(ego, plot_type = \"bar\", term_metric = \"GeneRatio\", stats_metric = \"pvalue\")\np3 <- plotEnrich(ego, plot_type = \"bar\", up_color = \"#E69056\", down_color = \"#325CAC\")\np4 <- plotEnrich(ego, plot_type = \"bar\", wrap_length = 25)\np1 + p2 + p3 + p4 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"gokegg-bubble-plot","chapter":"10 Plot GO and KEGG","heading":"10.2 GO/KEGG: Bubble Plot","text":"Enriched gene sets shown bubbles different sizes.x-axis statistic value y-axis “Fold Enrichment”.basic arguments :stats_metric: Statistic value “p.adjust”, “pvalue” “qvalue”scale_ratio: Change bubble size. Default 1.\nFigure 10.2: Bubble plot enrichment analysis. default (), modify bubble size (B).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"bubble\")\np2 <- plotEnrich(ego, plot_type = \"bubble\", \n                 scale_ratio = 0.5, stats_metric = \"qvalue\")\np1 / p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"gokegg-dot-plot","chapter":"10 Plot GO and KEGG","heading":"10.3 GO/KEGG: Dot Plot","text":"Similar bar plot, dot plot also widely used enrichment analysis plotting. Like bubble plot, dot size represents gene number enriched term.\nFigure 10.3: Dot plot enrichment analysis. default (), modify bubble size (B).\nanalyzing group enrichment analysis GO KEGG, use dotplot show result:\nFigure 10.4: Dot plot group enrichment analysis.\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"dot\")\np2 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  scale_ratio = 1.5,\n  stats_metric = \"pvalue\",\n  term_metric = \"RichFactor\"\n)\np1 + p2 + plot_annotation(tag_levels = \"A\")\nplotEnrich(gego2,\n           plot_type = 'dot',\n           scale_ratio = 2, # dot size\n           main_text_size = 10,\n           legend_text_size =8,\n           n_term = 6) # show terms"},{"path":"plot-go-kegg-1.html","id":"go-wego-plot","chapter":"10 Plot GO and KEGG","heading":"10.4 GO: WEGO Plot","text":"user analyzed one ontology, may want show one figure.\nInspired WEGO, genekitr utilized ggplot2 reproduce plot.generate three ontologies (BP,MF CC) result.just want show two ontologies, can rbind dataframes give new dataframe new column “ONTOLOGY” distinguish different ontologies.NOTICE: plotEnrich parameter n_term WEGO plot, specify number terms. want plot terms, just set n_term higher.\nFigure 10.5: WEGO plot enrichment analysis.\n","code":"\nall_ego <- genGO(id,\n  org = \"human\",\n  ont = \"all\",\n  pvalueCutoff = 0.05,\n  qvalueCutoff = 0.05\n)\nhead(all_ego)##            ONTOLOGY  Hs_ALL_ID\n## GO:0006260       BP GO:0006260\n## GO:0050673       BP GO:0050673\n## GO:1901992       BP GO:1901992\n## GO:0010165       BP GO:0010165\n## GO:1901989       BP GO:1901989\n## GO:0045931       BP GO:0045931\n##                                                           Description\n## GO:0006260                                            DNA replication\n## GO:0050673                              epithelial cell proliferation\n## GO:1901992 positive regulation of mitotic cell cycle phase transition\n## GO:0010165                                          response to X-ray\n## GO:1901989         positive regulation of cell cycle phase transition\n## GO:0045931                  positive regulation of mitotic cell cycle\n##             GeneRatio   BgRatio       pvalue     p.adjust       qvalue\n## GO:0006260 0.12121212 273/18866 2.001739e-08 4.966314e-05 3.923408e-05\n## GO:0050673 0.14141414 453/18866 1.024312e-07 1.270658e-04 1.003825e-04\n## GO:1901992 0.07070707  94/18866 6.231910e-07 4.011247e-04 3.168901e-04\n## GO:0010165 0.05050505  32/18866 6.467146e-07 4.011247e-04 3.168901e-04\n## GO:1901989 0.07070707 110/18866 1.809525e-06 8.978861e-04 7.093337e-04\n## GO:0045931 0.08080808 168/18866 2.878804e-06 1.190385e-03 9.404092e-04\n##                                                                              geneID\n## GO:0006260        5427/157570/641/5888/6241/8318/9156/9134/55388/63967/51514/374393\n## GO:0050673 5176/26471/3488/6591/8549/407007/6422/29128/595/7039/7099/374/3690/10468\n## GO:1901992                                  407007/113130/595/407006/8318/993/51514\n## GO:0010165                                                   6422/641/5888/595/7516\n## GO:1901989                                  407007/113130/595/407006/8318/993/51514\n## GO:0045931                             407007/113130/595/407006/7039/8318/993/51514\n##                                                                                 geneID_symbol\n## GO:0006260                POLE2/ESCO2/BLM/RAD51/RRM2/CDC45/EXO1/CCNE2/MCM10/CLSPN/DTL/FAM111B\n## GO:0050673 SERPINF1/NUPR1/IGFBP5/SNAI2/LGR5/MIR222/SFRP1/UHRF1/CCND1/TGFA/TLR4/AREG/ITGB3/FST\n## GO:1901992                                         MIR222/CDCA5/CCND1/MIR221/CDC45/CDC25A/DTL\n## GO:0010165                                                        SFRP1/BLM/RAD51/CCND1/XRCC2\n## GO:1901989                                         MIR222/CDCA5/CCND1/MIR221/CDC45/CDC25A/DTL\n## GO:0045931                                    MIR222/CDCA5/CCND1/MIR221/TGFA/CDC45/CDC25A/DTL\n##            Count FoldEnrich RichFactor\n## GO:0006260    12   8.376512 0.04395604\n## GO:0050673    14   5.889446 0.03090508\n## GO:1901992     7  14.191060 0.07446809\n## GO:0010165     5  29.775884 0.15625000\n## GO:1901989     7  12.126905 0.06363636\n## GO:0045931     8   9.074555 0.04761905\nplotEnrich(all_ego, plot_type = \"wego\", n_term = 5)"},{"path":"plot-go-kegg-1.html","id":"gokegg-lollipop-plot","chapter":"10 Plot GO and KEGG","heading":"10.5 GO/KEGG: Lollipop Plot","text":"Lollipop like combination barplot dotplot\nFigure 10.6: Lollipop plot enrichment analysis. defult (), selected genes (B)\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"lollipop\")\np2 <- plotEnrich(ego,\n  plot_type = \"lollipop\",\n  scale_ratio = 1.2,\n  stats_metric = \"pvalue\",\n  term_metric = \"RichFactor\",\n  up_color = \"#a32a31\",\n  down_color = \"#f7dcca\"\n)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"gokegg-heatmap-plot","chapter":"10 Plot GO and KEGG","heading":"10.6 GO/KEGG: Heatmap Plot","text":"Heatmap plot shows interactions enriched terms genes.\nfold change given, heatmap add color -regulated genes.\nFigure 10.7: Heatmap plot enrichment analysis. genes (, default), selected genes (B), selected genes logFC value (C).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"geneheat\")\nshow_gene <- c(\"BRCA2\", \"CDK1\", \"JUN\", \"MCM8\", \"TIPIN\")\np2 <- plotEnrich(ego, plot_type = \"geneheat\", show_gene = show_gene)\np3 <- plotEnrich(ego, plot_type = \"geneheat\", show_gene = show_gene, fold_change = logfc)\np1 / p2 / p3 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"gokegg-chord-plot","chapter":"10 Plot GO and KEGG","heading":"10.7 GO/KEGG: Chord Plot","text":"Inspired GOplot, chord plot reproduced using ggplot2 shows similar content heatmap plot.gene_space: space gene labels chord.\nFigure 10.8: Heatmap plot enrichment analysis. selected genes (), selected genes logFC value (B).\n","code":"\nlibrary(patchwork)\nshow_gene <- c(\"BRCA2\", \"CDK1\", \"JUN\", \"MCM8\", \"TIPIN\")\np1 <- plotEnrich(ego, plot_type = \"genechord\", \n                 show_gene = show_gene) +\n  ggplot2::theme(legend.position = \"none\")\np2 <- plotEnrich(ego, plot_type = \"genechord\", \n                 show_gene = show_gene, \n                 fold_change = logfc,\n                 gene_space = 0.5)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"gokegg-wordcloud-plot","chapter":"10 Plot GO and KEGG","heading":"10.8 GO/KEGG: Wordcloud Plot","text":"Wordcloud plot shows term emphasis based text frequency.\nFigure 10.9: Wordcloud plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"wordcloud\")"},{"path":"plot-go-kegg-1.html","id":"gokegg-upset-plot","chapter":"10 Plot GO and KEGG","heading":"10.9 GO/KEGG: Upset Plot","text":"Inspired ComplexUpset, upset plot shows association genes enriched terms. Unlike common Venn diagram, emphasize complex relationship among many gene sets.\nFigure 10.10: Upset plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"upset\",main_text_size = 15,legend_text_size = 8)"},{"path":"plot-go-kegg-1.html","id":"gokegg-network-plot","chapter":"10 Plot GO and KEGG","heading":"10.10 GO/KEGG: Network Plot","text":"Inspired enrichplot::emapplot, genekitr reproduced plot enhance modification.\nEnriched terms nodes network, overlapping gene sets edges. Terms overlapped genes tend cluster together edge thicker.GO analysis result use five methods calculate similarity nodes: “Resnik”, “Lin”, “Rel”, “Jiang”, “Wang” “JC”(Jaccard’s similarity index) methods.KEGG supports “JC” method.User define layout argument derived ggraph, including “nicely” (default), “circle”, “dh”, “drl”, “fr”, “graphopt”, “grid”,“lgl”, “kk”, “mds”, “randomly”, “star” etc.information layout, refer : “Introduction ggraph: Layouts”\nFigure 10.11: Network plot enrichment analysis. JC method nicely layout(, default), circle layout (B), grid layout Want method (C).\n","code":"\nlibrary(patchwork)\nlibrary(igraph)\nlibrary(ggraph)\np1 <- plotEnrich(ego, plot_type = \"network\", scale_ratio = 0.5)\np2 <- plotEnrich(ego, plot_type = \"network\", \n                 layout = \"circle\", scale_ratio = 0.5)\np3 <- plotEnrich(ego, plot_type = \"network\", \n                 layout = \"grid\", sim_method = \"Wang\",\n                 up_color = \"#a32a31\", down_color = \"#f7dcca\")\n(p1 + p2) / p3 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"go-map-plot","chapter":"10 Plot GO and KEGG","heading":"10.11 GO: Map Plot","text":"GO terms built directed acyclic graph parent-child relationship.\nmap plot utilized GOSemSim extract parent child terms, also utilized ggraph igraph draw default layout “sugiyama”.avoid much unrelated terms messed , genekitr shows closest parent child selected terms. Besides, top three parent term edges plotted.\nFigure 10.12: Map plot enrichment analysis.\n","code":"\nlibrary(igraph)\nlibrary(ggraph)\nplotEnrich(ego, plot_type = \"gomap\", wrap_length = 25,\n           up_color = '#a32a31',down_color = '#3665a6')"},{"path":"plot-go-kegg-1.html","id":"go-terms-heatmap-plot","chapter":"10 Plot GO and KEGG","heading":"10.12 GO: Terms Heatmap Plot","text":"Inspired rrvgo, genekitr scratches main codes cluster GO terms. Also use five methods calculate similarity terms.\nFigure 10.13: GO heatmap plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"goheat\", sim_method = \"Rel\")"},{"path":"plot-go-kegg-1.html","id":"go-terms-tangram-plot","chapter":"10 Plot GO and KEGG","heading":"10.13 GO: Terms Tangram Plot","text":"According rrvgo vignettes, tangram plot space-filling visualization hierarchical structures. terms grouped colored based parent, space used term proportional score.\nFigure 10.14: GO tangram plot enrichment analysis.\n","code":"\nplotEnrich(ego, plot_type = \"gotangram\", sim_method = \"Rel\")"},{"path":"plot-go-kegg-1.html","id":"plot-theme","chapter":"10 Plot GO and KEGG","heading":"10.14 Plot Theme","text":"Genekitr provides function plot_theme() modify plots theme including text size, border, legend, color, etc.\nFigure 10.15: Plot theme. default theme (), modify text size (B), modify grid line border size (C) remove text legend (D).\n","code":"\nlibrary(patchwork)\np1 <- plotEnrich(ego, plot_type = \"dot\")\np2 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  main_text_size = 10,\n  legend_text_size = 10\n)\n\np3 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  border_thick = 3,\n  remove_grid = F\n)\n\np4 <- plotEnrich(ego,\n  plot_type = \"dot\",\n  remove_main_text = T,\n  remove_legend_text = T,\n  remove_legend = T\n)\np1 + p2 + p3 + p4 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-go-kegg-1.html","id":"advanced-plot","chapter":"10 Plot GO and KEGG","heading":"10.15 Advanced Plot","text":"","code":""},{"path":"plot-go-kegg-1.html","id":"two-group-barplot-for-updown-regulated-pathways","chapter":"10 Plot GO and KEGG","heading":"10.15.1 Two-group barplot for up/down regulated pathways","text":"user genGO genKEGG regulated genes separately wants visualize together, two-group barplot well suited. take GO result example:two visulization types:plot_type = \"one\": -regulated pathways plotted togetherplot_type = \"two\": -regulated pathways plotted separately. Recommended number groups similar.\nFigure 10.16: Visualize two groups together plot_type = \"one\".\n\nFigure 10.17: Visualize two groups seperately plot_type = \"two\".\n","code":"\n# Since the geneList is logFC decreasing ordered, we could take first 100 as up-regulated genes and vice versa.\ndata(geneList, package = \"genekitr\")\nup_genes <- head(names(geneList), 100)\ndown_genes <- tail(names(geneList), 100)\n\nup_go <- genGO(up_genes,\n               org = \"human\", \n               ont = \"bp\", \n               pvalueCutoff = 0.05,\n               qvalueCutoff = 0.05\n)\n\ndown_go <- genGO(down_genes,\n                 org = \"human\", \n                 ont = \"bp\", \n                 pvalueCutoff = 0.01,\n                 qvalueCutoff = 0.01\n)\n\ndim(up_go)## [1] 62 12\ndim(down_go)## [1] 114  12\n# seems that up/down-regulated pathways are too many, here we only take 10 of them\nup_go <- head(up_go, 10)\ndown_go <- head(down_go, 10)\nplotEnrichAdv(up_go, down_go,\n              plot_type = \"one\",\n              term_metric = \"FoldEnrich\",\n              stats_metric = \"p.adjust\",\n              xlim_left = 25, xlim_right = 15) +\n  theme(legend.position = c(0.15, 0.9))\nplotEnrichAdv(up_go, down_go,\n              plot_type = \"two\",\n              term_metric = \"FoldEnrich\",\n              stats_metric = \"qvalue\"\n)"},{"path":"plot-gsea-1.html","id":"plot-gsea-1","chapter":"11 Plot GSEA","heading":"11 Plot GSEA","text":"GSEA analysis returns list result, directly passed plotGSEA. function help draw classic pathway plot, volcano plot, multi-pathway plot, ridge plot two-side bar plot.","code":"\ndata(geneList, package = \"genekitr\")\ngse <- genGSEA(\n  genelist = geneList, \n  org = \"human\",\n  category = \"H\", \n  pvalueCutoff = 0.05\n)"},{"path":"plot-gsea-1.html","id":"classic-pathway-plot","chapter":"11 Plot GSEA","heading":"11.1 Classic Pathway Plot","text":"Running enrichment score gene set drawn classic pathway plot lines. function walks ranked gene list. vertical lines middle show location gene set members.user wants show specific pathways genes, just pass according parameters: show_pathway show_gene.\nFigure 11.1: Classic pathway plot GSEA.\n","code":"\npathways <- c(\"HALLMARK_P53_PATHWAY\", \"HALLMARK_GLYCOLYSIS\", \"HALLMARK_DNA_REPAIR\")\ngenes <- c(\"MET\", \"TP53\", \"PMM2\")\nplotGSEA(gse, plot_type = \"classic\", show_pathway = pathways, show_gene = genes)"},{"path":"plot-gsea-1.html","id":"volcano-pathway-plot","chapter":"11 Plot GSEA","heading":"11.2 Volcano Pathway Plot","text":"plot, degree enrichment indicated normalized enrichment score NES.Slightly different DEG volcano plot, x-axis represented NES, corrects enrichment score differences among gene-sets.significant positive NES value indicates members gene set tend appear top ranked data (e.g. fold change DEG) significant negative NES indicates opposite.Default shows top(N) pathways. user wants show specific pathway, also pass argument show_pathway.\nFigure 11.2: Volcano pathway plot GSEA. default (), select pathways (B).\n","code":"\nlibrary(patchwork)\npathways <- c(\"HALLMARK_P53_PATHWAY\", \"HALLMARK_GLYCOLYSIS\", \"HALLMARK_DNA_REPAIR\")\np1 <- plotGSEA(gse, plot_type = \"volcano\", show_pathway = 3)\np2 <- plotGSEA(gse, plot_type = \"volcano\", show_pathway = pathways)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-gsea-1.html","id":"multi-pathway-plot","chapter":"11 Plot GSEA","heading":"11.3 Multi-pathway Plot","text":"user wants show bunch selected pathways, plotGSEA scratched codes fgsea.Default shows top(N) pathways. user wants show specific pathway, also pass argument show_pathway.\nFigure 11.3: Multi-pathway plot GSEA. default (), select pathways (B).\n","code":"\nlibrary(patchwork)\npathways <- c(\"HALLMARK_P53_PATHWAY\", \"HALLMARK_GLYCOLYSIS\", \"HALLMARK_DNA_REPAIR\")\np1 <- plotGSEA(gse, plot_type = \"fgsea\", show_pathway = 5)\np2 <- plotGSEA(gse, plot_type = \"fgsea\", show_pathway = pathways)\np1 + p2 + plot_annotation(tag_levels = \"A\")"},{"path":"plot-gsea-1.html","id":"ridge-plot","chapter":"11 Plot GSEA","heading":"11.4 Ridge Plot","text":"Ridge plot visualize enriched pathways /regulated genes. x-axis fold change y-axis pathways. Color represents statistical value (e.g. pvalue/p.adjust/qvalue)\nFigure 11.4: Ridge plot GSEA.\n","code":"\nplotGSEA(gse,\n  plot_type = \"ridge\",\n  show_pathway = 10, stats_metric = \"p.adjust\"\n)"},{"path":"plot-gsea-1.html","id":"two-side-barplot","chapter":"11 Plot GSEA","heading":"11.5 Two-side Barplot","text":"barplot separate positive negative NES two sides. User specify color two sides. Meanwhile, non-significant pathways (e.g. Pvalue > 0.05) colored “grey”.\nFigure 11.5: Two-side bar plot GSEA.\n","code":"\nplotGSEA(gse, plot_type = \"bar\", colour = c(\"navyblue\", \"orange\"))"},{"path":"plot-others-1.html","id":"plot-others-1","chapter":"12 Plot others","heading":"12 Plot others","text":"part, introduce plotVenn plotVolcano.","code":""},{"path":"plot-others-1.html","id":"venn-plot","chapter":"12 Plot others","heading":"12.1 Venn Plot","text":"Venn plot needs list gene sets, example:plotVenn supports two types: Venn (default) UpSet. Besides, also supports modification text size, alpha degree, colors parameters plot_theme.\nFigure 12.1: Venn plot\nUpSet plot better four groups genes:\nFigure 12.2: UpSet plot\n","code":"\nset1 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset2 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset3 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset4 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\nset5 <- paste0(rep(\"gene\", 100), sample(1:1000, 100))\n\n# three groups\nsm_gene_list <- list(gset1 = set1, gset2 = set2, gset3 = set3)\n\n# five groups\nla_gene_list <- list(\n  gset1 = set1, gset2 = set2, gset3 = set3,\n  gset4 = set4, gset5 = set5\n)\nplotVenn(sm_gene_list,\n         use_venn = TRUE,\n         color = ggsci::pal_lancet()(3),\n         alpha_degree = 1,\n         main_text_size = 1.5,\n         border_thick = 0\n)\nplotVenn(la_gene_list,\n         use_venn = FALSE,\n         main_text_size = 15,\n         legend_text_size = 8,\n         legend_position = 'left'\n)"},{"path":"plot-others-1.html","id":"volcano-plot","chapter":"12 Plot others","heading":"12.2 Volcano Plot","text":"finishing differential expression analysis, get differentially expressed genes (DEG).\nVolcano plot widely used /regulated genes visualization.example data micro array differential expression analysis:plotVolcano mainly uses DEG result include gene id, fold change statistic value.also parameters:stat_metric: choose “pvalue” “p.adjust”stat_cutoff: cutoff significant statistic value, default 0.05logFC_cutoff: cutoff log2 (fold change), default 1 actually two fold changesup_color: color -regulated genesdown_color: color -regulated genesshow_gene: show gene names, default none. Suggest renaming column genes “gene”.dot_size: volcano dot size\nFigure 12.3: Volcano plot\nwant show genes:\nFigure 12.4: Volcano plot genes.\nTrick increasing text size:User hide x/y-axis labels raise main_text_size enlarge gene text, export figure PPT add labels.","code":"\ndata(deg, package = \"genekitr\")\nhead(deg,5)##   probe_id      logFC   AveExpr         t      P.Value   adj.P.Val          B\n## 1  8144866  0.5672300  5.761898  6.591099 2.496346e-04 0.002269049  0.3372158\n## 2  8066431  0.6526467  9.809843  7.768724 8.554137e-05 0.001045237  1.5161421\n## 3  8022674  0.2768667 11.926333  3.958127 4.974269e-03 0.021521339 -2.9321234\n## 4  7925531 -0.1321333 11.217700 -1.914468 9.517321e-02 0.198247263 -5.9932047\n## 5  8081358  0.3972133  8.994403  4.457386 2.618820e-03 0.013189962 -2.2375610\n##   change  entrezid     symbol\n## 1 stable        10       NAT2\n## 2 stable       100        ADA\n## 3 stable      1000       CDH2\n## 4 stable     10000       AKT3\n## 5 stable 100009676 ZBTB11-AS1\nplotVolcano(deg, \"p.adjust\", remove_legend = T, dot_size = 3)\nplotVolcano(deg, \"p.adjust\",\n  remove_legend = T,\n  show_gene = c(\"CD36\", \"DUSP6\", \"IER3\", \"CDH7\")\n)\nplotVolcano(deg, \"p.adjust\",\n  remove_legend = T,\n  remove_main_text = T,\n  show_gene = c(\"CD36\", \"DUSP6\", \"IER3\", \"CDH7\"),\n   main_text_size = 15, dot_size = 2.5\n)"}]
