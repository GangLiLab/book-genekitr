<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 10 Import External Data | Genekitr: Gene Analysis Toolkit based on R</title>
<meta name="author" content="Yunze Liu">
<meta name="description" content="10.1 Import GO panther genekitr::importPanther() support importing panther result from GeneOntology and formatting as genGO result.   Figure 10.1: Import panther result.  For example, we save...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 10 Import External Data | Genekitr: Gene Analysis Toolkit based on R">
<meta property="og:type" content="book">
<meta property="og:description" content="10.1 Import GO panther genekitr::importPanther() support importing panther result from GeneOntology and formatting as genGO result.   Figure 10.1: Import panther result.  For example, we save...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 10 Import External Data | Genekitr: Gene Analysis Toolkit based on R">
<meta name="twitter:description" content="10.1 Import GO panther genekitr::importPanther() support importing panther result from GeneOntology and formatting as genGO result.   Figure 10.1: Import panther result.  For example, we save...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.22/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genekitr: Gene Analysis Toolkit based on R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">üß¨ Welcome to genekitr!</a></li>
<li><a class="" href="quick-start.html"><span class="header-section-number">1</span> Quick start</a></li>
<li class="book-part">Part I: Search Information</li>
<li><a class="" href="search-gene-metadata-1.html"><span class="header-section-number">2</span> Search gene metadata</a></li>
<li><a class="" href="search-pubmed-1.html"><span class="header-section-number">3</span> Search PubMed records</a></li>
<li class="book-part">Part II: ID Conversion</li>
<li><a class="" href="gene-id-conversion-1.html"><span class="header-section-number">4</span> Gene ID conversion</a></li>
<li><a class="" href="protein-id-conversion-1.html"><span class="header-section-number">5</span> Protein ID conversion</a></li>
<li><a class="" href="probe-id-conversion-1.html"><span class="header-section-number">6</span> Probe ID conversion</a></li>
<li class="book-part">Part III: Enrichment Analysis</li>
<li><a class="" href="ora-go-analysis-1.html"><span class="header-section-number">7</span> ORA GO analysis</a></li>
<li><a class="" href="ora-kegg-analysis-1.html"><span class="header-section-number">8</span> ORA KEGG analysis</a></li>
<li><a class="" href="functional-class-scoring-1.html"><span class="header-section-number">9</span> Functional Class Scoring</a></li>
<li><a class="active" href="import-external-data.html"><span class="header-section-number">10</span> Import External Data</a></li>
<li class="book-part">Part IV: Plotting</li>
<li><a class="" href="plot-go-kegg-1.html"><span class="header-section-number">11</span> Plot GO and KEGG</a></li>
<li><a class="" href="plot-gsea-1.html"><span class="header-section-number">12</span> Plot GSEA</a></li>
<li><a class="" href="plot-others-1.html"><span class="header-section-number">13</span> Plot others</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="import-external-data" class="section level1">
<h1>
<span class="header-section-number">10</span> Import External Data<a class="anchor" aria-label="anchor" href="#import-external-data"><i class="fas fa-link"></i></a>
</h1>
<div id="import-panther" class="section level2">
<h2>
<span class="header-section-number">10.1</span> Import GO panther<a class="anchor" aria-label="anchor" href="#import-panther"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://rdrr.io/pkg/genekitr/man/importPanther.html">genekitr::importPanther()</a></code> support importing <a href="http://pantherdb.org/webservices/go/overrep.jsp">panther</a> result from <a href="http://geneontology.org/">GeneOntology</a> and formatting as <code>genGO</code> result.</p>


<div class="figure">
<span style="display:block;" id="fig:goPanther"></span>
<img src="figures/panther_exp.png" alt="Import panther result." width="100%"><p class="caption">
Figure 10.1: <strong>Import panther result.</strong>
</p>
</div>
<p>For example, we save panther result as ‚Äúanalysis.txt‚Äù and pass to <code>importPanther</code>. It will tidy the data and calculate both fold enrichment and rich factor.</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">panther_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/importPanther.html">importPanther</a></span><span class="op">(</span><span class="st">"data/analysis.txt"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">panther_res</span>, <span class="fl">5</span><span class="op">)</span></code></pre></div>
<pre><code>##           ID
## 1 GO:1901295
## 2 GO:0036520
## 3 GO:0036304
## 4 GO:1905066
## 5 GO:0060844
##                                                                                      Description
## 1 regulation of canonical Wnt signaling pathway involved in cardiac muscle cell fate commitment 
## 2                                                       astrocyte-dopaminergic neuron signaling 
## 3                                                                  umbilical cord morphogenesis 
## 4                   regulation of canonical Wnt signaling pathway involved in heart development 
## 5                                                     arterial endothelial cell fate commitment 
##    GeneRatio      BgRatio upload_1 (42) upload_1 (expected)
## 1 0.04761905 9.713925e-05             2                0.00
## 2 0.07142857 1.457089e-04             3                0.01
## 3 0.04761905 9.713925e-05             2                0.00
## 4 0.04761905 9.713925e-05             2                0.00
## 5 0.04761905 9.713925e-05             2                0.00
##   upload_1 (over/under) FoldEnrich   pvalue   qvalue Count   RichFactor
## 1                     +   490.2143 2.42e-05 9.30e-04     2 9.713925e-05
## 2                     +   490.2143 1.56e-07 1.06e-05     3 1.457089e-04
## 3                     +   490.2143 2.42e-05 9.28e-04     2 9.713925e-05
## 4                     +   490.2143 2.42e-05 9.26e-04     2 9.713925e-05
## 5                     +   490.2143 2.42e-05 9.23e-04     2 9.713925e-05</code></pre>
<p>Then, you could select interested terms and utilize plot functions on <a href="plot-go-kegg-1.html#plot-go-kegg-1">Chapter 11</a>.</p>
<p>For example:</p>


<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">panther_res</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">100</span>,<span class="fl">350</span>,<span class="fl">580</span>,<span class="fl">700</span><span class="op">)</span>,<span class="op">]</span>, 
           plot_type <span class="op">=</span> <span class="st">"bar"</span>,
           stats_metric <span class="op">=</span> <span class="st">"qvalue"</span>, 
           term_metric <span class="op">=</span> <span class="st">"GeneRatio"</span>,
           main_text_size <span class="op">=</span> <span class="fl">13</span>,
           legend_text_size <span class="op">=</span> <span class="fl">10</span>
           <span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:impPanther"></span>
<img src="genekitr_files/figure-html/impPanther-1.png" alt="Bar plot of Panther result." width="98%"><p class="caption">
Figure 10.2: <strong>Bar plot of Panther result.</strong>
</p>
</div>
</div>
<div id="import-clusterProfiler" class="section level2">
<h2>
<span class="header-section-number">10.2</span> Import clusterProfiler object<a class="anchor" aria-label="anchor" href="#import-clusterProfiler"><i class="fas fa-link"></i></a>
</h2>
<p><a href="http://bioconductor.org/packages/clusterProfiler">clusterProfiler</a> is a popular R package of enrichment analysis. However, it requires user has some programming skills to operate its S4 object, which may cause inconvenience in data cleaning and visualization.</p>
<p>Here, <code><a href="https://rdrr.io/pkg/genekitr/man/importCP.html">genekitr::importCP()</a></code> could easily import the S4 object with additional attributes (e.g.¬†FoldEnrich, RichFactor) to help users communicate with data more fluently.</p>
<div id="clusterprofiler-ora-go-result" class="section level3">
<h3>
<span class="header-section-number">10.2.1</span> clusterProfiler ORA-GO result<a class="anchor" aria-label="anchor" href="#clusterprofiler-ora-go-result"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## example data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">clusterProfiler</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">org.Hs.eg.db</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package<span class="op">=</span><span class="st">"DOSE"</span><span class="op">)</span>
<span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">]</span>

<span class="co">## GO result from clusterProfiler</span>
<span class="va">go</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/enrichGO.html">enrichGO</a></span><span class="op">(</span>gene          <span class="op">=</span> <span class="va">gene</span>,
                OrgDb         <span class="op">=</span> <span class="va">org.Hs.eg.db</span>,
                ont           <span class="op">=</span> <span class="st">"BP"</span>,
                pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,
                pvalueCutoff  <span class="op">=</span> <span class="fl">0.01</span>,
                qvalueCutoff  <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/isS4.html">isS4</a></span><span class="op">(</span><span class="va">go</span><span class="op">)</span> <span class="co"># return a S4 object</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## import </span>
<span class="va">go_easy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/importCP.html">importCP</a></span><span class="op">(</span><span class="va">go</span>, type <span class="op">=</span> <span class="st">"go"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">is.data.frame</a></span><span class="op">(</span><span class="va">go_easy</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># keep the same as the original result</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">go</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">go_easy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">go_easy</span><span class="op">)</span></code></pre></div>
<pre><code>##              hs_BP_ID                          Description GeneRatio   BgRatio
## GO:0140014 GO:0140014             mitotic nuclear division 0.1752577 286/18866
## GO:0000280 GO:0000280                     nuclear division 0.1855670 428/18866
## GO:0048285 GO:0048285                    organelle fission 0.1907216 476/18866
## GO:0000070 GO:0000070 mitotic sister chromatid segregation 0.1237113 161/18866
## GO:0000819 GO:0000819         sister chromatid segregation 0.1288660 196/18866
## GO:0007059 GO:0007059               chromosome segregation 0.1494845 334/18866
##                  pvalue     p.adjust       qvalue
## GO:0140014 2.171838e-26 6.700119e-23 5.710790e-23
## GO:0000280 1.099719e-22 1.696316e-19 1.445841e-19
## GO:0048285 4.058841e-22 4.173841e-19 3.557538e-19
## GO:0000070 3.322345e-21 2.562358e-18 2.184005e-18
## GO:0000819 2.422383e-20 1.494610e-17 1.273918e-17
## GO:0007059 9.308954e-19 4.786354e-16 4.079608e-16
##                                                                                                                                                                                                         geneID
## GO:0140014                  55143/991/9493/1062/4605/9133/10403/23397/9787/11065/51203/22974/10460/4751/27338/983/4085/81930/81620/332/3832/7272/64151/9212/1111/9319/9055/3833/146909/6790/891/24137/9232/652
## GO:0000280      55143/991/9493/1062/4605/9133/10403/7153/23397/259266/9787/11065/51203/22974/10460/4751/27338/983/4085/81930/81620/332/3832/7272/64151/9212/1111/9319/9055/3833/146909/6790/891/24137/9232/652
## GO:0048285 55143/991/9493/1062/4605/9133/10403/7153/23397/259266/9787/11065/51203/22974/10460/4751/27338/983/4085/81930/81620/332/3832/7272/64151/9212/1111/9319/9055/3833/146909/6790/891/24137/9232/652/4137
## GO:0000070                                                                   55143/991/9493/1062/10403/23397/9787/11065/51203/10460/4751/4085/81930/81620/7272/64151/9212/9319/9055/3833/146909/891/24137/9232
## GO:0000819                                                              55143/991/9493/1062/10403/7153/23397/9787/11065/51203/10460/4751/4085/81930/81620/7272/64151/9212/9319/9055/3833/146909/891/24137/9232
## GO:0007059                                       55143/991/9493/1062/10403/7153/23397/9787/11065/55355/220134/51203/10460/4751/55839/4085/81930/81620/332/7272/64151/9212/9319/9055/3833/146909/891/24137/9232
##                                                                                                                                                                                                                        geneID_symbol
## GO:0140014                 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/NCAPH/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4
## GO:0000280      CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/ASPM/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4
## GO:0048285 CDCA8/CDC20/KIF23/CENPE/MYBL2/CCNB2/NDC80/TOP2A/NCAPH/ASPM/DLGAP5/UBE2C/NUSAP1/TPX2/TACC3/NEK2/UBE2S/CDK1/MAD2L1/KIF18A/CDT1/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/TRIP13/PRC1/KIFC1/KIF18B/AURKA/CCNB1/KIF4A/PTTG1/BMP4/MAPT
## GO:0000070                                                                          CDCA8/CDC20/KIF23/CENPE/NDC80/NCAPH/DLGAP5/UBE2C/NUSAP1/TACC3/NEK2/MAD2L1/KIF18A/CDT1/TTK/NCAPG/AURKB/TRIP13/PRC1/KIFC1/KIF18B/CCNB1/KIF4A/PTTG1
## GO:0000819                                                                    CDCA8/CDC20/KIF23/CENPE/NDC80/TOP2A/NCAPH/DLGAP5/UBE2C/NUSAP1/TACC3/NEK2/MAD2L1/KIF18A/CDT1/TTK/NCAPG/AURKB/TRIP13/PRC1/KIFC1/KIF18B/CCNB1/KIF4A/PTTG1
## GO:0007059                                             CDCA8/CDC20/KIF23/CENPE/NDC80/TOP2A/NCAPH/DLGAP5/UBE2C/HJURP/SKA1/NUSAP1/TACC3/NEK2/CENPN/MAD2L1/KIF18A/CDT1/BIRC5/TTK/NCAPG/AURKB/TRIP13/PRC1/KIFC1/KIF18B/CCNB1/KIF4A/PTTG1
##            Count FoldEnrich RichFactor
## GO:0140014    34  11.560882 0.11888112
## GO:0000280    36   8.179690 0.08411215
## GO:0048285    37   7.559148 0.07773109
## GO:0000070    24  14.496510 0.14906832
## GO:0000819    25  12.404008 0.12755102
## GO:0007059    29   8.443638 0.08682635</code></pre>
<p>Then you could select interested terms and utilize plot functions on <a href="plot-go-kegg-1.html#plot-go-kegg-1">Chapter 11</a>.</p>
<p>For example:</p>


<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">go_easy</span>,<span class="fl">20</span><span class="op">)</span>, 
           plot_type <span class="op">=</span> <span class="st">"genechord"</span>, 
           show_gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"UBE2C"</span>, <span class="st">"CDC20"</span>, <span class="st">"NDC80"</span><span class="op">)</span>,
           main_text_size <span class="op">=</span> <span class="fl">10</span>,
           legend_text_size <span class="op">=</span> <span class="fl">10</span>
           <span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:impCPGO"></span>
<img src="genekitr_files/figure-html/impCPGO-1.png" alt="Chord plot of clusterProfiler result." width="98%"><p class="caption">
Figure 10.3: <strong>Chord plot of clusterProfiler result.</strong>
</p>
</div>
</div>
<div id="clusterprofiler-gsea-result" class="section level3">
<h3>
<span class="header-section-number">10.2.2</span> clusterProfiler GSEA result<a class="anchor" aria-label="anchor" href="#clusterprofiler-gsea-result"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package<span class="op">=</span><span class="st">"DOSE"</span><span class="op">)</span>
<span class="co">## GSEA result from clusterProfiler</span>
<span class="va">kk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/clusterProfiler/man/gseKEGG.html">gseKEGG</a></span><span class="op">(</span>geneList     <span class="op">=</span> <span class="va">geneList</span>,
               organism     <span class="op">=</span> <span class="st">'hsa'</span>,
               minGSSize    <span class="op">=</span> <span class="fl">120</span>,
               pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span>,
               verbose      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co">## import</span>
<span class="va">kk_easy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/importCP.html">importCP</a></span><span class="op">(</span><span class="va">kk</span>,type <span class="op">=</span> <span class="st">'gsea'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">kk</span><span class="op">@</span><span class="va">result</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">kk_easy</span><span class="op">$</span><span class="va">gsea_df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Then you could select interested terms and utilize plot functions on <a href="##plot-gsea-1">Chapter 12</a>.</p>
<p>For example:</p>


<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotGSEA.html">plotGSEA</a></span><span class="op">(</span><span class="va">kk_easy</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>,
         main_text_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:impCPGSEA1"></span>
<img src="genekitr_files/figure-html/impCPGSEA1-1.png" alt="Two-side bar plot of clusterProfiler result." width="98%"><p class="caption">
Figure 10.4: <strong>Two-side bar plot of clusterProfiler result.</strong>
</p>
</div>
<p>The IDs in the plot are actually from <code>ID</code> column in <code>kk_easy</code> result. If we want to add more content, just modify the <code>ID</code> column:</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kk_easy</span><span class="op">$</span><span class="va">gsea_df</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">kk_easy</span><span class="op">$</span><span class="va">gsea_df</span><span class="op">$</span><span class="va">ID</span>, <span class="va">kk_easy</span><span class="op">$</span><span class="va">gsea_df</span><span class="op">$</span><span class="va">Description</span>,sep <span class="op">=</span> <span class="st">": "</span><span class="op">)</span></code></pre></div>


<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotGSEA.html">plotGSEA</a></span><span class="op">(</span><span class="va">kk_easy</span>, plot_type <span class="op">=</span> <span class="st">"bar"</span>,
         main_text_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:impCPGSEA2"></span>
<img src="genekitr_files/figure-html/impCPGSEA2-1.png" alt="Two-side bar plot after modifying labels." width="98%"><p class="caption">
Figure 10.5: <strong>Two-side bar plot after modifying labels.</strong>
</p>
</div>
</div>
<div id="clusterprofiler-keggdosewikipathways-result" class="section level3">
<h3>
<span class="header-section-number">10.2.3</span> clusterProfiler KEGG/DOSE/WikiPathways‚Ä¶ result<a class="anchor" aria-label="anchor" href="#clusterprofiler-keggdosewikipathways-result"><i class="fas fa-link"></i></a>
</h3>
<p><code>clusterProfiler</code> supports many gene sets, including <a href="https://disease-ontology.org/">Disease Ontology (DO)</a>, <a href="https://www.wikipathways.org/">WikiPathways</a>, <a href="http://bioconductor.org/packages/ReactomePA">ReactomePA</a></p>
<p>Take DO as example:</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yulab-smu.top/biomedical-knowledge-mining-book/">DOSE</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span>
<span class="va">gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1.5</span><span class="op">]</span>

<span class="co">## ORA-DO result from clusterProfiler</span>
<span class="va">do</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/DOSE/man/enrichDO.html">enrichDO</a></span><span class="op">(</span>gene          <span class="op">=</span> <span class="va">gene</span>,
              ont           <span class="op">=</span> <span class="st">"DO"</span>,
              pvalueCutoff  <span class="op">=</span> <span class="fl">0.05</span>,
              pAdjustMethod <span class="op">=</span> <span class="st">"BH"</span>,
              universe      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">geneList</span><span class="op">)</span>,
              minGSSize     <span class="op">=</span> <span class="fl">5</span>,
              maxGSSize     <span class="op">=</span> <span class="fl">500</span>,
              qvalueCutoff  <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>

<span class="co"># import</span>
<span class="va">do_easy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/importCP.html">importCP</a></span><span class="op">(</span><span class="va">do</span>,type <span class="op">=</span> <span class="st">'other'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">do</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">do_easy</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Then you could select interested terms and utilize plot functions on <a href="plot-go-kegg-1.html#plot-go-kegg-1">Chapter 11</a>.</p>
<p>For example:</p>


<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/genekitr/man/plotEnrich.html">plotEnrich</a></span><span class="op">(</span><span class="va">do_easy</span>, 
           plot_type <span class="op">=</span> <span class="st">"network"</span>, 
           layout <span class="op">=</span> <span class="st">"circle"</span>, 
           scale_ratio <span class="op">=</span> <span class="fl">1</span>,
           main_text_size <span class="op">=</span> <span class="fl">7</span>,
           legend_text_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:impCPDO"></span>
<img src="genekitr_files/figure-html/impCPDO-1.png" alt="Chord plot of clusterProfiler result." width="98%"><p class="caption">
Figure 10.6: <strong>Chord plot of clusterProfiler result.</strong>
</p>
</div>

</div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="functional-class-scoring-1.html"><span class="header-section-number">9</span> Functional Class Scoring</a></div>
<div class="next"><a href="plot-go-kegg-1.html"><span class="header-section-number">11</span> Plot GO and KEGG</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#import-external-data"><span class="header-section-number">10</span> Import External Data</a></li>
<li><a class="nav-link" href="#import-panther"><span class="header-section-number">10.1</span> Import GO panther</a></li>
<li>
<a class="nav-link" href="#import-clusterProfiler"><span class="header-section-number">10.2</span> Import clusterProfiler object</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#clusterprofiler-ora-go-result"><span class="header-section-number">10.2.1</span> clusterProfiler ORA-GO result</a></li>
<li><a class="nav-link" href="#clusterprofiler-gsea-result"><span class="header-section-number">10.2.2</span> clusterProfiler GSEA result</a></li>
<li><a class="nav-link" href="#clusterprofiler-keggdosewikipathways-result"><span class="header-section-number">10.2.3</span> clusterProfiler KEGG/DOSE/WikiPathways‚Ä¶ result</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genekitr: Gene Analysis Toolkit based on R</strong>" was written by Yunze Liu. It was last built on 2022-06-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
