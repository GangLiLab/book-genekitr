<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 1 Plot GSEA | Genekitr: Gene Analysis Toolkit based on R</title>
<meta name="author" content="Yunze Liu">
<meta name="description" content="genGSEA returns a list format result, user could pass the list object to plotGSEA, which gets classic pathway plot, volcano plot, multi-pathway plot, ridge plot and two-side bar plot....">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 1 Plot GSEA | Genekitr: Gene Analysis Toolkit based on R">
<meta property="og:type" content="book">
<meta property="og:description" content="genGSEA returns a list format result, user could pass the list object to plotGSEA, which gets classic pathway plot, volcano plot, multi-pathway plot, ridge plot and two-side bar plot....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 1 Plot GSEA | Genekitr: Gene Analysis Toolkit based on R">
<meta name="twitter:description" content="genGSEA returns a list format result, user could pass the list object to plotGSEA, which gets classic pathway plot, volcano plot, multi-pathway plot, ridge plot and two-side bar plot....">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Genekitr: Gene Analysis Toolkit based on R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">ðŸ“– Introduction</a></li>
<li><a class="active" href="plot-gsea.html"><span class="header-section-number">1</span> Plot GSEA</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="plot-gsea" class="section level1">
<h1>
<span class="header-section-number">1</span> Plot GSEA<a class="anchor" aria-label="anchor" href="#plot-gsea"><i class="fas fa-link"></i></a>
</h1>
<p><code>genGSEA</code> returns a list format result, user could pass the list object to <code>plotGSEA</code>, which gets classic pathway plot, volcano plot, multi-pathway plot, ridge plot and two-side bar plot.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">geneList</span>, package <span class="op">=</span> <span class="st">"genekitr"</span><span class="op">)</span>
<span class="va">gse</span> <span class="op">&lt;-</span> <span class="fu">genGSEA</span><span class="op">(</span>genelist <span class="op">=</span> <span class="va">geneList</span>, org <span class="op">=</span> <span class="st">"human"</span>,
               category <span class="op">=</span> <span class="st">"H"</span>,use_symbol <span class="op">=</span> <span class="cn">TRUE</span>, pvalueCutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<div id="classic-pathway-plot" class="section level2">
<h2>
<span class="header-section-number">1.1</span> Classic Pathway Plot<a class="anchor" aria-label="anchor" href="#classic-pathway-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Running enrichment score for a gene set is set as classic pathway plot lines. The function will walks down the ranked gene list. The vertical lines in the middle show the location of gene set members.</p>
<p>If user wants to show specific genes or pathways, just pass to according parameters: <code>show_pathway</code> and <code>show_gene</code>.</p>


<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HALLMARK_P53_PATHWAY"</span>,<span class="st">"HALLMARK_GLYCOLYSIS"</span>,<span class="st">"HALLMARK_DNA_REPAIR"</span><span class="op">)</span>
<span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MET"</span>, <span class="st">"TP53"</span>, <span class="st">"PMM2"</span><span class="op">)</span>
<span class="fu">plotGSEA</span><span class="op">(</span><span class="va">gse</span>, plot_type <span class="op">=</span> <span class="st">'classic'</span>, show_pathway <span class="op">=</span> <span class="va">pathways</span>, show_gene <span class="op">=</span> <span class="va">genes</span><span class="op">)</span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:classicGSEA"></span>
<img src="genekitr_files/figure-html/classicGSEA-1.png" alt="Classic pathway plot of GSEA." width="98%"><p class="caption">
Figure 1.1: <strong>Classic pathway plot of GSEA.</strong>
</p>
</div>
</div>
<div id="volcano-pathway-plot" class="section level2">
<h2>
<span class="header-section-number">1.2</span> Volcano Pathway Plot<a class="anchor" aria-label="anchor" href="#volcano-pathway-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Slightly different with DEG volcano plot, the x-axis is represented as NES, standing for normalized enrichment score, which corrects for differences in ES between gene-sets due to differences in gene-set sizes.</p>
<p>A significant positive NES value indicates that members of the gene set tend to appear at the top of the ranked data (e.g.Â fold change of DEG) and a significant negative NES indicates the opposite.</p>
<p>Default shows the topN pathways. If user wants to show specific pathway, also pass the argument to <code>show_pathway</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HALLMARK_P53_PATHWAY"</span>,<span class="st">"HALLMARK_GLYCOLYSIS"</span>,<span class="st">"HALLMARK_DNA_REPAIR"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plotGSEA</span><span class="op">(</span><span class="va">gse</span>, plot_type <span class="op">=</span> <span class="st">'volcano'</span>, show_pathway <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">plotGSEA</span><span class="op">(</span><span class="va">gse</span>, plot_type <span class="op">=</span> <span class="st">'volcano'</span>,show_pathway <span class="op">=</span> <span class="va">pathways</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:volcanoGSEA"></span>
<img src="genekitr_files/figure-html/volcanoGSEA-1.png" alt="Volcano pathway plot of GSEA. default (A), select pathways (B)." width="98%"><p class="caption">
Figure 1.2: <strong>Volcano pathway plot of GSEA.</strong> default (A), select pathways (B).
</p>
</div>
</div>
<div id="multi-pathway-plot" class="section level2">
<h2>
<span class="header-section-number">1.3</span> Multi-pathway Plot<a class="anchor" aria-label="anchor" href="#multi-pathway-plot"><i class="fas fa-link"></i></a>
</h2>
<p>If user wants to show a bunch of selected pathways, <code>plotGSEA</code> has scratched some codes from <a href="http://bioconductor.org/packages/fgsea">fgsea</a>.</p>
<p>Default shows the topN pathways. If user wants to show specific pathway, also pass the argument to <code>show_pathway</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HALLMARK_P53_PATHWAY"</span>,<span class="st">"HALLMARK_GLYCOLYSIS"</span>,<span class="st">"HALLMARK_DNA_REPAIR"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">plotGSEA</span><span class="op">(</span><span class="va">gse</span>, plot_type <span class="op">=</span> <span class="st">'fgsea'</span>, show_pathway <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">plotGSEA</span><span class="op">(</span><span class="va">gse</span>, plot_type <span class="op">=</span> <span class="st">'fgsea'</span>,show_pathway <span class="op">=</span> <span class="va">pathways</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span></code></pre></div>


<div class="figure">
<span style="display:block;" id="fig:fgseaGSEA"></span>
<img src="genekitr_files/figure-html/fgseaGSEA-1.png" alt="Multi-pathway plot of GSEA. default (A), select pathways (B)." width="98%"><p class="caption">
Figure 1.3: <strong>Multi-pathway plot of GSEA.</strong> default (A), select pathways (B).
</p>
</div>
</div>
<div id="ridge-plot" class="section level2">
<h2>
<span class="header-section-number">1.4</span> Ridge Plot<a class="anchor" aria-label="anchor" href="#ridge-plot"><i class="fas fa-link"></i></a>
</h2>
<p>Ridge plot will visualize enriched pathways of up/down regulated genes. The x-axis is fold change and y-axis is pathways. Different color represents statistical value (e.g.Â pvalue/p.adjust/qvalue)</p>


<div class="figure">
<span style="display:block;" id="fig:ridge"></span>
<img src="genekitr_files/figure-html/ridge-1.png" alt="Ridge plot of GSEA." width="98%"><p class="caption">
Figure 1.4: <strong>Ridge plot of GSEA.</strong>
</p>
</div>
</div>
<div id="two-side-barplot" class="section level2">
<h2>
<span class="header-section-number">1.5</span> Two-side Barplot<a class="anchor" aria-label="anchor" href="#two-side-barplot"><i class="fas fa-link"></i></a>
</h2>
<p>The barplot will seperate positive and negative NES (normalized enrichment score) into two sides. Users could specify <code>colors</code> for the two sides.</p>


<div class="figure">
<span style="display:block;" id="fig:twosideBar"></span>
<img src="genekitr_files/figure-html/twosideBar-1.png" alt="Two-side bar plot of GSEA." width="98%"><p class="caption">
Figure 1.5: <strong>Two-side bar plot of GSEA.</strong>
</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html">ðŸ“– Introduction</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#plot-gsea"><span class="header-section-number">1</span> Plot GSEA</a></li>
<li><a class="nav-link" href="#classic-pathway-plot"><span class="header-section-number">1.1</span> Classic Pathway Plot</a></li>
<li><a class="nav-link" href="#volcano-pathway-plot"><span class="header-section-number">1.2</span> Volcano Pathway Plot</a></li>
<li><a class="nav-link" href="#multi-pathway-plot"><span class="header-section-number">1.3</span> Multi-pathway Plot</a></li>
<li><a class="nav-link" href="#ridge-plot"><span class="header-section-number">1.4</span> Ridge Plot</a></li>
<li><a class="nav-link" href="#two-side-barplot"><span class="header-section-number">1.5</span> Two-side Barplot</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Genekitr: Gene Analysis Toolkit based on R</strong>" was written by Yunze Liu. It was last built on 2022-06-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
